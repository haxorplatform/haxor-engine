'use strict';(function(){function s(a,b){function c(){}c.prototype=a;var d=new c,f;for(f in b)d[f]=b[f];b.toString!==Object.prototype.toString&&(d.toString=b.toString);return d}function ha(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=Qd++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c);return c}var k={},A=function(){return J.__string_rec(this,
"")},E=function(){};k.HxOverrides=E;E.__name__=["HxOverrides"];E.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c};E.substr=function(a,b,c){if(null!=b&&0!=b&&null!=c&&0>c)return"";null==c&&(c=a.length);0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b);return a.substr(b,c)};E.remove=function(a,b){var c=a.indexOf(b);if(-1==c)return!1;a.splice(c,1);return!0};E.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};
var Pc=function(){};k.IMap=Pc;Pc.__name__=["IMap"];Math.__name__=["Math"];var Qa=function(){};k.Reflect=Qa;Qa.__name__=["Reflect"];Qa.getProperty=function(a,b){var c;return null==a?null:a.__properties__&&(c=a.__properties__["get_"+b])?a[c]():a[b]};Qa.setProperty=function(a,b,c){var d;if(a.__properties__&&(d=a.__properties__["set_"+b]))a[d](c);else a[b]=c};var w=function(){};k.Std=w;w.__name__=["Std"];w.string=function(a){return J.__string_rec(a,"")};w["int"]=function(a){return a|0};w.parseInt=function(a){var b=
parseInt(a,10);0!=b||120!=E.cca(a,1)&&88!=E.cca(a,1)||(b=parseInt(a));return isNaN(b)?null:b};w.parseFloat=function(a){return parseFloat(a)};var Ib=function(){this.b=""};k.StringBuf=Ib;Ib.__name__=["StringBuf"];Ib.prototype={add:function(a){this.b+=w.string(a)},addChar:function(a){this.b+=String.fromCharCode(a)},addSub:function(a,b,c){this.b=null==c?this.b+E.substr(a,b,null):this.b+E.substr(a,b,c)},__class__:Ib};var B=function(){};k.StringTools=B;B.__name__=["StringTools"];B.htmlEscape=function(a,
b){a=a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;");return b?a.split('"').join("&quot;").split("'").join("&#039;"):a};B.isSpace=function(a,b){var c=E.cca(a,b);return 8<c&&14>c||32==c};B.ltrim=function(a){for(var b=a.length,c=0;c<b&&B.isSpace(a,c);)c++;return 0<c?E.substr(a,c,b-c):a};B.rtrim=function(a){for(var b=a.length,c=0;c<b&&B.isSpace(a,b-c-1);)c++;return 0<c?E.substr(a,0,b-c):a};B.trim=function(a){return B.ltrim(B.rtrim(a))};B.replace=function(a,b,c){return a.split(b).join(c)};
B.hex=function(a,b){var c="";do c="0123456789ABCDEF".charAt(a&15)+c,a>>>=4;while(0<a);if(null!=b)for(;c.length<b;)c="0"+c;return c};B.fastCodeAt=function(a,b){return a.charCodeAt(b)};var ib=function(){};k.Type=ib;ib.__name__=["Type"];ib.getClass=function(a){return null==a?null:a instanceof Array&&null==a.__enum__?Array:a.__class__};ib.getClassName=function(a){return a.__name__.join(".")};ib.resolveClass=function(a){a=k[a];return null!=a&&a.__name__?a:null};ib.createInstance=function(a,b){switch(b.length){case 0:return new a;
case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);default:throw"Too many arguments";}};var G=function(){};k.Xml=G;G.__name__=["Xml"];G.parse=function(a){return qb.parse(a)};G.createElement=function(a){var b=
new G;b.nodeType=G.Element;b._children=[];b._attributes=new fb;b.set_nodeName(a);return b};G.createPCData=function(a){var b=new G;b.nodeType=G.PCData;b.set_nodeValue(a);return b};G.createCData=function(a){var b=new G;b.nodeType=G.CData;b.set_nodeValue(a);return b};G.createComment=function(a){var b=new G;b.nodeType=G.Comment;b.set_nodeValue(a);return b};G.createDocType=function(a){var b=new G;b.nodeType=G.DocType;b.set_nodeValue(a);return b};G.createProcessingInstruction=function(a){var b=new G;b.nodeType=
G.ProcessingInstruction;b.set_nodeValue(a);return b};G.createDocument=function(){var a=new G;a.nodeType=G.Document;a._children=[];return a};G.prototype={get_nodeName:function(){if(this.nodeType!=G.Element)throw"bad nodeType";return this._nodeName},set_nodeName:function(a){if(this.nodeType!=G.Element)throw"bad nodeType";return this._nodeName=a},get_nodeValue:function(){if(this.nodeType==G.Element||this.nodeType==G.Document)throw"bad nodeType";return this._nodeValue},set_nodeValue:function(a){if(this.nodeType==
G.Element||this.nodeType==G.Document)throw"bad nodeType";return this._nodeValue=a},get:function(a){if(this.nodeType!=G.Element)throw"bad nodeType";return this._attributes.get(a)},set:function(a,b){if(this.nodeType!=G.Element)throw"bad nodeType";this._attributes.set(a,b)},exists:function(a){if(this.nodeType!=G.Element)throw"bad nodeType";return this._attributes.exists(a)},iterator:function(){if(null==this._children)throw"bad nodetype";return{cur:0,x:this._children,hasNext:function(){return this.cur<
this.x.length},next:function(){return this.x[this.cur++]}}},elements:function(){if(null==this._children)throw"bad nodetype";return{cur:0,x:this._children,hasNext:function(){for(var a=this.cur,b=this.x.length;a<b&&this.x[a].nodeType!=G.Element;)a+=1;this.cur=a;return a<b},next:function(){for(var a=this.cur,b=this.x.length;a<b;){var c=this.x[a],a=a+1;if(c.nodeType==G.Element)return this.cur=a,c}return null}}},elementsNamed:function(a){if(null==this._children)throw"bad nodetype";return{cur:0,x:this._children,
hasNext:function(){for(var b=this.cur,c=this.x.length;b<c;){var d=this.x[b];if(d.nodeType==G.Element&&d._nodeName==a)break;b++}this.cur=b;return b<c},next:function(){for(var b=this.cur,c=this.x.length;b<c;){var d=this.x[b];b++;if(d.nodeType==G.Element&&d._nodeName==a)return this.cur=b,d}return null}}},firstChild:function(){if(null==this._children)throw"bad nodetype";return this._children[0]},firstElement:function(){if(null==this._children)throw"bad nodetype";for(var a=0,b=this._children.length;a<
b;){var c=this._children[a];if(c.nodeType==G.Element)return c;a++}return null},addChild:function(a){if(null==this._children)throw"bad nodetype";null!=a._parent&&E.remove(a._parent._children,a);a._parent=this;this._children.push(a)},toString:function(){if(this.nodeType==G.PCData)return B.htmlEscape(this._nodeValue);if(this.nodeType==G.CData)return"<![CDATA["+this._nodeValue+"]]\x3e";if(this.nodeType==G.Comment)return"\x3c!--"+this._nodeValue+"--\x3e";if(this.nodeType==G.DocType)return"<!DOCTYPE "+
this._nodeValue+">";if(this.nodeType==G.ProcessingInstruction)return"<?"+this._nodeValue+"?>";var a=new Ib;if(this.nodeType==G.Element){a.b+="<";a.b+=w.string(this._nodeName);for(var b=this._attributes.keys();b.hasNext();){var c=b.next();a.b+=" ";a.b=null==c?a.b+"null":a.b+(""+c);a.b+='="';a.add(this._attributes.get(c));a.b+='"'}if(0==this._children.length)return a.b+="/>",a.b;a.b+=">"}for(b=this.iterator();b.hasNext();)c=b.next(),a.add(c.toString());this.nodeType==G.Element&&(a.b+="</",a.b+=w.string(this._nodeName),
a.b+=">");return a.b},__class__:G,__properties__:{set_nodeValue:"set_nodeValue",get_nodeValue:"get_nodeValue",set_nodeName:"set_nodeName",get_nodeName:"get_nodeName"}};var Qc=function(){};k["haxor.core.IDisposable"]=Qc;Qc.__name__=["haxor","core","IDisposable"];Qc.prototype={__class__:Qc};var v=function(a){null==a&&(a="");this.m_uid=g.uid++;this.m_destroyed=!1;this.__cid=0;this.__db="";this.__pid=[-1,-1,-1,-1,-1,-1,-1,-1,-1];this.m_name=a;this.m_is_behaviour=J.__instanceof(this,M);this.m_type_class=
ib.getClass(this);this.m_type_full_name=ib.getClassName(this.m_type_class);var b=this.m_type_full_name.split(".");b.reverse();this.m_type_name=b[0];this.m_name=""==a?this.m_type_name+this.m_uid:a;this.m_guid="";this.m_guid+=B.hex(Math.floor(268435455*Math.random()));this.m_guid+=B.hex(Math.floor(268435455*Math.random()));this.m_guid+=B.hex(Math.floor(268435455*Math.random()));this.m_guid+=B.hex(Math.floor(268435455*Math.random()));g.resources.Add(this)};k["haxor.core.Resource"]=v;v.__name__=["haxor",
"core","Resource"];v.__interfaces__=[Qc];v.Destroy=function(a){""!=a.__db&&r.Remove(a.__db);g.Destroy(a)};v.prototype={get_application:function(){return Za.m_instance},get_guid:function(){return this.m_guid},get_uid:function(){return this.m_uid},get_name:function(){return this.m_name},set_name:function(a){return this.m_name=a},get_destroyed:function(){return this.m_destroyed},GetType:function(){return this.m_type_class},GetTypeName:function(){return this.m_type_name},GetTypeFullName:function(){return this.m_type_full_name},
OnDestroy:function(){},Clone:function(){return null},__class__:v,__properties__:{get_destroyed:"get_destroyed",set_name:"set_name",get_name:"get_name",get_uid:"get_uid",get_guid:"get_guid",get_application:"get_application"}};var Ra=function(a){v.call(this,a)};k["haxor.component.Component"]=Ra;Ra.__name__=["haxor","component","Component"];Ra.__super__=v;Ra.prototype=s(v.prototype,{get_name:function(){return null==this.m_entity?v.prototype.get_name.call(this):this.m_entity.get_name()},set_name:function(a){null!=
this.m_entity&&this.m_entity.set_name(a);return a},get_entity:function(){return this.m_entity},get_layer:function(){return this.m_entity.m_layer},set_layer:function(a){this.m_entity.set_layer(a);return a},get_transform:function(){return this.m_entity.m_transform},get_camera:function(){return this.m_entity.get_camera()},get_renderer:function(){return this.m_entity.get_renderer()},get_rigidbody:function(){return this.m_entity.get_rigidbody()},AddComponent:function(a){return this.m_entity.AddComponent(a)},
GetComponent:function(a){return this.m_entity.GetComponent(a)},GetComponents:function(a){return this.m_entity.GetComponents(a)},GetComponentInChildren:function(a){return this.m_entity.GetComponentInChildren(a)},GetComponentsInChildren:function(a){return this.m_entity.GetComponentsInChildren(a)},OnBuild:function(){},OnTransformUpdate:function(a){},OnVisibilityChange:function(a){},__class__:Ra,__properties__:s(v.prototype.__properties__,{get_rigidbody:"get_rigidbody",get_renderer:"get_renderer",get_camera:"get_camera",
get_transform:"get_transform",set_layer:"set_layer",get_layer:"get_layer",get_entity:"get_entity"})});var M=function(a){v.call(this,a)};k["haxor.component.Behaviour"]=M;M.__name__=["haxor","component","Behaviour"];M.__super__=Ra;M.prototype=s(Ra.prototype,{get_enabled:function(){return this.m_enabled&&!this.m_destroyed},set_enabled:function(a){if(this.m_destroyed)return!1;if(this.m_enabled==a)return a;(this.m_enabled=a)?g.Enable(this):g.Disable(this);return a},OnBuild:function(){Ra.prototype.OnBuild.call(this);
this.m_is_behaviour=this.m_enabled=!0;this.m_is_start=this.m_is_awake=!1;g.Enable(this);g.awake.push(this);g.start.push(this)},OnAwake:function(){},OnStart:function(){},__class__:M,__properties__:s(Ra.prototype.__properties__,{set_enabled:"set_enabled",get_enabled:"get_enabled"})});var va=function(a){this.m_has_mesh=!1;v.call(this,a)};k["haxor.component.Renderer"]=va;va.__name__=["haxor","component","Renderer"];va.__super__=M;va.prototype=s(M.prototype,{get_material:function(){return this.m_material},
set_material:function(a){if(this.m_material==a)return a;this.m_material=a;this.m_last_queue=null==a?-1:a.queue;g.renderer.OnMaterialChange(this);return a},get_visible:function(){return this.m_visible&&!this.m_culled},set_visible:function(a){return this.m_visible=a},OnBuild:function(){M.prototype.OnBuild.call(this);this.m_last_queue=-1;this.m_visible=!0;this.m_culled=!1;g.renderer.Create(this)},OnRender:function(){null!=this.m_material&&this.m_last_queue!=this.m_material.queue&&(this.m_last_queue=
this.m_material.queue,g.renderer.OnMaterialChange(this))},UpdateCulling:function(){var a=this.m_culled,b=this.CheckCulling();this.m_culled=b;a!=b&&g.renderer.OnVisibilityChange(this,!b)},CheckCulling:function(){return!1},OnDestroy:function(){g.renderer.Destroy(this)},__class__:va,__properties__:s(M.prototype.__properties__,{get_visible:"get_visible",set_material:"set_material",get_material:"get_material"})});var ia=function(a){va.call(this,a)};k["haxor.component.MeshRenderer"]=ia;ia.__name__=["haxor",
"component","MeshRenderer"];ia.__super__=va;ia.prototype=s(va.prototype,{get_mesh:function(){return this.m_mesh},set_mesh:function(a){if(this.m_mesh==a)return a;this.m_mesh=a;this.UpdateWorldBounds();return a},OnBuild:function(){this.m_has_mesh=!0;va.prototype.OnBuild.call(this);this.m_ws_center=new n(0,0,0);this.m_ws_radius=new n(0,0,0);this.m_culling_dirty=!1;this.m_aabb=ba.get_empty()},IsVisible:function(a){if(null==a||null==this.m_mesh)return!1;var b=a.WorldToProjection(g.data.get_v3().Set3(this.m_ws_center),
g.data.get_v4()),c=b.w;if(0>=c)return!1;if(b.x>=-c&&b.x<=c&&b.y>=-c&&b.y<=c&&b.z>=-c&&b.z<=c)return!0;a=a.WorldToProjection(g.data.get_v3().Set3(this.m_ws_radius),g.data.get_v4());a=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z+a.w*a.w);return b.x+a>=-c&&b.x-a<=c&&b.y+a>=-c&&b.y-a<=c&&b.z+a>=-c&&b.z-a<=c?!0:!1},CheckCulling:function(){var a=U.m_current;if(null==a||!a.m_view_uniform_dirty&&!a.m_proj_uniform_dirty&&!this.m_culling_dirty)return this.m_culled;this.UpdateWorldBounds();return!this.IsVisible(a)},OnTransformUpdate:function(a){this.m_culling_dirty=
!0},UpdateWorldBounds:function(){if(null!=this.m_mesh){ba.Center(this.m_mesh.m_bounds,this.m_ws_center);this.m_entity.m_transform.get_WorldMatrix().Transform3x4(this.m_ws_center);this.m_ws_radius.Set(this.m_mesh.m_bounds.get_width(),this.m_mesh.m_bounds.get_height(),this.m_mesh.m_bounds.get_depth());this.m_entity.m_transform.get_WorldMatrix().Transform3x3(this.m_ws_radius);var a=.5*this.m_ws_radius.get_length(),b=g.data.get_v3(),c=g.data.get_v3();b.Set(this.m_ws_center.x-a,this.m_ws_center.y-a,this.m_ws_center.z-
a);c.Set(this.m_ws_center.x+a,this.m_ws_center.y+a,this.m_ws_center.z+a);this.m_aabb.Set3(b,c);g.renderer.UpdateSAP(this.__fcid,this,b,c);this.m_culling_dirty=!1}},OnRender:function(){va.prototype.OnRender.call(this);null!=this.m_mesh&&(ia.current=this,la.Render(this.m_mesh,this.m_material,this.m_entity.m_transform,U.m_current))},__class__:ia,__properties__:s(va.prototype.__properties__,{set_mesh:"set_mesh",get_mesh:"get_mesh"})});var kc=function(a){va.call(this,a)};k["examples.dungeon.BlobShadow"]=
kc;kc.__name__=["examples","dungeon","BlobShadow"];kc.__super__=ia;kc.prototype=s(ia.prototype,{OnBuild:function(){ia.prototype.OnBuild.call(this);this.set_mesh(W.get_planeXZ());var a=r.Get("BlobShadow");this.set_material(aa.Transparent(a,!0,!1,!0));this.m_material.SetBlending(0,768);this.m_material.SetColor("Tint",new t(1,1,1,1))},__class__:kc});var lc=function(a){v.call(this,a)};k["examples.dungeon.Dungeon"]=lc;lc.__name__=["examples","dungeon","Dungeon"];lc.__super__=M;lc.prototype=s(M.prototype,
{OnStart:function(){this.app=this.get_application();this.asset=r.Get("dungeon").get_asset();this.asset.m_transform.set_parent(this.m_entity.m_transform);var a=this.asset.GetComponentsInChildren(ia);console.log("Dungeon> Found ["+a.length+"] MeshRenderers");for(var b=0,c=a.length;b<c;){var d=b++,d=a[d];if(null==d.m_material)console.log(d.get_name()+" material is null");else{var f=d.m_material.get_name().split("///"),m=f[0],f=1>=f.length?[""]:f[1].split("//"),e=f[0],oa;oa=2<=f.length?f[1]:"";f=r.Get(m);
if(null==f)console.log(d.get_name()+" material ["+m+"] is null");else{var g=r.Get(e);null==g&&(console.log(e+" is null."),g=z.get_white());0<=e.indexOf("Tile")&&g.set_wrap(Da.RepeatX|Da.RepeatY);var h;h=""==oa?null:r.Get(oa);m=m+"@"+e+oa+"Material";null!=r.Get(m)?f=r.Get(m):(console.log(d.get_name()+" "+f.m_shader.get_name()),f=r.Instantiate(f),f.blend||(f.queue=900),f.set_name(m),f.SetTexture("DiffuseTexture",g),null!=h&&f.SetTexture("Lightmap",h),r.Add(m,f));d.set_material(f)}}}a=this.asset.m_transform.Search("Colliders");
if(null!=a)for(b=0,c=a.m_hierarchy.length;b<c;)d=b++,a.GetChild(d).m_entity.AddComponent(yb).set_size(new n(50,50,50));a=this.asset.m_transform.Search("Triggers");if(null!=a)for(b=0,c=a.m_hierarchy.length;b<c;)d=b++,d=a.GetChild(d),m=d.m_entity.AddComponent(yb),0<=m.get_name().indexOf("Camera")&&d.m_entity.set_layer(fa.CameraArea),0<=m.get_name().indexOf("Hole")&&d.m_entity.set_layer(fa.Hole),m.trigger=!0,m.set_size(new n(50,50,50));this.asset.m_transform.Traverse(ha(this,this.TraverseLevel));this.get_application().game.OnDungeonLoaded()},
TraverseLevel:function(a,b){if("Colliders"==a.get_name()||"Triggers"==a.get_name())return!1;if(0<=a.get_name().indexOf("Torch")&&0>a.get_name().indexOf("Point")&&0>=a.m_entity.GetComponentsInChildren(Wb).length&&0>this.app.os.toLowerCase().indexOf("arm")&&!this.app.is_mobile){var c=(new wa).AddComponent(Wb);c.m_entity.set_name("Torch");c.m_entity.m_transform.set_parent(a);c.m_entity.m_transform.set_localPosition(new n(0,0,0))}0<=a.get_name().indexOf("Collider_")&&a.m_entity.AddComponent(yb).set_size(new n(50,
50,50));0<=a.get_name().indexOf("Trigger_")&&(c=a.m_entity.AddComponent(yb),0<=c.get_name().indexOf("Camera")&&a.m_entity.set_layer(fa.CameraArea),0<=c.get_name().indexOf("Hole")&&a.m_entity.set_layer(fa.Hole),0<=c.get_name().indexOf("Door")&&a.m_entity.set_layer(fa.Door),c.trigger=!0,c.set_size(new n(50,50,50)));if(0==a.get_name().indexOf("Door")){if(0<=a.get_name().indexOf("Frame")||0<=a.get_name().indexOf("Right")||0<=a.get_name().indexOf("Left"))return!0;a.m_entity.AddComponent(nc)}return!0},
GetSpawnPosition:function(a){var b=this.asset.m_transform.Navigate("Spawns."+a);console.log("Dungeon> Finding Spawn ["+a+"]["+w.string(null!=b)+"]");if(null==b)return new n(0,0,0);a=new n(0,0,0);return a=b.get_WorldMatrix().Transform3x4(a)},__class__:lc});var nc=function(a){v.call(this,a)};k["examples.dungeon.DungeonDoor"]=nc;nc.__name__=["examples","dungeon","DungeonDoor"];nc.__super__=M;nc.prototype=s(M.prototype,{OnBuild:function(){M.prototype.OnBuild.call(this);this.open=this.locked=!1},OnStart:function(){var a=
this;this.m_entity.m_transform.Traverse(function(b,c){var d=b.get_name().toLowerCase();0<=d.indexOf("left")&&null==a.m_left&&(a.m_left=b);0<=d.indexOf("right")&&null==a.m_right&&(a.m_right=b);return!0});ja.Delay(pa.Range(2,4),ha(this,this.Open))},Open:function(){this.locked||(this.open=!0,console.log("DungeonDoor> "+this.get_name()+" Open"),ca.Add(this.m_left,"localRotation",F.FromAxisAngle(new n(0,1,0),80),1.5,0,gb.OutBack),ca.Add(this.m_right,"localRotation",F.FromAxisAngle(new n(0,1,0),-80),1.5,
0,gb.OutBack))},Close:function(){console.log("DungeonDoor> "+this.get_name()+" Close");this.open=!1;ca.Add(this.m_left,"localRotation",F.FromAxisAngle(new n(0,1,0),0),1.5,0,gb.Out);ca.Add(this.m_right,"localRotation",F.FromAxisAngle(new n(0,1,0),0),1.5,0,gb.Out)},__class__:nc});var oc=function(a){v.call(this,a)};k["examples.dungeon.GameController"]=oc;oc.__name__=["examples","dungeon","GameController"];oc.__super__=M;oc.prototype=s(M.prototype,{Initialize:function(){u.Log("GameController> Initialize");
this.app=this.get_application();S.gravity=new n(0,-980,0);S.SetInteraction(fa.Default,fa.Default,!0);S.SetInteraction(fa.Default,fa.Player,!0);S.SetInteraction(fa.Player,fa.CameraArea,!0);S.SetInteraction(fa.Player,fa.Door,!0);P.ambient=t.FromBytes(130,140,160);this.dungeon=(new wa).AddComponent(lc);this.dungeon.set_name("dungeon");this.player=(new wa).AddComponent(pc);this.player.set_name("player");this.orbit=rb.Create(700,-135,45);this.orbit.m_entity.m_transform.set_localPosition(new n(0,9,26));
this.orbit.smooth=5;this.orbit.get_camera().background=t.FromBytes(10,0,40);this.orbit.get_camera().set_near(100);this.orbit.get_camera().set_far(2E3);this.orbit.get_camera().set_fov(40);this.orbit.target=this.player.m_entity.m_transform;this.orbit.follow=!0;this.orbit.m_entity.AddComponent(Jb).zoomSpeed=35;da.color=t.FromBytes(10,0,40);da.exp=1.5;da.end=.6},OnDungeonLoaded:function(){console.log("GameController> Dungeon Loaded");var a=this.dungeon.GetSpawnPosition("Player_Start_001");a.y+=10;console.log("\tSpawn Point ["+
a.ToString()+"]");null!=this.player&&this.player.m_entity.m_transform.set_localPosition(a);this.orbit.get_pivot().set_localPosition(a)},OnTriggerEnter:function(a,b){console.log("GameController> TriggerEnter ["+a.get_name()+"]["+b.get_name()+"]");switch(a.m_layer){case fa.Door:b.get_layer()==fa.Player&&console.log("GameController> Door Trigger Enter")}},OnTriggerExit:function(a,b){console.log("GameController> TriggerExit ["+a.get_name()+"]["+b.get_name()+"]");switch(a.m_layer){case fa.Door:b.get_layer()==
fa.Player&&console.log("GameController> Door Trigger Exit")}},__class__:oc});var fa=function(){};k["examples.dungeon.GameLayer"]=fa;fa.__name__=["examples","dungeon","GameLayer"];var $a=function(){};k["haxor.core.IUpdateable"]=$a;$a.__name__=["haxor","core","IUpdateable"];$a.prototype={__class__:$a};var Sa=function(a){this.path_enabled=!1;this.lerp_dir=new n(0,0,0);this.m_path_current=0;v.call(this,a)};k["examples.dungeon.Player"]=Sa;Sa.__name__=["examples","dungeon","Player"];Sa.__interfaces__=[$a];
Sa.__super__=M;Sa.prototype=s(M.prototype,{get_state:function(){return this.m_state},set_state:function(a){this.m_state!=a&&this.OnStateChange(this.m_state,a);return this.m_state=a},OnStart:function(){this.asset=r.Get(this.character).get_asset();this.asset.m_transform.set_localScale(new n(4,4,4));this.asset.m_transform.set_localPosition(new n(0,10,0));this.asset.m_transform.set_parent(this.m_entity.m_transform);this.speed=Sa.TOP_SPEED;this.m_velocity=new n(0,0,0);this.m_is_attack=!1;for(var a=this.asset.GetComponentsInChildren(ia),
b=0,c=a.length;b<c;){var d=b++,d=a[d],f=d.m_material.get_name(),f=B.replace(f,"DiffuseSkin","ToonSkin"),m=r.Get(f);null==m&&console.log("Player> Material ["+f+"] is null!");var e=r.Get(this.character+"/diffuse"),f=f+"_"+this.character;null!=r.Get(f)?m=r.Get(f):(this.m_falloff_mat=m=r.Instantiate(m),m.set_name(f),m.lighting=!1,m.set_shader(C.get_FlatTextureSkin()),m.SetTexture("DiffuseTexture",e),m.SetFloat("Falloff",1.5),m.SetFloat("FalloffIntensity",1),e=r.Get("player/ramp"),m.SetTexture("RampTexture",
e),r.Add(f,m));d.set_material(m);m=r.Get("PlayerHilight");null==m&&(m=new aa,m.set_shader(r.Get("haxor/unlit/FlatSkin")),m.set_name("PlayerHilight"),m.queue=995,m.ztest=!1,m.zwrite=!1,m.SetColor("Tint",t.FromBytes(45,90,125)),r.Add("PlayerHilight",m))}a=this.m_entity.AddComponent(qc);a.set_radius(80);a.set_center(new n(0,40,0));this.m_entity.AddComponent(Kb);this.m_entity.set_layer(fa.Player);this.m_clips=new fb;this.m_state="";this.m_shadow=(new wa).get_transform();this.m_shadow.set_name("shadow");
this.m_shadow.set_parent(this.m_entity.m_transform);this.m_shadow.set_localScale(new n(110,0,110));this.m_shadow.set_localPosition(new n(0,2.5,0));this.m_shadow.m_entity.AddComponent(kc);this.get_application().is_mobile||(this.m_dust_particle=(new wa).AddComponent(rc),this.m_dust_particle.m_entity.m_transform.set_parent(this.m_entity.m_transform),this.m_dust_particle.m_entity.m_transform.set_localPosition(new n(0,10,0)))},SplitClip:function(a,b,c,d,f,m){null==m&&(m=1);null==f&&(f=!0);b=d.Split(b,
c);b.wrap=f?ra.Loop:ra.Clamp;b.speed=m;this.m_clips.set(a,b);this.asset.get_animation().Add(b)},LoadClip:function(a,b,c,d){null==d&&(d=1);null==c&&(c=!0);r.Get(a).AddAnimations(this.asset);a=this.asset.get_animation().clips.length-1;a=this.asset.get_animation().clips[a];a.set_name(b);a.wrap=c?ra.Loop:ra.Clamp;a.speed=d;this.m_clips.set(b,a);return a},PlayClip:function(a,b){null==b&&(b=0);var c=this.m_clips.get(a);null!=c&&(this.asset.get_animation().Stop(),this.asset.get_animation().Fade(c,0,b))},
GetClip:function(a){return this.m_clips.get(a)},Stop:function(){this.m_velocity.Set()},Move:function(a){this.m_velocity.Set(a.x,a.y,a.z)},OnStateChange:function(a,b){switch(b){case "idle_attack":this.PlayClip("idle_attack");break;case "idle":ja.Delay(1.5,function(){});this.PlayClip("idle",2);break;case "attack01":this.get_rigidbody().set_velocity(new n(0,0,0));this.PlayClip("attack01",2);break;case "attack02":this.get_rigidbody().set_velocity(new n(0,0,0));this.PlayClip("attack02");break;case "run":this.PlayClip("run",
.5)}},OnFSM:function(){var a=this.m_state;switch(a){case "idle_attack":0<this.m_velocity.get_length()&&(a="run");break;case "idle":0<this.m_velocity.get_length()&&(a="run");break;case "attack01":this.m_is_attack||(a="idle");break;case "attack02":break;case "run":var b=this.m_velocity.get_clone();b.y=0;b.Scale(this.speed);var c=this.get_rigidbody().get_velocity(),d=c.y,c=n.Lerp(c,b,20*q.m_delta);c.y=d;this.get_rigidbody().set_velocity(c);.1>Math.sqrt(c.x*c.x+c.y*c.y+c.z*c.z)&&(this.get_rigidbody().set_velocity(new n(0,
0,0)),a="idle");c.y=0;this.m_entity.m_transform.set_localRotation(F.LookRotation(c.Invert(),new n(0,1,0)));break;default:a="idle"}return a},UpdateKeyboardInput:function(){if(!p.Pressed(h.ControlKey)){var a=this.get_application().game.orbit,b=new n(0,0,0),c=a.get_pivot().get_transform().get_forward(),a=a.get_pivot().get_transform().get_right(),d=this.m_is_attack=!1;if(ab.available&&0<p.get_joystick().length){var f=p.get_joystick()[0];this.m_animation_speed=l.Clamp01(1.1*f.analogLeft.get_length());
this.m_animation_speed=.3+.8999999999999999*this.m_animation_speed;this.GetClip("run").speed=this.m_animation_speed;this.speed=Sa.TOP_SPEED*this.m_animation_speed;b.Add(c.Scale(f.analogLeft.y));b.Add(a.Scale(f.analogLeft.x));b.y=0;f.Pressed(h.Face1)&&(this.Stop(),this.set_state("attack01"),d=this.m_is_attack=!0);0<Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z)&&(d=!0)}!d&&2>=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z)&&(p.Pressed(h.Down)&&(b.Add(c.Invert()),this.m_animation_speed=1),p.Pressed(h.Up)&&(b.Add(c),this.m_animation_speed=
1),p.Pressed(h.Right)&&(b.Add(a),this.m_animation_speed=1),p.Pressed(h.Left)&&(b.Add(a.Invert()),this.m_animation_speed=1),p.Pressed(h.C)&&(this.Stop(),this.set_state("attack01"),this.m_is_attack=!0),b.y=0,b.Normalize(),p.Pressed(h.Z)?(this.GetClip("run").speed=1.3,this.speed=1.3*Sa.TOP_SPEED):150<this.speed&&(this.GetClip("run").speed=1,this.speed=Sa.TOP_SPEED));.5>=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z)?this.Stop():this.Move(b)}},OnUpdate:function(){this.UpdateKeyboardInput();var a=this.get_application();
if(this.path_enabled){var b=a.path[this.m_path_current],c=g.data.get_v3().Set3(b).Sub(this.m_entity.m_transform.get_localPosition());c.y=0;c.Normalize();this.lerp_dir.Set3(n.Lerp(this.lerp_dir,c,3*q.m_delta,g.data.get_v3()));this.Move(this.lerp_dir);50>n.Distance(b,this.m_entity.m_transform.get_localPosition())&&(this.m_path_current=(this.m_path_current+1)%a.path.length)}this.set_state(this.OnFSM())},__class__:Sa,__properties__:s(M.prototype.__properties__,{set_state:"set_state",get_state:"get_state"})});
var pc=function(a){Sa.call(this,a)};k["examples.dungeon.Knight"]=pc;pc.__name__=["examples","dungeon","Knight"];pc.__super__=Sa;pc.prototype=s(Sa.prototype,{OnStart:function(){var a=this;this.character="knight";Sa.prototype.OnStart.call(this);this.LoadClip("player/animation/all/idle01","idle");this.LoadClip("player/animation/all/walk","walk");this.LoadClip("player/animation/all/run","run");this.LoadClip("player/animation/kp/attack01","attack01");this.LoadClip("player/animation/kp/attack02","attack02");
this.LoadClip("player/animation/kp/idle01","idle_attack");this.LoadClip("player/animation/kp/die01","die");this.LoadClip("player/animation/kp/hit01","hit");this.PlayClip("idle");var b;b=this.GetClip("run");null!=this.m_dust_particle&&b.AddEvent(9,function(b){a.m_dust_particle.Emit(2)});null!=this.m_dust_particle&&b.AddEvent(17,function(b){a.m_dust_particle.Emit(2)})},__class__:pc});var Za=function(a){v.call(this,a)};k["haxor.core.BaseApplication"]=Za;Za.__name__=["haxor","core","BaseApplication"];
Za.__super__=M;Za.prototype=s(M.prototype,{get_protocol:function(){return"file:"==window.location.protocol.toLowerCase()?xa.File:"http:"==window.location.protocol.toLowerCase()?xa.HTTP:"https:"==window.location.protocol.toLowerCase()?xa.HTTPS:xa.None},get_vendor:function(){if(null!=this.m_vendor)return this.m_vendor;var a="";null!=window.msRequestAnimationFrame&&(a="-ms-");null!=window.oRequestAnimationFrame&&(a="-o-");null!=window.webkitRequestAnimationFrame&&(a="-webkit-");null!=window.mozRequestAnimationFrame&&
(a="-moz-");return this.m_vendor=a},get_fps:function(){return this.m_fps},set_fps:function(a){var b=this.m_fps=a;60<=b&&(b=1E6);this.m_mspf=1/(1.25*b)*1E3;return a},get_platform:function(){return this.m_platform},get_runOnBackground:function(){return this.m_run_on_background},set_runOnBackground:function(a){return this.m_run_on_background=a},OnBuild:function(){M.prototype.OnBuild.call(this);Za.m_instance=this;this.m_scenes=[];this.set_fps(60);this.m_frame_ms=0;this.m_run_on_background=this.m_init_allowed=
!1;this.m_platform=X.Unknown;q.Initialize();H.Initialize(this);p.Initialize()},LoadScene:function(a){},DestroyScene:function(a){},Load:function(){return!0},Initialize:function(){},LoadComplete:function(){this.m_init_allowed=!0},OnLoadProgress:function(a,b){},OnLoadComplete:function(a,b){},Update:function(){q.Update();p.m_handler.Update();this.CheckResize();Ja.Update();Ja.Collect();p.m_handler.Clear()},Render:function(){this.m_init_allowed&&(u.Log("Application> Initialize.",3),this.Initialize(),this.m_init_allowed=
!1);this.m_frame_ms+=q.m_delta;this.m_frame_ms>=this.m_mspf&&(this.m_frame_ms=0,q.Render(),e.m_gl.Focus(),Ja.Render(),null)},OnQuit:function(){},OnFocus:function(){},OnUnfocus:function(){},CheckResize:function(){var a=!1;0<Math.abs(H.m_width-this.GetContainerWidth())&&(H.m_width=this.GetContainerWidth(),a=!0);0<Math.abs(H.m_height-this.GetContainerHeight())&&(H.m_height=this.GetContainerHeight(),a=!0);a&&this.OnResize()},OnResize:function(){u.Log("Application> Resize ["+H.m_width+","+H.m_height+"]",
6);e.m_gl.Resize();Ja.Resize()},OnFullscreenEnter:function(){},OnFullscreenExit:function(){},OnFullscreenRequest:function(a){return!1},OnPointerLockRequest:function(a){return!1},OnPointerVisibilityRequest:function(a){return!1},OnMousePosition:function(a,b){},GetContainerWidth:function(){return 0},GetContainerHeight:function(){return 0},__class__:Za,__properties__:s(M.prototype.__properties__,{set_runOnBackground:"set_runOnBackground",get_runOnBackground:"get_runOnBackground",get_platform:"get_platform",
set_fps:"set_fps",get_fps:"get_fps",get_vendor:"get_vendor",get_protocol:"get_protocol"})});var zb=function(){v.call(this,void 0);this.m_platform=X.HTML};k["haxor.platform.html.HTMLApplication"]=zb;zb.__name__=["haxor","platform","html","HTMLApplication"];zb.__super__=Za;zb.prototype=s(Za.prototype,{get_stage:function(){return T.m_instance},GetContainerWidth:function(){return this.m_container.clientWidth},GetContainerHeight:function(){return this.m_container.clientHeight},__class__:zb,__properties__:s(Za.prototype.__properties__,
{get_stage:"get_stage"})});var Lb=function(){zb.call(this)};k["haxor.core.Application"]=Lb;Lb.__name__=["haxor","core","Application"];Lb.__super__=zb;Lb.prototype=s(zb.prototype,{__class__:Lb});var Mb=function(){};k["haxor.core.IRenderable"]=Mb;Mb.__name__=["haxor","core","IRenderable"];Mb.prototype={__class__:Mb};var Nb=function(){this.charcount=0;this.cursor=new n(0,0,0);this.queue=3;this.is_mobile=!1;this.load_big_dungeon=!0;zb.call(this)};k["examples.dungeon.Main"]=Nb;Nb.__name__=["examples",
"dungeon","Main"];Nb.__interfaces__=[Mb,$a];Nb.main=function(){I.Initialize()};Nb.__super__=Lb;Nb.prototype=s(Lb.prototype,{OnBuild:function(){Lb.prototype.OnBuild.call(this);this.os="";this.os=window.navigator.platform;0<=this.os.toLowerCase().indexOf("arm")&&(this.is_mobile=!0);0<=this.os.toLowerCase().indexOf("iphone")&&(this.is_mobile=!0);0<=this.os.toLowerCase().indexOf("ipad")&&(this.is_mobile=!0);0<=this.os.toLowerCase().indexOf("ipod")&&(this.is_mobile=!0)},OnStart:function(){this.loader=
new sc},Initialize:function(){var a=this;u.Log("Initialize ["+this.os+"] Mobile["+w.string(this.is_mobile)+"]");this.loader=new sc;this.field=window.document.getElementById("field");this.ui=new Stats;this.ui.domElement.style.position="absolute";this.ui.domElement.style.top="0px";window.document.body.appendChild(this.ui.domElement);ja.Run(function(b){a.ui.update();return!0});this.debug=!0;this.game=(new wa("game")).AddComponent(oc);this.game.Initialize();this.skm0=aa.Transparent(r.Get("human/diffuse"),
null,null,null);this.skm0.set_shader(C.get_FlatTextureSkin());for(var b=0;0>b;)b++,this.Add()},Add:function(){console.log("Added");var a=r.Get("human").get_asset();a.set_name("human");a.m_transform.set_localScale(new n(100,100,100));a.m_transform.set_localPosition(new n(pa.Range(-500,500),0,pa.Range(-500,500)));var b=a.GetComponentsInChildren(Ob);if(0==this.charcount){var c=b[0].m_mesh;c.set_uv0(c.get_uv1());c.set_uv1([])}b[0].set_name("human");b[0].set_material(this.skm0);a.get_animation().clips[0].wrap=
ra.Loop;a.get_animation().Play(a.get_animation().clips[0]);this.charcount++},OnUpdate:function(){if(null!=this.game){w.string(U.SAPCulling);ma.get_total();var a=this.game.orbit.m_entity.GetComponent(Jb);p.Down(h.P)&&a.set_enabled(!a.get_enabled());p.Down(h.D1)&&(this.debug=!this.debug,this.debug||(this.field.innerText=""),this.ui.domElement.style.display=this.debug?"block":"none");p.Down(h.O)&&this.Add();3<=p.get_touches().length&&p.get_touches()[2].get_down()&&this.Add();var a=a.get_enabled()&&this.debug,
b=this.game.orbit.get_pivot().get_localPosition(),c=this.game.orbit.get_pivot().get_forward(),d=this.game.orbit.get_pivot().get_right();c.y=0;c.Normalize();d.y=0;d.Normalize();a&&(p.Down(h.Q)&&(U.SAPCulling=!U.SAPCulling),p.Down(h.D2)&&(D.transform=!D.transform),p.Down(h.D3)&&(D.collider=!D.collider),p.Down(h.D4)&&(D.light=!D.light),p.Down(h.D5)&&(D.renderer=!D.renderer),p.Pressed(h.W)&&b.Add(c.Scale(500*q.m_delta)),p.Pressed(h.S)&&b.Sub(c.Scale(500*q.m_delta)),p.Pressed(h.A)&&b.Sub(d.Scale(500*q.m_delta)),
p.Pressed(h.D)&&b.Add(d.Scale(500*q.m_delta)),this.game.orbit.get_pivot().set_localPosition(b));2<=p.get_touches().length&&(p.get_touches()[0].get_down()||p.get_touches()[1].get_down())&&(this.game.player.path_enabled=!this.game.player.path_enabled);p.Down(h.Enter)&&(this.game.player.path_enabled=!this.game.player.path_enabled);null==this.path&&(this.path=[new n(323.8,0,72.74),new n(299.72,0,-224.01),new n(198,0,-433.37),new n(7.04,0,-560.07),new n(-316.19,0,-311.91),new n(-419.82,0,-158.65),new n(-135.42,
0,-62.95),new n(531.08,0,-302.58),new n(602.21,0,-209.92),new n(462.61,0,126.38),new n(255.05,0,222.19),new n(-27.75,0,481.21),new n(273.31,0,601.23),new n(492.09,0,581.36),new n(608.63,0,474.62),new n(597.1,0,66.89),new n(427.59,0,53.27)])}},OnRender:function(){D.transform&&(ka.Grid(8E3,new t(1,1,1,.1)),ka.Axis(g.data.get_v3().Set(),g.data.get_v3().Set(2,2,2),null,null))},Load:function(){ya.root="http://www.haxor.xyz/resources/";var a=!1,a=0<=window.location.hash.toLowerCase().indexOf("fast");this.load_big_dungeon=
0<=window.location.hash.toLowerCase().indexOf("big");r.LoadTexture2D("player/ramp","./texture/misc/ramp00.jpg");r.LoadCollada("knight","./character/medieval/knight/asset-opt.dae");r.LoadTexture2D("knight/diffuse","./character/medieval/knight/DiffuseTexture.png");r.LoadCollada("skeleton","./character/skeleton/grunt/model.DAE");r.LoadCollada("skeleton/idle","./character/skeleton/grunt/animation_idle01.DAE");r.LoadTexture2D("skeleton/diffuse","./character/skeleton/grunt/DiffuseTexture.png");r.LoadCollada("human",
"assets/human/asset.dae");r.LoadTexture2D("human/diffuse","assets/human/DiffuseTexture.jpg");r.LoadCollada("player/animation/all/idle01","./character/medieval/animations/all_idle01.DAE");r.LoadCollada("player/animation/all/run","./character/medieval/animations/all_run.DAE");r.LoadCollada("player/animation/all/walk","./character/medieval/animations/all_walk.DAE");r.LoadCollada("player/animation/kp/idle01","./character/medieval/animations/kp_idle01.DAE");r.LoadCollada("player/animation/kp/die01","./character/medieval/animations/kp_die01.DAE");
r.LoadCollada("player/animation/kp/hit01","./character/medieval/animations/kp_hit01.DAE");r.LoadCollada("player/animation/kp/attack01","./character/medieval/animations/kp_attack01.DAE");r.LoadCollada("player/animation/kp/attack02","./character/medieval/animations/kp_attack02.DAE");r.LoadCollada("player/animation/m/idle01","./character/medieval/animations/m_idle01.DAE");r.LoadCollada("player/animation/m/attack01","./character/medieval/animations/m_attack01.DAE");r.LoadCollada("player/animation/m/attack02",
"./character/medieval/animations/m_attack02.DAE");r.LoadCollada("player/animation/m/die01","./character/medieval/animations/m_die01.DAE");r.LoadCollada("player/animation/m/hit01","./character/medieval/animations/m_hit01.DAE");r.LoadTexture2D("BlobShadow","./texture/misc/shadow_blob.jpg");r.LoadTexture2D("ParticleColor","./texture/particle/particle_ramp_color.jpg");r.LoadTexture2D("Dust","./texture/particle/sheet/dust_alpha.png");r.LoadTexture2D("DustColor","./texture/particle/sheet/dust_ramp_color.png");
r.LoadTexture2D("Fire","./texture/particle/sheet/cartoon_fire_alpha.png");r.LoadTexture2D("FireColor","./texture/particle/sheet/cartoon_fire_ramp_color.png");if(!this.load_big_dungeon){var b,c=b=this.is_mobile?"-mobile":"";a&&this.is_mobile&&(c+="-fast");r.LoadCollada("dungeon","./projects/dungeon/small-opt/asset.dae");r.LoadTexture2D("DungeonTile01","./projects/dungeon/small1/DungeonTile01.jpg");r.LoadTexture2D("DungeonAtlas01","./projects/dungeon/small-opt/DungeonAtlas01"+c+".jpg");r.LoadTexture2D("DungeonAtlas02",
"./projects/dungeon/small-opt/DungeonAtlas02"+c+".jpg");r.LoadTexture2D("DungeonAtlas03","./projects/dungeon/small-opt/DungeonAtlas03"+c+".jpg");r.LoadTexture2D("Lightmap01","./projects/dungeon/small-opt/Lightmap01"+b+".png");r.LoadTexture2D("Lightmap02","./projects/dungeon/small-opt/Lightmap02"+b+".png");r.LoadTexture2D("Lightmap03","./projects/dungeon/small-opt/Lightmap03"+b+".png")}this.load_big_dungeon&&(this.get_protocol()==xa.File?r.LoadCollada("dungeon","big.dae"):r.LoadCollada("dungeon","./projects/dungeon/big/asset.dae"),
r.LoadTexture2D("DungeonAtlas01","./projects/dungeon/big/DungeonAtlas01.jpg"),r.LoadTexture2D("DungeonAtlas02","./projects/dungeon/big/DungeonAtlas02.png"),r.LoadTexture2D("DungeonAtlas03","./projects/dungeon/big/DungeonAtlas03.png"),r.LoadTexture2D("DungeonAtlas04","./projects/dungeon/big/DungeonAtlas04.jpg"),r.LoadTexture2D("DungeonAtlas05","./projects/dungeon/big/DungeonAtlas05.jpg"),r.LoadTexture2D("DungeonTile01","./projects/dungeon/big/DungeonTile01.jpg"),r.LoadTexture2D("DungeonTile02","./projects/dungeon/big/DungeonTile02.jpg"));
r.LoadShader("haxor/unlit/FlatTexture","./shader/unlit/FlatTexture.shader");r.LoadShader("haxor/unlit/FlatTextureSkin","./shader/unlit/FlatTextureSkin.shader");r.LoadShader("haxor/unlit/FlatSkin","./shader/unlit/FlatSkin.shader");r.LoadShader("haxor/unlit/Flat","./shader/unlit/Flat.shader");r.LoadShader("haxor/lightmap/FlatTexture","./shader/lightmap/FlatTexture.shader");r.LoadShader("haxor/unlit/Particle","./shader/unlit/Particle.shader");r.LoadShader("haxor/diffuse/Flat","./shader/diffuse/Flat.shader");
r.LoadShader("haxor/diffuse/Diffuse","./shader/diffuse/Diffuse.shader");r.LoadShader("haxor/diffuse/DiffuseSkin","./shader/diffuse/DiffuseSkin.shader");r.LoadShader("haxor/diffuse/ToonSkin","./shader/diffuse/ToonSkin.shader");r.LoadShader("haxor/diffuse/ToonSkinFalloff","./shader/diffuse/ToonSkinFalloff.shader");r.LoadShader("haxor/screen/Displacement","./shader/screen/Displacement.shader");r.LoadShader("haxor/kernel/ParticleKernel","./shader/kernel/ParticleKernel.shader");r.LoadMaterial("haxor/material/opaque/unlit/Flat",
"./material/opaque/unlit/Flat.mat");r.LoadMaterial("haxor/material/opaque/unlit/FlatTexture","./material/opaque/unlit/FlatTexture.mat");r.LoadMaterial("haxor/material/opaque/unlit/FlatTextureSkin","./material/opaque/unlit/FlatTextureSkin.mat");r.LoadMaterial("haxor/material/opaque/lightmap/FlatTexture","./material/opaque/lightmap/FlatTexture.mat");r.LoadMaterial("haxor/material/opaque/diffuse/DiffuseSkin","./material/opaque/diffuse/DiffuseSkin.mat");r.LoadMaterial("haxor/material/opaque/diffuse/ToonSkin",
"./material/opaque/diffuse/ToonSkin.mat");r.LoadMaterial("haxor/material/transparent/unlit/Flat","./material/transparent/unlit/Flat.mat");r.LoadMaterial("haxor/material/transparent/unlit/FlatTexture","./material/transparent/unlit/FlatTexture.mat");r.LoadMaterial("haxor/material/transparent/unlit/FlatTextureSkin","./material/transparent/unlit/FlatTextureSkin.mat");r.LoadMaterial("haxor/material/transparent/unlit/ParticleAdditive","./material/transparent/unlit/ParticleAdditive.mat");r.LoadMaterial("haxor/material/transparent/unlit/ParticleAlpha",
"./material/transparent/unlit/ParticleAlpha.mat");r.LoadMaterial("haxor/material/opaque/diffuse/Diffuse","./material/opaque/diffuse/Diffuse.mat");r.LoadMaterial("haxor/material/opaque/diffuse/Flat","./material/opaque/diffuse/Flat.mat");r.LoadMaterial("haxor/material/screen/Displacement","./material/screen/Displacement.mat");return!1},OnLoadProgress:function(a,b){this.loader.SetProgress(r.get_progress())},OnLoadComplete:function(a,b){1<=r.get_progress()&&this.loader.Complete()},__class__:Nb});var Ua=
function(a){va.call(this,a)};k["haxor.component.ParticleRenderer"]=Ua;Ua.__name__=["haxor","component","ParticleRenderer"];Ua.__interfaces__=[$a];Ua.__super__=ia;Ua.prototype=s(ia.prototype,{get_emitted:function(){return this.m_emitted_count},get_playing:function(){return this.m_playing},get_bounds:function(){return this.m_mesh.get_bounds()},set_bounds:function(a){this.m_mesh.set_bounds(a);return a},get_count:function(){return this.m_count},set_count:function(a){this.m_count=a;this.Reset();this.UpdateMesh();
return a},OnBuild:function(){ia.prototype.OnBuild.call(this);this.m_state=za.Reset;this.m_kernel=new Na(this);this.elapsed=0;this.m_playing=!1;this.m_emitted_start=this.m_emitted_count=0;this.set_count(10);this.duration=1;this.emitter=new Xb(1);this.sheet=new Rc;this.billboard=this.loop=this.local=!0;this.start=new Sc;this.life=new Tc;this.rate=new Va(1,1);this.force=new n},Emit:function(a){null==a&&(a=1);var b=this.get_count()-this.get_emitted(),b=Math.min(a,b);this.loop&&(this.m_emitted_start+=
a-b);this.m_emitted_count+=b;this.m_playing=!0},Play:function(){this.m_playing=!0},Pause:function(){this.m_playing=!1},Reset:function(){this.m_emitted_start=this.m_emitted_count=this.elapsed=0},Stop:function(){this.m_emitted_start=this.m_emitted_count=this.elapsed=0;this.m_state=za.Reset;this.m_playing=!1},Simulate:function(){switch(this.m_state[1]){case 0:this.m_playing&&(this.m_state=za.Update);break;case 1:this.m_state=this.m_playing?za.Update:za.None;break;case 2:if(!this.m_playing){this.m_state=
za.None;break}var a=Math.max(this.start.life.start,this.start.life.end);if(this.elapsed>=this.duration+a&&!this.loop)break;var b=q.m_delta,c=l.Clamp01(0>=this.duration?0:this.elapsed/this.duration);this.elapsed+=b;this.elapsed>=this.duration+a&&(this.elapsed=this.duration+a);a=b*l.Lerp(this.rate.start,this.rate.end,this.rate.random?Math.random():Math.pow(c,this.rate.curve));this.Emit(a)}},OnUpdate:function(){this.Simulate()},UpdateMesh:function(){null!=this.m_particles&&v.Destroy(this.m_particles);
this.m_particles=new Ka;this.m_particles.set_name("ParticleMesh"+this.get_uid());this.m_particles.set_bounds(ba.FromCenter(0,0,0,1,1,1));this.set_mesh(this.m_particles);for(var a=[],b=[new n(-.5,.5,0),new n(-.5,-.5,0),new n(.5,-.5,0),new n(-.5,.5,0),new n(.5,-.5,0),new n(.5,.5,0)],c=0,d=this.get_count();c<d;)for(var f=c++,m=0,e=b.length;m<e;){var oa=m++,oa=b[oa].get_clone();oa.z=f;a.push(oa)}this.m_particles.set_vertex(a)},__class__:Ua,__properties__:s(ia.prototype.__properties__,{set_count:"set_count",
get_count:"get_count",set_bounds:"set_bounds",get_bounds:"get_bounds",get_playing:"get_playing",get_emitted:"get_emitted"})});var rc=function(a){va.call(this,a)};k["examples.dungeon.ParticleRunning"]=rc;rc.__name__=["examples","dungeon","ParticleRunning"];rc.__super__=Ua;rc.prototype=s(Ua.prototype,{OnBuild:function(){Ua.prototype.OnBuild.call(this);this.set_name("ParticleRunning");var a=r.Get("ParticleRunningMaterial");if(null==a){a=r.Instantiate(r.Get("haxor/material/transparent/unlit/ParticleAlpha"));
a.set_name("ParticleRunningMaterial");var b=r.Get("Dust");a.set_shader(null==C.m_flat_particle_shader?C.m_flat_particle_shader=new C(ea.flat_particle_source):C.m_flat_particle_shader);a.SetTexture("Texture",b);a.zwrite=!1;r.Add("ParticleRunningMaterial",a)}this.set_material(a);a=this.life.color=new z(1,1,y.RGBA8);b=t.FromBytes(70,100,145);a.m_data.SetPixel(0,0,b);a.Apply();(this.emitter=new tc(45,1,30)).ranges=[0,0,0,1E3,0,0];this.set_count(30);this.loop=!0;this.local=!1;this.rate.start=this.rate.end=
0;this.sheet.frame.start=0;this.sheet.frame.end=0;this.sheet.frame.random=!0;this.sheet.length=10;this.sheet.fps=15;this.sheet.width=51.2;this.sheet.height=64;this.start.life.start=1;this.start.life.end=1;this.start.life.random=!0;this.start.speed.start=3;this.start.speed.end=8;this.start.speed.random=!0;this.life.size.start=(new n(1,1,1)).Scale(40);this.life.size.end=(new n(1,1,1)).Scale(40);this.m_mesh.set_bounds(ba.FromCenter(0,0,0,30,30,30))},__class__:rc});var Wb=function(a){va.call(this,a)};
k["examples.dungeon.ParticleTorch"]=Wb;Wb.__name__=["examples","dungeon","ParticleTorch"];Wb.__super__=Ua;Wb.prototype=s(Ua.prototype,{get_strength:function(){return this.m_strength},set_strength:function(a){this.m_strength=0>=a?0:1<=a?1:a;this.start.life.start=2+this.m_strength;this.start.life.end=3+2*this.m_strength;return this.m_strength},OnBuild:function(){Ua.prototype.OnBuild.call(this);this.set_name("ParticleTorch");var a=r.Get("ParticleTorchMaterial"),b=r.Get("Fire"),a=r.Instantiate(r.Get("haxor/material/transparent/unlit/ParticleAdditive"));
a.set_shader(null==C.m_flat_particle_shader?C.m_flat_particle_shader=new C(ea.flat_particle_source):C.m_flat_particle_shader);a.set_name("ParticleTorchMaterial");a.SetTexture("Texture",b);a.zwrite=!1;this.set_material(a);this.emitter=new Xb(10);this.set_count(64);this.loop=!0;this.local=!1;this.rate.start=this.rate.end=20;this.sheet.length=4;this.sheet.fps=8;this.sheet.width=b.m_width/2;this.sheet.height=b.m_height/2;this.sheet.wrap=ra.Loop;this.start.life.start=2;this.start.life.end=10;this.start.life.random=
!0;this.start.speed.start=1;this.start.speed.end=2;this.start.speed.random=!0;this.start.size.start=(new n(1,1,1)).Scale(10);this.start.size.end=(new n(1,1,1)).Scale(20);this.force=new n(0,1,0);this.life.color=r.Get("FireColor");this.wind=0;this.life.size.start=(new n(1,1,1)).Scale(2);this.life.size.end=(new n(1,1,1)).Scale(0);this.life.speed.start=3;this.life.speed.end=8;this.life.speed.random=!0;this.m_mesh.set_bounds(ba.FromCenter(0,0,0,30,30,30));this.Play()},OnUpdate:function(){Ua.prototype.OnUpdate.call(this);
var a=Math.sin(.1*q.m_elapsed),b=Math.cos(.2*(q.m_elapsed+.5));this.force.Set(a*b,this.force.y,0)},__class__:Wb,__properties__:s(Ua.prototype.__properties__,{set_strength:"set_strength",get_strength:"get_strength"})});var sc=function(){this.m_container=window.document.getElementById("loader");this.m_fill=window.document.getElementById("progress");this.m_fill.style.transition="width 1.0s ease-out"};k["examples.utils.LoaderHTML"]=sc;sc.__name__=["examples","utils","LoaderHTML"];sc.prototype={Complete:function(){var a=
this;jb.delay(function(){a.m_container.style.opacity="0.0";jb.delay(function(){a.m_container.remove()},600)},1500)},SetProgress:function(a){this.m_fill.style.width=Math.floor(100*a)+"%"},__class__:sc};var jb=function(a){var b=this;this.id=setInterval(function(){b.run()},a)};k["haxe.Timer"]=jb;jb.__name__=["haxe","Timer"];jb.delay=function(a,b){var c=new jb(b);c.run=function(){c.stop();a()};return c};jb.stamp=function(){return(new Date).getTime()/1E3};jb.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),
this.id=null)},run:function(){},__class__:jb};var bb=function(a,b){this.length=a;this.b=b};k["haxe.io.Bytes"]=bb;bb.__name__=["haxe","io","Bytes"];bb.alloc=function(a){for(var b=[],c=0;c<a;)c++,b.push(0);return new bb(a,b)};bb.ofString=function(a){for(var b=[],c=0;c<a.length;){var d=B.fastCodeAt(a,c++);55296<=d&&56319>=d&&(d=d-55232<<10|B.fastCodeAt(a,c++)&1023);127>=d?b.push(d):(2047>=d?b.push(192|d>>6):(65535>=d?b.push(224|d>>12):(b.push(240|d>>18),b.push(128|d>>12&63)),b.push(128|d>>6&63)),b.push(128|
d&63))}return new bb(b.length,b)};bb.prototype={get:function(a){return this.b[a]},set:function(a,b){this.b[a]=b&255},getString:function(a,b){if(0>a||0>b||a+b>this.length)throw Wa.OutsideBounds;for(var c="",d=this.b,f=String.fromCharCode,m=a,e=a+b;m<e;){var oa=d[m++];if(128>oa){if(0==oa)break;c+=f(oa)}else if(224>oa)c+=f((oa&63)<<6|d[m++]&127);else if(240>oa)var g=d[m++],c=c+f((oa&31)<<12|(g&127)<<6|d[m++]&127);else var g=d[m++],h=d[m++],oa=(oa&15)<<18|(g&127)<<12|(h&127)<<6|d[m++]&127,c=c+f((oa>>
10)+55232),c=c+f(oa&1023|56320)}return c},toString:function(){return this.getString(0,this.length)},__class__:bb};var kb=function(){};k["haxe.crypto.Base64"]=kb;kb.__name__=["haxe","crypto","Base64"];kb.encode=function(a,b){null==b&&(b=!0);var c=(new uc(kb.BYTES)).encodeBytes(a).toString();if(b)for(var d=0,f=(3-4*a.length%3)%3;d<f;)d++,c+="=";return c};kb.decode=function(a,b){null==b&&(b=!0);if(b)for(;61==E.cca(a,a.length-1);)a=E.substr(a,0,-1);return(new uc(kb.BYTES)).decodeBytes(bb.ofString(a))};
var uc=function(a){for(var b=a.length,c=1;b>1<<c;)c++;if(8<c||b!=1<<c)throw"BaseCode : base length must be a power of two.";this.base=a;this.nbits=c};k["haxe.crypto.BaseCode"]=uc;uc.__name__=["haxe","crypto","BaseCode"];uc.prototype={encodeBytes:function(a){for(var b=this.nbits,c=this.base,d=8*a.length/b|0,f=bb.alloc(d+(0==8*a.length%b?0:1)),m=0,e=0,oa=(1<<b)-1,g=0,h=0;h<d;){for(;e<b;)e+=8,m<<=8,m|=a.get(g++);e-=b;f.set(h++,c.b[m>>e&oa])}0<e&&f.set(h++,c.b[m<<b-e&oa]);return f},initTable:function(){for(var a=
[],b=0;256>b;){var c=b++;a[c]=-1}b=0;for(c=this.base.length;b<c;){var d=b++;a[this.base.b[d]]=d}this.tbl=a},decodeBytes:function(a){var b=this.nbits;null==this.tbl&&this.initTable();for(var c=this.tbl,d=a.length*b>>3,f=bb.alloc(d),m=0,e=0,g=0,h=0;h<d;){for(;8>e;){var e=e+b,m=m<<b,l=c[a.get(g++)];if(-1==l)throw"BaseCode : invalid encoded char";m|=l}e-=8;f.set(h++,m>>e&255)}return f},__class__:uc};var Pb=function(){this.h={}};k["haxe.ds.IntMap"]=Pb;Pb.__name__=["haxe","ds","IntMap"];Pb.__interfaces__=
[Pc];Pb.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},exists:function(a){return this.h.hasOwnProperty(a)},__class__:Pb};var lb=function(){this.h={};this.h.__keys__={}};k["haxe.ds.ObjectMap"]=lb;lb.__name__=["haxe","ds","ObjectMap"];lb.__interfaces__=[Pc];lb.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++lb.count);this.h[c]=b;this.h.__keys__[c]=a},get:function(a){return this.h[a.__id__]},exists:function(a){return null!=this.h.__keys__[a.__id__]},keys:function(){var a=
[],b;for(b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return E.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref[a.__id__]}}},__class__:lb};var fb=function(){this.h={}};k["haxe.ds.StringMap"]=fb;fb.__name__=["haxe","ds","StringMap"];fb.__interfaces__=[Pc];fb.prototype={set:function(a,b){this.h["$"+a]=b},get:function(a){return this.h["$"+a]},exists:function(a){return this.h.hasOwnProperty("$"+
a)},remove:function(a){a="$"+a;if(!this.h.hasOwnProperty(a))return!1;delete this.h[a];return!0},keys:function(){var a=[],b;for(b in this.h)this.h.hasOwnProperty(b)&&a.push(b.substr(1));return E.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref["$"+a]}}},__class__:fb};var Id=function(){};k["haxe.io.Eof"]=Id;Id.__name__=["haxe","io","Eof"];Id.prototype={toString:function(){return"Eof"},__class__:Id};
var Wa={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:["Blocked",0]};Wa.Blocked.toString=A;Wa.Blocked.__enum__=Wa;Wa.Overflow=["Overflow",1];Wa.Overflow.toString=A;Wa.Overflow.__enum__=Wa;Wa.OutsideBounds=["OutsideBounds",2];Wa.OutsideBounds.toString=A;Wa.OutsideBounds.__enum__=Wa;Wa.Custom=function(a){a=["Custom",3,a];a.__enum__=Wa;a.toString=A;return a};var qb=function(){};k["haxe.xml.Parser"]=qb;qb.__name__=["haxe","xml","Parser"];qb.parse=function(a){var b=
G.createDocument();qb.doParse(a,0,b);return b};qb.doParse=function(a,b,c){null==b&&(b=0);for(var d=null,f=1,m=1,e=null,g=0,h=0,l=0,k=a.charCodeAt(b),n=new Ib;k==k;){switch(f){case 0:switch(k){case 10:case 13:case 9:case 32:break;default:f=m;continue}break;case 1:switch(k){case 60:f=0;m=2;break;default:g=b;f=13;continue}break;case 13:60==k?(m=G.createPCData(n.b+E.substr(a,g,b-g)),n=new Ib,c.addChild(m),h++,f=0,m=2):38==k&&(n.addSub(a,g,b-g),f=18,m=13,g=b+1);break;case 17:93==k&&93==a.charCodeAt(b+
1)&&62==a.charCodeAt(b+2)&&(f=G.createCData(E.substr(a,g,b-g)),c.addChild(f),h++,b+=2,f=1);break;case 2:switch(k){case 33:if(91==a.charCodeAt(b+1)){b+=2;if("CDATA["!=E.substr(a,b,6).toUpperCase())throw"Expected <![CDATA[";b+=5;f=17}else if(68==a.charCodeAt(b+1)||100==a.charCodeAt(b+1)){if("OCTYPE"!=E.substr(a,b+2,6).toUpperCase())throw"Expected <!DOCTYPE";b+=8;f=16}else{if(45!=a.charCodeAt(b+1)||45!=a.charCodeAt(b+2))throw"Expected \x3c!--";b+=2;f=15}g=b+1;break;case 63:f=14;g=b;break;case 47:if(null==
c)throw"Expected node name";g=b+1;f=0;m=10;break;default:f=3;g=b;continue}break;case 3:if(!(97<=k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)){if(b==g)throw"Expected node name";d=G.createElement(E.substr(a,g,b-g));c.addChild(d);f=0;m=4;continue}break;case 4:switch(k){case 47:f=11;h++;break;case 62:f=9;h++;break;default:f=5;g=b;continue}break;case 5:if(!(97<=k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)){if(g==b)throw"Expected attribute name";e=E.substr(a,
g,b-g);if(d.exists(e))throw"Duplicate attribute";f=0;m=6;continue}break;case 6:switch(k){case 61:f=0;m=7;break;default:throw"Expected =";}break;case 7:switch(k){case 34:case 39:f=8;g=b;break;default:throw'Expected "';}break;case 8:k==a.charCodeAt(g)&&(m=E.substr(a,g+1,b-g-1),d.set(e,m),f=0,m=4);break;case 9:g=b=qb.doParse(a,b,d);f=1;break;case 11:switch(k){case 62:f=1;break;default:throw"Expected >";}break;case 12:switch(k){case 62:return 0==h&&c.addChild(G.createPCData("")),b;default:throw"Expected >";
}case 10:if(!(97<=k&&122>=k||65<=k&&90>=k||48<=k&&57>=k||58==k||46==k||95==k||45==k)){if(g==b)throw"Expected node name";if(E.substr(a,g,b-g)!=c.get_nodeName())throw"Expected </"+c.get_nodeName()+">";f=0;m=12;continue}break;case 15:45==k&&45==a.charCodeAt(b+1)&&62==a.charCodeAt(b+2)&&(c.addChild(G.createComment(E.substr(a,g,b-g))),b+=2,f=1);break;case 16:91==k?l++:93==k?l--:62==k&&0==l&&(c.addChild(G.createDocType(E.substr(a,g,b-g))),f=1);break;case 14:63==k&&62==a.charCodeAt(b+1)&&(b++,f=E.substr(a,
g+1,b-g-2),c.addChild(G.createProcessingInstruction(f)),f=1);break;case 18:59==k&&(g=E.substr(a,g,b-g),35==g.charCodeAt(0)?(g=120==g.charCodeAt(1)?w.parseInt("0"+E.substr(g,1,g.length-1)):w.parseInt(E.substr(g,1,g.length-1)),n.add(String.fromCharCode(g))):qb.escapes.exists(g)?n.add(qb.escapes.get(g)):n.b+=w.string("&"+g+";"),g=b+1,f=m)}k=B.fastCodeAt(a,++b)}1==f&&(g=b,f=13);if(13==f)return b==g&&0!=h||c.addChild(G.createPCData(n.b+E.substr(a,g,b-g))),b;throw"Unexpected end";};var Qb=function(){};
k["haxor.core.IResizeable"]=Qb;Qb.__name__=["haxor","core","IResizeable"];Qb.prototype={__class__:Qb};var U=function(a){v.call(this,a)};k["haxor.component.Camera"]=U;U.__name__=["haxor","component","Camera"];U.__interfaces__=[Qb];U.__properties__={set_main:"set_main",get_main:"get_main",get_current:"get_current",get_list:"get_list"};U.get_list=function(){return g.camera.list.slice()};U.get_current=function(){return U.m_current};U.get_main=function(){return U.m_main};U.set_main=function(a){return U.m_main=
a};U.__super__=M;U.prototype=s(M.prototype,{get_mask:function(){return this.m_mask},set_mask:function(a){if(this.m_mask==a)return a;var b=this.m_mask=a;this.m_layers=[];for(var c=0;32>c;){var d=c++;0!=(b&1)&&this.m_layers.push(1<<d);b>>=1}return a},get_fov:function(){return this.m_fov},set_fov:function(a){this.m_fov=a;this.m_projection_dirty=!0;return a},get_near:function(){return this.m_near},set_near:function(a){this.m_near=a;this.m_proj_uniform_dirty=this.m_projection_dirty=!0;return a},get_far:function(){return this.m_far},
set_far:function(a){this.m_far=a;this.m_proj_uniform_dirty=this.m_projection_dirty=!0;return a},get_order:function(){return this.m_order},set_order:function(a){if(this.m_order==a)return a;this.m_order=a;g.camera.SortCameraList();return this.m_order},get_pixelViewport:function(){return this.m_pixelViewport.get_clone()},get_viewport:function(){return this.m_viewport.get_clone()},set_viewport:function(a){this.m_viewport.SetAABB2(a);g.camera.UpdateViewport(this);return a},get_CameraToWorld:function(){return this.m_entity.m_transform.get_WorldMatrix()},
get_WorldToCamera:function(){return this.m_entity.m_transform.get_WorldMatrixInverse()},get_ProjectionMatrix:function(){this.UpdateProjection();return this.m_projectionMatrix},get_ProjectionMatrixInverse:function(){this.UpdateProjection();return this.m_projectionMatrixInverse},get_target:function(){return this.m_target},set_target:function(a){this.m_target=a;g.camera.UpdateViewport(this);return a},get_quality:function(){return this.m_quality},set_quality:function(a){this.m_quality=0>=a?0:1<=a?1:a;
g.camera.UpdateViewport(this);return a},get_captureDepth:function(){return this.m_captureDepth},set_captureDepth:function(a){this.m_captureDepth=a;g.camera.ClearTargets(this);g.camera.UpdateViewport(this);return a},get_filters:function(){return this.m_filters},set_filters:function(a){return this.m_filters=null==a?[]:a},get_frustum:function(){this.UpdateProjection();return this.m_frustum},get_mode:function(){return this.m_mode},set_mode:function(a){if(this.m_mode==a)return a;this.m_mode=a;this.UpdateProjection();
return a},get_screen:function(){return this.m_screen.get_clone()},set_screen:function(a){this.m_screen.SetAABB2(a);this.UpdateProjection();return a},OnBuild:function(){M.prototype.OnBuild.call(this);g.camera.Create(this);null==U.m_main&&(U.m_main=this);this.m_order=0;this.m_quality=1;this.m_pixelViewport=Ca.get_empty();this.m_viewport=Ca.get_empty();this.m_aabb=ba.get_empty();this.m_projectionMatrix=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);this.m_projectionMatrixInverse=new x(1,0,0,0,0,1,0,0,0,0,1,
0,0,0,0,1);this.m_skyboxProjection=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);this.m_skyboxProjectionInverse=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);this.m_fov=60;this.m_near=.1;this.m_far=500;this.m_filters=[];this.background=new t(0,0,0,1);this.clear=Xa.ColorDepth;this.set_mask(1);this.set_viewport(new Ca(0,0,1,1));this.m_proj_uniform_dirty=this.m_view_uniform_dirty=this.m_projection_dirty=!0;this.m_mode=La.Perspective;this.m_screen=Ca.FromMinMax(-1,1,-1,1);this.m_frustum=[new Q,new Q,new Q,new Q,new Q,
new Q,new Q,new Q]},WorldToProjection:function(a,b){var c;c=null==b?new Q:b;c.w=1;c.x=a.x;c.y=a.y;c.z=a.z;this.get_WorldToCamera().Transform4x4(c);this.UpdateProjection();this.m_projectionMatrix.Transform4x4(c);return c},WorldToDepth:function(a){var b=this.get_WorldToCamera();return b.m20*a.x+b.m21*a.y+b.m22*a.z+b.m23},IsCulled:function(a){return this.WorldToProjection(a).IsCulled()},LookAt:function(a,b,c){null==c&&(c=0);this.m_entity.m_transform.LookAt(a,b,c)},UpdateProjection:function(){if(this.m_projection_dirty){this.m_projection_dirty=
!1;this.m_view_uniform_dirty=!0;switch(this.m_mode[1]){case 1:x.Perspective(this.m_fov,this.m_aspect,this.m_near,this.m_far,this.m_projectionMatrix);x.PerspectiveInverse(this.m_fov,this.m_aspect,this.m_near,this.m_far,this.m_projectionMatrixInverse);x.Perspective(this.m_fov,this.m_aspect,.1,1E5,this.m_skyboxProjection);x.PerspectiveInverse(this.m_fov,this.m_aspect,.1,1E5,this.m_skyboxProjectionInverse);break;case 2:this.m_projectionMatrix.SetOrtho(this.m_screen.get_xMin(),this.m_screen.get_xMax(),
this.m_screen.get_yMax(),this.m_screen.get_yMin(),this.m_near,-this.m_far);this.m_projectionMatrixInverse.SetOrthoInverse(this.m_screen.get_xMin(),this.m_screen.get_xMax(),this.m_screen.get_yMax(),this.m_screen.get_yMin(),this.m_near,-this.m_far);this.m_skyboxProjection.SetOrtho(this.m_screen.get_xMin(),this.m_screen.get_xMax(),this.m_screen.get_yMax(),this.m_screen.get_yMin(),this.m_near,-this.m_far);this.m_skyboxProjectionInverse.SetOrthoInverse(this.m_screen.get_xMin(),this.m_screen.get_xMax(),
this.m_screen.get_yMax(),this.m_screen.get_yMin(),this.m_near,-this.m_far);break;case 3:this.m_projectionMatrix.SetOrtho(0,H.m_width,0,H.m_height,this.m_near,-this.m_far),this.m_projectionMatrixInverse.SetOrthoInverse(0,H.m_width,0,H.m_height,this.m_near,-this.m_far),this.m_skyboxProjection.SetOrtho(0,H.m_width,0,H.m_height,this.m_near,-this.m_far),this.m_skyboxProjectionInverse.SetOrthoInverse(0,H.m_width,0,H.m_height,this.m_near,-this.m_far)}var a,b=0,c=0;a=this.m_frustum[c++];a.Set(-1,1,-1,1);
this.m_projectionMatrixInverse.Transform4x4(a);b=0>=a.w?0:1/a.w;a.Scale(b);a=this.m_frustum[c++];a.Set(-1,-1,-1,1);this.m_projectionMatrixInverse.Transform4x4(a);b=0>=a.w?0:1/a.w;a.Scale(b);a=this.m_frustum[c++];a.Set(1,-1,-1,1);this.m_projectionMatrixInverse.Transform4x4(a);b=0>=a.w?0:1/a.w;a.Scale(b);a=this.m_frustum[c++];a.Set(1,1,-1,1);this.m_projectionMatrixInverse.Transform4x4(a);b=0>=a.w?0:1/a.w;a.Scale(b);a=this.m_frustum[c++];a.Set(-1,1,1,1);this.m_projectionMatrixInverse.Transform4x4(a);
b=0>=a.w?0:1/a.w;a.Scale(b);a=this.m_frustum[c++];a.Set(-1,-1,1,1);this.m_projectionMatrixInverse.Transform4x4(a);b=0>=a.w?0:1/a.w;a.Scale(b);a=this.m_frustum[c++];a.Set(1,-1,1,1);this.m_projectionMatrixInverse.Transform4x4(a);b=0>=a.w?0:1/a.w;a.Scale(b);a=this.m_frustum[c++];a.Set(1,1,1,1);this.m_projectionMatrixInverse.Transform4x4(a);b=0>=a.w?0:1/a.w;a.Scale(b)}},OnTransformUpdate:function(a){this.m_view_uniform_dirty=!0},OnDestroy:function(){g.camera.Destroy(this)},OnResize:function(a,b){this.m_mode==
La.UI&&this.UpdateProjection()},__class__:U,__properties__:s(M.prototype.__properties__,{set_screen:"set_screen",get_screen:"get_screen",set_mode:"set_mode",get_mode:"get_mode",get_frustum:"get_frustum",set_filters:"set_filters",get_filters:"get_filters",set_captureDepth:"set_captureDepth",get_captureDepth:"get_captureDepth",set_quality:"set_quality",get_quality:"get_quality",get_ProjectionMatrixInverse:"get_ProjectionMatrixInverse",get_ProjectionMatrix:"get_ProjectionMatrix",get_WorldToCamera:"get_WorldToCamera",
get_CameraToWorld:"get_CameraToWorld",set_viewport:"set_viewport",get_viewport:"get_viewport",get_pixelViewport:"get_pixelViewport",set_order:"set_order",get_order:"get_order",set_far:"set_far",get_far:"get_far",set_near:"set_near",get_near:"get_near",set_fov:"set_fov",get_fov:"get_fov",set_mask:"set_mask",get_mask:"get_mask"})});var rb=function(a){v.call(this,a)};k["haxor.component.CameraOrbit"]=rb;rb.__name__=["haxor","component","CameraOrbit"];rb.__interfaces__=[$a];rb.Create=function(a,b,c){null==
c&&(c=0);null==b&&(b=0);null==a&&(a=1);var d=new wa;d.set_name("camera_orbit");d.AddComponent(U).background=new t(0,0,0,1);d=d.AddComponent(rb);d.distance=a;d.smooth=0;d.angle=new K(b,c);return d};rb.__super__=M;rb.prototype=s(M.prototype,{get_pivot:function(){null==this.m_pivot&&(this.m_pivot=(new wa).m_transform,this.m_pivot.set_name(this.m_entity.get_name()),this.m_pivot.set_parent(this.m_entity.m_transform.m_parent),this.m_entity.m_transform.set_parent(this.m_pivot),this.m_entity.set_name("camera"),
this.m_pivot.set_position(this.m_entity.m_transform.get_position()));return this.m_pivot},OnBuild:function(){M.prototype.OnBuild.call(this);this.distance=0;this.m_pivot=this.get_pivot();this.follow=!1},OnStart:function(){this.m_distance=this.distance;this.m_angle=null==this.angle?new K(0,0):this.angle.get_clone();this.m_rotation=new F(0,0,0,1);var a=g.data.get_v3();a.Set(0,0,this.m_distance);this.m_entity.m_transform.set_localPosition(a)},OnUpdate:function(){var a;a=0>=this.smooth?1:q.m_delta*this.smooth;
this.m_angle.x=l.Lerp(this.m_angle.x,this.angle.x,a);this.m_angle.y=l.Lerp(this.m_angle.y,this.angle.y,a);this.m_distance=l.Lerp(this.m_distance,this.distance,a);a=g.data.get_q();a.SetAxisAngle(new n(0,1,0),this.m_angle.x);a.Multiply(g.data.get_q().SetAxisAngle(new n(1,0,0),-this.m_angle.y));this.get_pivot().set_localRotation(a);a=g.data.get_v3();a.Set(0,0,this.m_distance);this.m_entity.m_transform.set_localPosition(a);null!=this.target&&this.follow&&(a=this.get_pivot().get_localPosition(),a=n.Lerp(a,
this.target.get_localPosition(),q.m_delta*this.smooth),this.get_pivot().set_localPosition(a))},__class__:rb,__properties__:s(M.prototype.__properties__,{get_pivot:"get_pivot"})});var Jb=function(a){this.zoomSpeed=this.rotateSpeed=.5;this.rotate=this.zoom=!0;v.call(this,a)};k["haxor.component.CameraOrbitInput"]=Jb;Jb.__name__=["haxor","component","CameraOrbitInput"];Jb.__interfaces__=[$a];Jb.__super__=M;Jb.prototype=s(M.prototype,{OnStart:function(){this.m_orbit=this.m_entity.GetComponent(rb)},OnUpdate:function(){var a;
a=1==p.get_touches().length?p.get_touches()[0].delta.x:p.deltaMouse.x;var b;b=1==p.get_touches().length?p.get_touches()[0].delta.y:p.deltaMouse.y;this.rotate&&(p.Pressed(h.Mouse0)||1==p.get_touches().length)&&(this.m_orbit.angle.x+=-a*this.rotateSpeed,this.m_orbit.angle.y+=b*this.rotateSpeed);this.zoom&&(0<Math.abs(p.wheel)&&(this.m_orbit.distance=0>p.wheel?this.m_orbit.distance+this.zoomSpeed:this.m_orbit.distance+-this.zoomSpeed),2==p.get_touches().length&&(this.m_orbit.distance+=p.get_touches()[0].delta.y*
this.zoomSpeed*.05))},__class__:Jb});var Yb=function(){v.call(this,void 0);this.data=new fb};k["haxor.component.DataComponent"]=Yb;Yb.__name__=["haxor","component","DataComponent"];Yb.__super__=Ra;Yb.prototype=s(Ra.prototype,{__class__:Yb});var Va=function(a,b,c,d){null==d&&(d=!1);null==c&&(c=1);this.start=a;this.end=b;this.curve=c;this.random=d};k["haxor.component.ParticleAttribute"]=Va;Va.__name__=["haxor","component","ParticleAttribute"];Va.prototype={__class__:Va};var Sc=function(){this.life=
new Va(1,1);this.speed=new Va(1,1);this.size=new Va(new n(1,1,1),new n(1,1,1));this.rotation=new Va(new n(0,0,0),new n(0,0,0));this.color=z.get_white()};k["haxor.component.ParticleStart"]=Sc;Sc.__name__=["haxor","component","ParticleStart"];Sc.prototype={__class__:Sc};var Tc=function(){this.speed=new Va(1,1);this.motion=new Va(new n(1,1,1),new n(1,1,1));this.size=new Va(new n(1,1,1),new n(1,1,1));this.rotation=new Va(new n(0,0,0),new n(0,0,0));this.color=z.get_white()};k["haxor.component.ParticleLife"]=
Tc;Tc.__name__=["haxor","component","ParticleLife"];Tc.prototype={__class__:Tc};var Rc=function(){this.length=this.height=this.width=0;this.fps=60;this.frame=new Va(0,0);this.wrap=ra.Clamp;this.reverse=!1};k["haxor.component.ParticleSheet"]=Rc;Rc.__name__=["haxor","component","ParticleSheet"];Rc.prototype={__class__:Rc};var za={__ename__:!0,__constructs__:["None","Reset","Update"],None:["None",0]};za.None.toString=A;za.None.__enum__=za;za.Reset=["Reset",1];za.Reset.toString=A;za.Reset.__enum__=za;
za.Update=["Update",2];za.Update.toString=A;za.Update.__enum__=za;var Aa=function(){this.m_data=[0,0,0,0,0,0,0];this.set_surface(!1);this.set_random(!1);this.ranges=[-1E3,1E3,-1E3,1E3,-1E3,1E3]};k["haxor.component.ParticleEmitter"]=Aa;Aa.__name__=["haxor","component","ParticleEmitter"];Aa.prototype={get_surface:function(){return 0<this.m_data[1]},set_surface:function(a){this.m_data[1]=a?1:0;return a},get_random:function(){return 0<this.m_data[2]},set_random:function(a){this.m_data[2]=a?1:0;return a},
__class__:Aa,__properties__:{set_random:"set_random",get_random:"get_random",set_surface:"set_surface",get_surface:"get_surface"}};var Xb=function(a){null==a&&(a=1);Aa.call(this);this.m_data[0]=0;this.set_radius(a)};k["haxor.component.SphereEmitter"]=Xb;Xb.__name__=["haxor","component","SphereEmitter"];Xb.__super__=Aa;Xb.prototype=s(Aa.prototype,{get_radius:function(){return this.m_data[3]},set_radius:function(a){return this.m_data[3]=a},__class__:Xb,__properties__:s(Aa.prototype.__properties__,{set_radius:"set_radius",
get_radius:"get_radius"})});var tc=function(a,b,c){null==c&&(c=1);null==b&&(b=1);null==a&&(a=1);Aa.call(this);this.m_data[0]=1;this.set_width(a);this.set_height(b);this.set_depth(c)};k["haxor.component.BoxEmitter"]=tc;tc.__name__=["haxor","component","BoxEmitter"];tc.__super__=Aa;tc.prototype=s(Aa.prototype,{get_width:function(){return this.m_data[3]},set_width:function(a){return this.m_data[3]=a},get_height:function(){return this.m_data[4]},set_height:function(a){return this.m_data[4]=a},get_depth:function(){return this.m_data[5]},
set_depth:function(a){return this.m_data[5]=a},__class__:tc,__properties__:s(Aa.prototype.__properties__,{set_depth:"set_depth",get_depth:"get_depth",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width"})});var Uc=function(a,b){null==b&&(b=1);null==a&&(a=45);Aa.call(this);this.m_data[0]=2;this.set_angle(a);this.set_height(b)};k["haxor.component.ConeEmitter"]=Uc;Uc.__name__=["haxor","component","ConeEmitter"];Uc.__super__=Aa;Uc.prototype=s(Aa.prototype,{get_angle:function(){return this.m_data[3]},
set_angle:function(a){return this.m_data[3]=a},get_height:function(){return this.m_data[4]},set_height:function(a){return this.m_data[4]=a},__class__:Uc,__properties__:s(Aa.prototype.__properties__,{set_height:"set_height",get_height:"get_height",set_angle:"set_angle",get_angle:"get_angle"})});var Vc=function(a,b){null==b&&(b=1);null==a&&(a=1);Aa.call(this);this.m_data[0]=3;this.set_radius(a);this.set_height(b)};k["haxor.component.CylinderEmitter"]=Vc;Vc.__name__=["haxor","component","CylinderEmitter"];
Vc.__super__=Aa;Vc.prototype=s(Aa.prototype,{get_radius:function(){return this.m_data[3]},set_radius:function(a){return this.m_data[3]=a},get_height:function(){return this.m_data[4]},set_height:function(a){return this.m_data[4]=a},__class__:Vc,__properties__:s(Aa.prototype.__properties__,{set_height:"set_height",get_height:"get_height",set_radius:"set_radius",get_radius:"get_radius"})});var Ob=function(a){va.call(this,a)};k["haxor.component.SkinnedMeshRenderer"]=Ob;Ob.__name__=["haxor","component",
"SkinnedMeshRenderer"];Ob.__super__=ia;Ob.prototype=s(ia.prototype,{set_joints:function(a){this.m_joints=null==a?[]:a;this.m_jf32=[];a=0;for(var b=this.m_joints.length;a<b;)for(var c=a++,d=0;12>d;){var f=d++;this.m_jf32.push(this.m_joints[c].get_WorldMatrix().GetIndex(f))}this.UpdateSkinTexture(this.m_joints.length);e.BONE_TEXTURE||this.m_joints.length>e.get_MAX_UNIFORM_BONES()&&u.LogWarning("SkinnedMeshRenderer> ["+this.get_name()+"] max bone count exceeded!");return this.m_joints},get_joints:function(){return this.m_joints},
set_mesh:function(a){this.m_bmf32=[];if(null!=a){this.UpdateSkinTexture(a.get_binds().length);for(var b=0,c=a.get_binds().length;b<c;)for(var d=b++,f=0;12>f;){var m=f++;this.m_bmf32.push(a.get_binds()[d].GetIndex(m))}}e.BONE_TEXTURE&&g.renderer.UpdateSkinning(this,!1);return ia.prototype.set_mesh.call(this,a)},get_quality:function(){return this.m_quality},set_quality:function(a){return this.m_quality=a},OnBuild:function(){this.__smid=-1;ia.prototype.OnBuild.call(this);this.m_joints=[];this.m_bmf32=
[];this.m_jf32=[];this.m_quality=Ba.Bone2},OnRender:function(){if(null!=this.m_material){for(var a=0,b=0,c=this.m_joints.length;b<c;)for(var d=b++,f=0;12>f;){var m=f++;this.m_jf32[a++]=this.m_joints[d].get_WorldMatrix().GetIndex(m)}e.BONE_TEXTURE?g.renderer.UpdateSkinning(this,!0):(this.m_material.SetFloat4Array("Joints",this.m_jf32),this.m_material.SetFloat4Array("Binds",this.m_bmf32));a=2;switch(this.m_quality[1]){case 0:a=2;break;case 1:a=1;break;case 2:a=2;break;case 3:a=3;break;case 4:a=4}this.m_material.SetInt("SkinQuality",
a)}ia.prototype.OnRender.call(this)},UpdateSkinTexture:function(a){!e.BONE_TEXTURE||0>=a||(null!=this.m_jt&&v.Destroy(this.m_jt),null!=this.m_bmt&&v.Destroy(this.m_bmt),a=this.GetSkinTexSize(a),this.m_jt=new Rb(a.x,a.y,y.Float4),this.m_bmt=new Rb(a.x,a.y,y.Float4))},GetSkinTexSize:function(a){var b=1,c=1;for(a*=3;b*c<a;){b<<=1;if(b*c>=a)break;c<<=1;if(b*c>=a)break;if(512<=b&&512<=c)break}return g.data.get_v2().Set(b,c)},__class__:Ob,__properties__:s(ia.prototype.__properties__,{set_quality:"set_quality",
get_quality:"get_quality",set_joints:"set_joints",get_joints:"get_joints"})});var Ea=function(a){v.call(this,a)};k["haxor.component.Transform"]=Ea;Ea.__name__=["haxor","component","Transform"];Ea.__properties__={get_root:"get_root"};Ea.TransformConcat=function(a){var b=a.m_parent.m_worldMatrix,c=a.m_worldMatrix;c.m00=b.m00;c.m01=b.m01;c.m02=b.m02;c.m03=b.m03;c.m10=b.m10;c.m11=b.m11;c.m12=b.m12;c.m13=b.m13;c.m20=b.m20;c.m21=b.m21;c.m22=b.m22;c.m23=b.m23;c.MultiplyTransform(a.m_localMatrix);a.m_wsp_dirty=
!0;a.m_wsrs_dirty=!0;a.m_right.Set(c.m00,c.m10,c.m20).Normalize();a.m_up.Set(c.m01,c.m11,c.m21).Normalize();a.m_forward.Set(c.m02,c.m12,c.m22).Normalize();a.m_inverse_dirty=!0};Ea.get_root=function(){return Ea.m_root};Ea.__super__=Ra;Ea.prototype=s(Ra.prototype,{get_right:function(){this.UpdateWorldMatrix();return this.m_right.get_clone()},set_right:function(a){return a},get_up:function(){this.UpdateWorldMatrix();return this.m_up.get_clone()},set_up:function(a){return a},get_forward:function(){this.UpdateWorldMatrix();
return this.m_forward.get_inverse()},set_forward:function(a){return a},get_parent:function(){return this.m_parent},set_parent:function(a){this.get_position();this.get_rotation();this.get_scale();null!=this.m_parent&&E.remove(this.m_parent.m_hierarchy,this);this.m_parent=null==a?Ea.m_root:a;this.m_parent.m_hierarchy.push(this);this.Invalidate();return this.m_parent},get_childCount:function(){return this.m_hierarchy.length},get_localPosition:function(){return this.m_localPosition.get_clone()},set_localPosition:function(a){var b=
a.y-this.m_localPosition.y,c=a.z-this.m_localPosition.z;if(1E-4>Math.abs(a.x-this.m_localPosition.x)&&1E-4>Math.abs(b)&&1E-4>Math.abs(c))return a;this.m_localPosition.Set3(a);this.m_lmt_dirty=!0;this.Invalidate();return a},get_localRotation:function(){return this.m_localRotation.get_clone()},set_localRotation:function(a){var b=a.x-this.m_localRotation.x,c=a.y-this.m_localRotation.y,d=a.z-this.m_localRotation.z,f=a.w-this.m_localRotation.w;if(1E-4>(0>b?-b:b)&&1E-4>(0>c?-c:c)&&1E-4>(0>d?-d:d)&&1E-4>
(0>f?-f:f))return a;this.m_localRotation.SetQuaternion(a);this.m_lmrs_dirty=!0;this.Invalidate();return a},get_localEuler:function(){return this.m_localRotation.get_euler()},set_localEuler:function(a){this.set_localRotation(F.FromEuler(a,g.data.get_q()));return a},get_localScale:function(){return this.m_localScale.get_clone()},set_localScale:function(a){var b=a.y-this.m_localScale.y,c=a.z-this.m_localScale.z;if(1E-4>Math.abs(a.x-this.m_localScale.x)&&1E-4>Math.abs(b)&&1E-4>Math.abs(c))return a;this.m_localScale.Set3(a);
this.m_lmrs_dirty=!0;this.Invalidate();return a},get_position:function(){this.UpdateWorldMatrix();this.UpdateWSP();return this.m_position.get_clone()},set_position:function(a){this.set_localPosition(this.m_parent.get_WorldMatrixInverse().Transform3x4(g.data.get_v3().Set3(a)));return a},get_rotation:function(){this.UpdateWorldMatrix();this.UpdateWSRS();return this.m_rotation.get_clone()},set_rotation:function(a){this.UpdateWorldMatrix();this.UpdateWSRS();var b=F.Inverse(this.m_rotation,g.data.get_q());
this.set_localRotation(g.data.get_q().SetQuaternion(a).Multiply(b));return a},get_euler:function(){return this.get_rotation().get_euler()},set_euler:function(a){this.set_rotation(F.FromEuler(a,g.data.get_q()));return a},get_scale:function(){this.UpdateWorldMatrix();this.UpdateWSRS();return this.m_scale.get_clone()},get_WorldMatrix:function(){this.UpdateWorldMatrix();return this.m_worldMatrix},get_WorldMatrixInverse:function(){this.UpdateWorldMatrix();this.m_inverse_dirty&&(x.GetInverseTransform(this.m_worldMatrix,
this.m_worldMatrixInverse),this.m_inverse_dirty=!1);return this.m_worldMatrixInverse},OnBuild:function(){Ra.prototype.OnBuild.call(this);this.__cid=g.transform.tid.get_id();this.m_localPosition=new n(0,0,0);this.m_localRotation=new F(0,0,0,1);this.m_localScale=new n(1,1,1);this.m_position=new n(0,0,0);this.m_rotation=new F(0,0,0,1);this.m_scale=new n(1,1,1);this.m_locked=this.m_wsrs_dirty=this.m_wsp_dirty=this.m_inverse_dirty=this.m_dirty=this.m_lmrs_dirty=this.m_lmt_dirty=!1;this.m_uniform_dirty=
!0;this.m_right=new n(1,0,0);this.m_up=new n(0,1,0);this.m_forward=n.get_forward();this.m_localMatrix=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);this.m_worldMatrixInverse=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);this.m_worldMatrix=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);this.m_hierarchy=[];null!=Ea.m_root?this.set_parent(null):Ea.m_root=this},UpdateLMT:function(){this.m_localMatrix.m03=this.m_localPosition.x;this.m_localMatrix.m13=this.m_localPosition.y;this.m_localMatrix.m23=this.m_localPosition.z},UpdateWSP:function(){this.m_wsp_dirty&&
(this.m_position.x=this.m_worldMatrix.m03,this.m_position.y=this.m_worldMatrix.m13,this.m_position.z=this.m_worldMatrix.m23,this.m_wsp_dirty=!1)},UpdateLMRS:function(){var a=this.m_localScale.x,b=this.m_localScale.y,c=this.m_localScale.z,d=x.FromQuaternion(this.m_localRotation,g.data.get_m4()),f=this.m_localMatrix;f.m00=d.m00*a;f.m01=d.m01*b;f.m02=d.m02*c;f.m10=d.m10*a;f.m11=d.m11*b;f.m12=d.m12*c;f.m20=d.m20*a;f.m21=d.m21*b;f.m22=d.m22*c},UpdateWSRS:function(){if(this.m_wsrs_dirty){var a=this.m_worldMatrix,
b=g.data.get_v3().Set(a.m00,a.m10,a.m20),c=g.data.get_v3().Set(a.m01,a.m11,a.m21),a=g.data.get_v3().Set(a.m02,a.m12,a.m22),d=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z),f=Math.sqrt(c.x*c.x+c.y*c.y+c.z*c.z),m=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);this.m_scale.x=d;this.m_scale.y=f;this.m_scale.z=m;f=0>=f?0:1/f;m=0>=m?0:1/m;b.Scale(0>=d?0:1/d);c.Scale(f);a.Scale(m);b=g.data.get_m4().Set(b.x,c.x,a.x,0,b.y,c.y,a.y,0,b.z,c.z,a.z,0,0,0,0,1);F.FromMatrix4(b,this.m_rotation);this.m_wsrs_dirty=!1}},UpdateWorldMatrix:function(){var a=
this.m_dirty;this.m_lmt_dirty&&(this.UpdateLMT(),this.m_lmt_dirty=!1,a=!0);this.m_lmrs_dirty&&(this.UpdateLMRS(),this.m_lmrs_dirty=!1,a=!0);null!=this.m_parent&&(this.m_dirty&&this.m_parent.UpdateWorldMatrix(),this.m_dirty=!1,a&&Ea.TransformConcat(this))},Invalidate:function(){if(!this.m_locked&&!this.m_dirty){this.m_dirty=this.m_uniform_dirty=!0;g.transform.OnChange(this);for(var a=0,b=this.m_hierarchy.length;a<b;){var c=a++;this.m_hierarchy[c].Invalidate()}}},LookAt:function(a,b,c){null==c&&(c=
0);var d=this.m_entity.m_transform.get_position(),f=g.data.get_q();a=F.LookAt(d,a,b,g.data.get_q());f=0<c?F.Lerp(f,a,c*q.m_delta,g.data.get_q()):a;this.m_entity.m_transform.set_rotation(f)},GetChild:function(a){return this.m_hierarchy[a]},GetChildByName:function(a){for(var b=0,c=this.m_hierarchy.length;b<c;){var d=b++;if(this.m_hierarchy[d].get_name()==a)return this.m_hierarchy[d]}return null},Lock:function(){this.m_locked=!0;for(var a=0,b=this.m_hierarchy.length;a<b;){var c=a++;this.m_hierarchy[c].Lock()}},
Unlock:function(a){null==a&&(a=!0);this.m_locked=!1;for(var b=0,c=this.m_hierarchy.length;b<c;){var d=b++;this.m_hierarchy[d].Unlock(a)}a&&this.Invalidate()},Navigate:function(a){a=a.split(".");for(var b=this;0<a.length;){var c=a.shift(),b=b.GetChildByName(c);if(null==b)return null}return b},Search:function(a,b){null==b&&(b=!0);var c=this,d=null;this.Traverse(function(f,m){if(f==c||null!=d)return!0;b?f.get_name()==a&&(d=f):0<=f.get_name().indexOf(a)&&(d=f);return!0});return d},GetPathToRoot:function(){for(var a=
this.m_parent,b=[];null!=a;)b.push(a),a=a.m_parent;b.reverse();return b},OutputHierarchy:function(a,b){null==b&&(b=!1);null==a&&(a=!0);var c="";this.Traverse(function(d,f){for(var m="",e=Math.max(0,f-0),g=0;g<e;)g++,m+=" ";c+=m+d.get_name()+" ";a&&(c+=d.get_position().ToString()+d.get_rotation().ToString()+d.get_scale().ToString());b&&(c+=d.get_WorldMatrix().ToString(!0,3));c+="\n";return!0});return c},Traverse:function(a){this.TraverseStep(this,0,a)},TraverseStep:function(a,b,c){if(c(a,b))for(var d=
0,f=a.m_hierarchy.length;d<f;){var m=d++;this.TraverseStep(a.GetChild(m),b+1,c)}},OnDestroy:function(){g.transform.tid.set_id(this.__cid)},ToString:function(a,b){null==b&&(b=2);null==a&&(a=!1);var c;c=a?this.get_localPosition():this.get_position();var d;d=a?this.get_localEuler():this.get_euler();var f;f=a?this.get_localScale():this.get_scale();return this.get_name()+" "+c.ToString(b)+""+d.ToString(b)+""+f.ToString(b)},__class__:Ea,__properties__:s(Ra.prototype.__properties__,{get_WorldMatrixInverse:"get_WorldMatrixInverse",
get_WorldMatrix:"get_WorldMatrix",get_scale:"get_scale",set_euler:"set_euler",get_euler:"get_euler",set_rotation:"set_rotation",get_rotation:"get_rotation",set_position:"set_position",get_position:"get_position",set_localScale:"set_localScale",get_localScale:"get_localScale",set_localEuler:"set_localEuler",get_localEuler:"get_localEuler",set_localRotation:"set_localRotation",get_localRotation:"get_localRotation",set_localPosition:"set_localPosition",get_localPosition:"get_localPosition",get_childCount:"get_childCount",
set_parent:"set_parent",get_parent:"get_parent",get_forward:"get_forward",get_up:"get_up",get_right:"get_right"})});var sa=function(){v.call(this,void 0);sa.m_list.push(this);this.clips=[];this.m_time=0;this.reverse=!1;this.m_clock=q.m_elapsed;this.m_fade_duration=this.m_fade_elapsed=0};k["haxor.component.animation.Animation"]=sa;sa.__name__=["haxor","component","animation","Animation"];sa.Update=function(){if(0<sa.m_list.length)for(var a=w["int"](Math.max(sa.m_list.length/2,1)),b=0;b<a;)b++,sa.m_list[sa.m_iterator].Animate(),
sa.m_iterator=(sa.m_iterator+1)%sa.m_list.length};sa.Initialize=function(){sa.m_list=[];sa.m_iterator=0};sa.__super__=M;sa.prototype=s(M.prototype,{get_time:function(){return this.m_time},set_time:function(a){this.m_time=a;for(var b=0,c=this.clips.length;b<c;){var d=b++;this.clips[d].Sample(this.m_time)}return a},get_playing:function(){for(var a=0,b=this.clips.length;a<b;){var c=a++;if(this.clips[c].playing)return!0}return!1},Contains:function(a){for(var b=0,c=this.clips.length;b<c;){var d=b++;if(this.clips[d]==
a)return!0}return!1},Add:function(a){this.Contains(a)||this.clips.push(a)},Remove:function(a){this.Contains(a)&&E.remove(this.clips,a)},Get:function(a){for(var b=0,c=this.clips.length;b<c;){var d=b++;if(this.clips[d].get_name()==a)return this.clips[d]}return null},Fade:function(a,b,c){null==c&&(c=0);null==b&&(b=0);this.Play(a,b);this.m_fade_elapsed=0;this.m_fade_duration=c;this.m_fade_clip=a},Play:function(a,b){null==b&&(b=0);this.Contains(a)&&(this.m_time=b,a.Sample(b),a.playing=!0)},Stop:function(a){if(null==
a){a=0;for(var b=this.clips.length;a<b;){var c=a++;this.clips[c].playing=!1}}else this.Contains(a)&&(a.playing=!1)},Animate:function(){var a=!1;this.m_fade_elapsed>=this.m_fade_duration&&(this.m_fade_elapsed=this.m_fade_duration);var b;b=0>=this.m_fade_duration?1:this.m_fade_elapsed/this.m_fade_duration;this.m_entity.m_transform.Lock();for(var c=1,d=0,f=this.clips.length;d<f;){var m=d++,m=this.clips[m];m.playing&&(m.Sample(this.get_time(),b),c=m.speed,a=!0)}1<=b&&(this.m_fade_clip=null,this.m_fade_duration=
this.m_fade_elapsed=0);b=q.m_elapsed-this.m_clock;this.m_clock=q.m_elapsed;a&&(this.m_time+=(this.reverse?-b:b)*c,this.m_fade_elapsed+=b);this.m_entity.m_transform.Unlock()},__class__:sa,__properties__:s(M.prototype.__properties__,{get_playing:"get_playing",set_time:"set_time",get_time:"get_time"})});var Zb=function(){v.call(this);this.tracks=[];this.speed=1;this.playing=!1;this.m_length=0;this.wrap=ra.Clamp;this.m_events=[];this.m_last_frame=0};k["haxor.component.animation.AnimationClip"]=Zb;Zb.__name__=
["haxor","component","animation","AnimationClip"];Zb.__super__=v;Zb.prototype=s(v.prototype,{get_length:function(){return this.m_length},AddEvent:function(a,b,c,d){null==c&&(c=0);a=new Wc(a,b,c,d);this.m_events.push(a);this.m_events.sort(function(a,b){return a.frame<b.frame?-1:1})},RemoveEvent:function(a){null==a&&(a=-1);for(var b=0;b<this.m_events.length;){if(this.m_events[b].frame==a||0>a){var c=this.m_events[b--];E.remove(this.m_events,c)}b++}},Add:function(a,b){var c=new vc;c.target=a;c.property=
b;this.tracks.push(c);this.UpdateLength();return c},Remove:function(a,b){null==b&&(b="");for(var c=0,d=this.tracks.length;c<d;){var f=c++;this.tracks[f].target==a&&(""==b?E.remove(this.tracks,this.tracks[f]):b==b&&E.remove(this.tracks,this.tracks[f]))}this.UpdateLength()},Sample:function(a,b){null==b&&(b=1);if(this.playing){Math.max(0,this.speed);var c=a;switch(this.wrap[1]){case 0:c=l.Min(Math.max(c,0),this.get_length());break;case 1:c=l.Loop(c,0,this.get_length());break;case 2:c=l.Oscilate(c,0,
this.get_length())}for(var d=-1,f=0,m=this.tracks.length;f<m;)d=f++,d=this.tracks[d].Sample(c,b);if(0<=d&&(c=0,this.m_last_frame!=d)){for(;c<this.m_events.length;)f=this.m_events[c],m=f.frame,m>=this.m_last_frame&&m<=d&&!f.Dispatch()&&(E.remove(this.m_events,f),c--),c++;this.m_last_frame=d}}},Split:function(a,b){var c=new Zb;c.speed=this.speed;c.wrap=this.wrap;c.playing=this.playing;for(var d=0,f=this.tracks.length;d<f;){var m=d++,m=this.tracks[m].Split(a,b);c.tracks.push(m)}c.UpdateLength();return c},
UpdateLength:function(){for(var a=this.m_length=0,b=this.tracks.length;a<b;){var c=a++;this.m_length=Math.max(this.tracks[c].get_length(),this.m_length)}},__class__:Zb,__properties__:s(v.prototype.__properties__,{get_length:"get_length"})});var Wc=function(a,b,c,d){null==c&&(c=0);this.frame=a;this.listener=b;this.args=null==d?[]:d;this.repeat=c};k["haxor.component.animation.AnimationEvent"]=Wc;Wc.__name__=["haxor","component","animation","AnimationEvent"];Wc.prototype={Dispatch:function(){if(null!=
this.listener){this.listener(this);if(0>=this.repeat)return!0;this.repeat--;return 0>=this.repeat?!1:!0}return!1},__class__:Wc};var vc=function(){this.target=null;this.keyframes=[];this.property="";this.m_length=this.m_head=0};k["haxor.component.animation.ClipTrack"]=vc;vc.__name__=["haxor","component","animation","ClipTrack"];vc.prototype={get_length:function(){return this.m_length},Add:function(a,b){var c=null;if("number"==typeof b){var d=c=new Ab;d.time=a;d.value=b}else J.__instanceof(b,n)?(d=
c=new Bb,d.time=a,d.value=b):J.__instanceof(b,F)&&(d=c=new Cb,d.time=a,d.value=b);null!=c&&(this.keyframes.push(c),this.m_length=Math.max(c.time,this.m_length));return c},Sample:function(a,b){null==b&&(b=1);if(0>=this.keyframes.length)return 0;if(1>=this.keyframes.length)return Qa.setProperty(this.target,this.property,this.keyframes[0].Sample()),0;for(var c=this.keyframes.length/2|0,d=this.keyframes.length/2|0,f=-1,m=0,e=this.keyframes.length;m<e;){m++;var f=l.ClampInt(c,0,this.keyframes.length-1),
g=l.ClampInt(c+1,0,this.keyframes.length-1),h=this.keyframes[f],g=this.keyframes[g];if(a<h.time)d/=2,c-=d;else if(a>g.time)d/=2,c+=d;else{c=g.time-h.time;c=0>=c?0:(a-h.time)/c;0>=c?c=0:1<=c&&(c=1);h=h.Blend(g,c);h.changed&&(g=Qa.getProperty(this.target,this.property),Qa.setProperty(this.target,this.property,h.Sample(g,b)));break}}return f},Split:function(a,b){var c=new vc;c.target=this.target;c.property=this.property;var d=Math.min(a,this.keyframes.length-1),f=Math.min(b,this.keyframes.length-1),
m=this.keyframes[d];if(null==m)return c;for(var e=m.time;d<f;)m=d++,m=this.keyframes[m],null!=m&&c.Add(m.time-e,m.Sample());return c},Clear:function(){this.keyframes=[];this.m_length=0},__class__:vc,__properties__:{get_length:"get_length"}};var cb=function(){this.time=0;this.changed=!1};k["haxor.component.animation.KeyFrame"]=cb;cb.__name__=["haxor","component","animation","KeyFrame"];cb.prototype={Blend:function(a,b){return null},Sample:function(a,b){return null},__class__:cb};var Ab=function(){cb.call(this);
this.value=0};k["haxor.component.animation.FloatKeyFrame"]=Ab;Ab.__name__=["haxor","component","animation","FloatKeyFrame"];Ab.__super__=cb;Ab.prototype=s(cb.prototype,{Blend:function(a,b){this.changed=!1;if(1E-4>Math.abs(this.value-a.value))return this;var c=Ab.m_temp;c.value=l.Lerp(this.value,a.value,b);c.changed=!0;return c},Sample:function(a,b){null==b&&(b=1);return null==a?this.value:l.Lerp(a,this.value,b)},__class__:Ab});var n=function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=
a;this.y=b;this.z=c};k["haxor.math.Vector3"]=n;n.__name__=["haxor","math","Vector3"];n.__properties__={get_forward:"get_forward",get_up:"get_up",get_right:"get_right",get_one:"get_one",get_zero:"get_zero",get_temp:"get_temp"};n.get_temp=function(){return g.data.get_v3()};n.get_zero=function(){return new n(0,0,0)};n.get_one=function(){return new n(1,1,1)};n.get_right=function(){return new n(1,0,0)};n.get_up=function(){return new n(0,1,0)};n.get_forward=function(){return new n(0,0,1)};n.Dot=function(a,
b){return a.x*b.x+a.y*b.y+a.z*b.z};n.Distance=function(a,b){var c=a.x-b.x,d=a.y-b.y,f=a.z-b.z;return Math.sqrt(c*c+d*d+f*f)};n.Cross=function(a,b,c){null==c&&(c=new n);return c.Set(a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x)};n.Project=function(a,b,c,d){null==d&&(d=new n);c=g.data.get_v3().Set3(c).Normalize();a=g.data.get_v3().Set3(a).Sub(b);c=c.x*a.x+c.y*a.y+c.z*a.z;d.x=b.x+a.x*c;d.y=b.y+a.y*c;d.z=b.z+a.z*c;return d};n.Lerp=function(a,b,c,d){null==d&&(d=new n);return d.Set(a.x+(b.x-a.x)*c,a.y+
(b.y-a.y)*c,a.z+(b.z-a.z)*c)};n.Min=function(a,b,c){null==c&&(c=new n);c.x=Math.min(a.x,b.x);c.y=Math.min(a.y,b.y);c.z=Math.min(a.z,b.z);return c};n.Max=function(a,b,c){null==c&&(c=new n);c.x=Math.max(a.x,b.x);c.y=Math.max(a.y,b.y);c.z=Math.max(a.z,b.z);return c};n.Parse=function(a,b){null==b&&(b=" ");var c=a.split(b);return(new n(0,0,0)).Set(w.parseFloat(B.trim(c[0])),w.parseFloat(B.trim(c[1])),w.parseFloat(B.trim(c[2])))};n.prototype={get_clone:function(){return new n(this.x,this.y,this.z)},get_color:function(){return new t(this.x,
this.y,this.z)},get_xzy:function(){return new n(this.x,this.z,this.y)},get_yxz:function(){return new n(this.y,this.z,this.x)},get_yzx:function(){return new n(this.y,this.z,this.x)},get_zxy:function(){return new n(this.z,this.x,this.y)},get_zyx:function(){return new n(this.z,this.y,this.x)},get_xy:function(){return new K(this.x,this.y)},get_xz:function(){return new K(this.x,this.z)},get_yx:function(){return new K(this.y,this.x)},get_yz:function(){return new K(this.y,this.z)},get_zx:function(){return new K(this.z,
this.x)},get_zy:function(){return new K(this.z,this.y)},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},get_lengthSqr:function(){return this.x*this.x+this.y*this.y+this.z*this.z},get_normalized:function(){return(new n(this.x,this.y,this.z)).Normalize()},get_inverse:function(){return(new n(this.x,this.y,this.z)).Invert()},Set:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;return this},Set2:function(a){this.x=a.x;this.y=a.y;
return this},Set3:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},Set4:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},SetColor:function(a){this.x=a.r;this.y=a.g;this.z=a.b;return this},Get:function(a){return 0==a?this.x:1==a?this.y:this.z},Add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},Add3:function(a,b,c){this.x+=a;this.y+=b;this.z+=c;return this},Sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},Multiply:function(a){this.x*=a.x;this.y*=a.y;this.z*=
a.z;return this},Step:function(a,b){var c=a.x-this.x,d=a.y-this.y,f=a.z-this.z,m=Math.sqrt(c*c+d*d+f*f);if(1E-4>=m)return!1;m=(b>m?m:b)/m;this.x+=c*m;this.y+=d*m;this.z+=f*m;return!0},Reflect:function(a){var b=2*Math.min(0,a.x*this.x+a.y*this.y+a.z*this.z);this.x+=-a.x*b;this.y+=-a.y*b;this.z+=-a.z*b;return this},Invert:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},Scale:function(a){this.x*=a;this.y*=a;this.z*=a;return this},Normalize:function(){var a=Math.sqrt(this.x*this.x+
this.y*this.y+this.z*this.z);if(0>=a)return this;this.x*=a=1/a;this.y*=a;this.z*=a;return this},ToArray:function(){return[this.x,this.y,this.z]},ToString:function(a){null==a&&(a=2);return"["+l.RoundPlaces(this.x,a)+","+l.RoundPlaces(this.y,a)+","+l.RoundPlaces(this.z,a)+"]"},__class__:n,__properties__:{get_inverse:"get_inverse",get_normalized:"get_normalized",get_lengthSqr:"get_lengthSqr",get_length:"get_length",get_zy:"get_zy",get_zx:"get_zx",get_yz:"get_yz",get_yx:"get_yx",get_xz:"get_xz",get_xy:"get_xy",
get_zyx:"get_zyx",get_zxy:"get_zxy",get_yzx:"get_yzx",get_yxz:"get_yxz",get_xzy:"get_xzy",get_color:"get_color",get_clone:"get_clone"}};var Bb=function(){cb.call(this);this.value=new n};k["haxor.component.animation.Vector3KeyFrame"]=Bb;Bb.__name__=["haxor","component","animation","Vector3KeyFrame"];Bb.__super__=cb;Bb.prototype=s(cb.prototype,{Blend:function(a,b){this.changed=!1;var c=this.value,d=a.value;if(1E-4>Math.abs(c.x-d.x)&&1E-4>Math.abs(c.y-d.y)&&1E-4>Math.abs(c.z-d.z))return this;var f=Bb.m_temp;
f.value=n.Lerp(c,d,b,f.value);f.changed=!0;return f},Sample:function(a,b){null==b&&(b=1);return null==a?this.value:n.Lerp(a,this.value,b,g.data.get_v3())},__class__:Bb});var F=function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d};k["haxor.math.Quaternion"]=F;F.__name__=["haxor","math","Quaternion"];F.__properties__={get_identity:"get_identity",get_temp:"get_temp"};F.get_temp=function(){return g.data.get_q()};F.get_identity=function(){return new F(0,
0,0,1)};F.FromEuler=function(a,b){var c;c=null==b?new F:b;var d=g.data.get_v3(),f=g.data.get_v3(),m=g.data.get_v3().Set(.008726646259971648*a.x,.008726646259971648*a.y,.008726646259971648*a.z);d.Set(Math.cos(m.x),Math.cos(m.y),Math.cos(m.z));f.Set(Math.sin(m.x),Math.sin(m.y),Math.sin(m.z));c.x=f.x*d.y*d.z-d.x*f.y*f.z;c.y=d.x*f.y*d.z+f.x*d.y*f.z;c.z=d.x*d.y*f.z-f.x*f.y*d.z;c.w=d.x*d.y*d.z+f.x*f.y*f.z;return c};F.ToEuler=function(a,b){var c;c=null==b?new n:b;var d=a.x*a.y+a.z*a.w;if(.499<d)return c.y=
114.59155902616465*Math.atan2(a.x,a.w),c.z=28.64788975654116*Math.PI,c.x=0,c;if(-.499>d)return c.y=-2*Math.atan2(a.x,a.w),c.z=28.64788975654116*-Math.PI,c.x=0,c;var f=a.x*a.x,m=a.z*a.z;c.y=57.29577951308232*Math.atan2(2*a.y*a.w-2*a.x*a.z,1-2*a.y*a.y-2*m);c.z=57.29577951308232*Math.asin(2*d);c.x=57.29577951308232*Math.atan2(2*a.x*a.w-2*a.y*a.z,1-2*f-2*m);return c};F.FromMatrix4=function(a,b){var c;c=null==b?new F:b;var d=a.m00-a.m11-a.m22,f=a.m11-a.m00-a.m22,m=a.m22-a.m00-a.m11,e=0,g=a.m00+a.m11+a.m22;
d>g&&(g=d,e=1);f>g&&(g=f,e=2);m>g&&(g=m,e=3);d=.5*Math.sqrt(g+1);f=.25/d;switch(e){case 0:c.w=d;c.x=(a.m21-a.m12)*f;c.y=(a.m02-a.m20)*f;c.z=(a.m10-a.m01)*f;break;case 1:c.w=(a.m21-a.m12)*f;c.x=d;c.y=(a.m10+a.m01)*f;c.z=(a.m02+a.m20)*f;break;case 2:c.w=(a.m02-a.m20)*f;c.x=(a.m10+a.m01)*f;c.y=d;c.z=(a.m21+a.m12)*f;break;case 3:c.w=(a.m10-a.m01)*f,c.x=(a.m02+a.m20)*f,c.y=(a.m21+a.m12)*f,c.z=d}return c};F.Dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w};F.DeltaRotation=function(a,b,c){c=null==
c?new F:c;F.Inverse(a,c);c.Multiply(b);return c};F.Inverse=function(a,b){var c=a.x*a.x+a.y*a.y+a.z*a.z+a.w*a.w,c=0>=c?0:1/c;return(null==b?new F:b).Set(-a.x*c,-a.y*c,-a.z*c,a.w*c)};F.Lerp=function(a,b,c,d){d=null==d?new F:d;var f=new F(a.x,a.y,a.z,a.w);0>a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w&&(f.w=-f.w,f.x=-f.x,f.y=-f.y,f.z=-f.z);d.x=f.x+(b.x-f.x)*c;d.y=f.y+(b.y-f.y)*c;d.z=f.z+(b.z-f.z)*c;d.w=f.w+(b.w-f.w)*c;d.Normalize();return d};F.Slerp=function(a,b,c){var d=new F,f=g.data.get_q().SetQuaternion(b);b=
a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w;0>b&&(f.Invert(),b=-b);if(.9999<b)d.Set(l.Lerp(a.x,f.x,c),l.Lerp(a.y,f.y,c),l.Lerp(a.z,f.z,c),l.Lerp(a.w,f.w,c));else{var m=Math.acos(b);b=1/Math.sin(m);var e=Math.sin((1-c)*m);c=Math.sin(c*m);d.x=(e*a.x+c*f.x)*b;d.y=(e*a.y+c*f.y)*b;d.z=(e*a.z+c*f.z)*b;d.w=(e*a.w+c*f.w)*b}return d};F.FromAxisAngle=function(a,b){b*=.008726646259971648;var c=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);1E-4<l.Abs(c-1)&&a.Normalize();c=Math.sin(b);return new F(a.x*c,a.y*c,a.z*c,Math.cos(b))};F.LookAt=
function(a,b,c,d){return F.FromMatrix4(x.LookAt(a,b,c,g.data.get_m4()),d)};F.LookRotation=function(a,b){return x.LookRotation(a,b,g.data.get_m4()).get_quaternion()};F.Parse=function(a,b){null==b&&(b=" ");var c=a.split(b);return(new F(0,0,0,1)).Set(w.parseFloat(B.trim(c[0])),w.parseFloat(B.trim(c[1])),w.parseFloat(B.trim(c[2])),w.parseFloat(B.trim(c[3])))};F.prototype={get_matrix:function(){return x.FromQuaternion(this)},set_matrix:function(a){F.FromMatrix4(a,this);return a},get_euler:function(){return F.ToEuler(this)},
set_euler:function(a){F.FromEuler(a,this);return a},get_clone:function(){return new F(this.x,this.y,this.z,this.w)},get_xyzw:function(){return new Q(this.x,this.y,this.z,this.w)},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},get_normalized:function(){return(new F(this.x,this.y,this.z,this.w)).Normalize()},Set:function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d;return this},SetQuaternion:function(a){this.x=
a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},Normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0>=a)return this.x=this.y=this.z=0,this.w=1,this;this.x*=a=1/a;this.y*=a;this.z*=a;this.w*=a;return this},get_conjugate:function(){return new F(-this.x,-this.y,-this.z,this.w)},get_inverse:function(){return F.Inverse(this)},Invert:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},Scale:function(a){this.x*=a;this.y*=a;this.z*=
a;this.w*=a;return this},Multiply:function(a,b){null==b&&(b=!1);var c=this.w*a.y+this.y*a.w+this.z*a.x-this.x*a.z,d=this.w*a.z+this.z*a.w+this.x*a.y-this.y*a.x,f=this.w*a.w-this.x*a.x-this.y*a.y-this.z*a.z;this.x=this.w*a.x+this.x*a.w+this.y*a.z-this.z*a.y;this.y=c;this.z=d;this.w=f;return b?this.Normalize():this},Transform:function(a){var b=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z),c;c=0>=b?0:1/b;a.x*=c;a.y*=c;a.z*=c;c=g.data.get_q().Set(a.x,a.y,a.z,0);var d=g.data.get_q().SetQuaternion(this),f=g.data.get_q().Set(-this.x,
-this.y,-this.z,this.w);d.Multiply(c.Multiply(f));a.x=d.x*b;a.y=d.y*b;a.z=d.z*b;return a},Delta:function(a){return this.SetQuaternion(F.DeltaRotation(this,a,g.data.get_q()))},SetAxisAngle:function(a,b){b*=.008726646259971648;var c=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);1E-4<l.Abs(c-1)&&a.Normalize();c=Math.sin(b);return this.Set(a.x*c,a.y*c,a.z*c,Math.cos(b))},ToArray:function(){return[this.x,this.y,this.z,this.w]},ToString:function(a){null==a&&(a=2);return"["+l.RoundPlaces(this.x,a)+","+l.RoundPlaces(this.y,
a)+","+l.RoundPlaces(this.z,a)+","+l.RoundPlaces(this.w,a)+"]"},__class__:F,__properties__:{get_inverse:"get_inverse",get_conjugate:"get_conjugate",get_normalized:"get_normalized",get_length:"get_length",get_xyzw:"get_xyzw",get_clone:"get_clone",set_euler:"set_euler",get_euler:"get_euler",set_matrix:"set_matrix",get_matrix:"get_matrix"}};var Cb=function(){cb.call(this);this.value=new F(0,0,0,1)};k["haxor.component.animation.QuaternionKeyFrame"]=Cb;Cb.__name__=["haxor","component","animation","QuaternionKeyFrame"];
Cb.__super__=cb;Cb.prototype=s(cb.prototype,{Blend:function(a,b){this.changed=!0;var c=this.value,d=a.value;if(1E-4>Math.abs(c.x-d.x)&&1E-4>Math.abs(c.y-d.y)&&1E-4>Math.abs(c.z-d.z)&&1E-4>Math.abs(c.w-d.w))return this;var f=Cb.m_temp;f.value=F.Lerp(c,d,b,f.value);f.changed=!0;return f},Sample:function(a,b){null==b&&(b=1);return null==a?this.value:F.Lerp(a,this.value,b,g.data.get_q())},__class__:Cb});var t=function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.r=a;this.g=
b;this.b=c;this.a=d};k["haxor.math.Color"]=t;t.__name__=["haxor","math","Color"];t.__properties__={get_blue30:"get_blue30",get_green30:"get_green30",get_red30:"get_red30",get_magenta50:"get_magenta50",get_yellow50:"get_yellow50",get_blue50:"get_blue50",get_green50:"get_green50",get_red50:"get_red50",get_gray90:"get_gray90",get_gray75:"get_gray75",get_gray50:"get_gray50",get_gray25:"get_gray25",get_gray10:"get_gray10",get_empty:"get_empty",get_white:"get_white",get_black:"get_black",get_magenta:"get_magenta",
get_blue:"get_blue",get_cyan:"get_cyan",get_green:"get_green",get_yellow:"get_yellow",get_red:"get_red",get_temp:"get_temp"};t.get_temp=function(){return g.data.get_c()};t.get_red=function(){return new t(1,0,0,1)};t.get_yellow=function(){return new t(1,1,0,1)};t.get_green=function(){return new t(0,1,0,1)};t.get_cyan=function(){return new t(0,1,1,1)};t.get_blue=function(){return new t(0,0,1,1)};t.get_magenta=function(){return new t(1,0,1,1)};t.get_black=function(){return new t(0,0,0,1)};t.get_white=
function(){return new t(1,1,1,1)};t.get_empty=function(){return new t(0,0,0,0)};t.get_gray10=function(){return new t(.1,.1,.1,1)};t.get_gray25=function(){return new t(.25,.25,.25,1)};t.get_gray50=function(){return new t(.5,.5,.5,1)};t.get_gray75=function(){return new t(.75,.75,.75,1)};t.get_gray90=function(){return new t(.9,.9,.9,1)};t.get_red50=function(){return new t(.9,.5,.5,1)};t.get_green50=function(){return new t(.5,.9,.5,1)};t.get_blue50=function(){return new t(.5,.5,.9,1)};t.get_yellow50=
function(){return new t(.9,.9,.5,1)};t.get_magenta50=function(){return new t(.9,.5,.9,1)};t.get_red30=function(){return new t(.9,.3,.3,1)};t.get_green30=function(){return new t(.3,.9,.3,1)};t.get_blue30=function(){return new t(.3,.3,.9,1)};t.FromHex=function(a){var b=new t;10==a.length?b.set_argb(w.parseInt(a)):b.set_rgb(w.parseInt(a));return b};t.FromBytes=function(a,b,c,d){null==d&&(d=255);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);return new t(.00392156863*a,.00392156863*b,.00392156863*c,.00392156863*
d)};t.Lerp=function(a,b,c){return new t(l.Lerp(a.r,b.r,c),l.Lerp(a.g,b.g,c),l.Lerp(a.b,b.b,c),l.Lerp(a.a,b.a,c))};t.Sample=function(a,b){var c=a.length-1,c=.9999*c*b,d=c|0,f=(d+1)%a.length;b=c-Math.floor(c);return t.Lerp(a[d],a[f],b)};t.Parse=function(a,b){null==b&&(b=" ");var c=a.split(b);return(new t(0,0,0,1)).Set(w.parseFloat(B.trim(c[0])),w.parseFloat(B.trim(c[1])),w.parseFloat(B.trim(c[2])),w.parseFloat(B.trim(c[3])))};t.prototype={get_clone:function(){return new t(this.r,this.g,this.b,this.a)},
get_xyz:function(){return new n(this.r,this.g,this.b)},get_xyzw:function(){return new Q(this.r,this.g,this.b,this.a)},get_argb:function(){return 255*this.a<<24|255*this.r<<16|255*this.g<<8|255*this.b},set_argb:function(a){this.a=.00392156863*(a>>24&255);this.r=.00392156863*(a>>16&255);this.g=.00392156863*(a>>8&255);this.b=.00392156863*(a&255);return a},get_css:function(){return"rgba("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+","+this.a+")"},get_rgba:function(){return 255*this.r<<24|255*
this.g<<16|255*this.b<<8|255*this.a},set_rgba:function(a){this.r=.00392156863*(a>>24&255);this.g=.00392156863*(a>>16&255);this.b=.00392156863*(a>>8&255);this.a=.00392156863*(a&255);return a},get_rgb:function(){return 255*this.r<<16|255*this.g<<8|255*this.b},set_rgb:function(a){this.r=.00392156863*(a>>16&255);this.g=.00392156863*(a>>8&255);this.b=.00392156863*(a&255);return a},get_luminance:function(){return.3*this.r+.59*this.g+.11*this.b},get_negative:function(){return new t(1-this.r,1-this.g,1-this.b,
1-this.a)},Set:function(a,b,c,d){null==d&&(d=1);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.r=a;this.g=b;this.b=c;this.a=d;return this},Set3:function(a){this.r=a.x;this.g=a.y;this.b=a.z;return this},Set4:function(a){this.r=a.x;this.g=a.y;this.b=a.z;this.a=a.w;return this},SetColor:function(a){this.r=a.r;this.g=a.g;this.b=a.b;this.a=a.a;return this},SetRGB:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},SetAlpha:function(a){this.a=a.a;return this},Get:function(a){return 0==a?this.r:
1==a?this.g:2==a?this.b:this.a},Add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;this.a+=a.a;return this},Sub:function(a){this.r-=a.r;this.g-=a.g;this.b-=a.b;this.a-=a.a;return this},Multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;this.a*=a.a;return this},MultiplyRGB:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},Scale:function(a){this.r*=a;this.g*=a;this.b*=a;this.a*=a;return this},ScaleRGB:function(a){this.r*=a;this.g*=a;this.b*=a;return this},ToArray:function(){return[this.r,
this.g,this.b,this.a]},ToString:function(a){null==a&&(a=2);return"["+l.RoundPlaces(this.r,a)+","+l.RoundPlaces(this.g,a)+","+l.RoundPlaces(this.b,a)+","+l.RoundPlaces(this.a,a)+"]"},__class__:t,__properties__:{get_negative:"get_negative",get_luminance:"get_luminance",set_rgb:"set_rgb",get_rgb:"get_rgb",set_rgba:"set_rgba",get_rgba:"get_rgba",get_css:"get_css",set_argb:"set_argb",get_argb:"get_argb",get_xyzw:"get_xyzw",get_xyz:"get_xyz",get_clone:"get_clone"}};var P=function(){null==P.m_list&&(P.m_list=
[]);if(0>=P.m_buffer.length)for(var a=0,b=12*P.max;a<b;)a++,P.m_buffer.push(0);P.m_list.push(this);v.call(this,void 0)};k["haxor.component.light.Light"]=P;P.__name__=["haxor","component","light","Light"];P.__properties__={get_list:"get_list"};P.get_list=function(){return P.m_list.slice()};P.SetLightData=function(a,b,c,d,f,m,e,g,h,k,l,n){a*=12;P.m_buffer[a]=b;P.m_buffer[a+1]=c;P.m_buffer[a+2]=d;P.m_buffer[a+3]=f;P.m_buffer[a+4]=m;P.m_buffer[a+5]=e;P.m_buffer[a+6]=g;P.m_buffer[a+8]=h;P.m_buffer[a+9]=
k;P.m_buffer[a+10]=l;P.m_buffer[a+11]=n};P.__super__=M;P.prototype=s(M.prototype,{OnBuild:function(){M.prototype.OnBuild.call(this);this.color=new t(1,1,1,1);this.intensity=1},OnDestroy:function(){M.prototype.OnDestroy.call(this);E.remove(P.m_list,this)},__class__:P});var sb=function(){P.call(this);this.radius=this.atten=1};k["haxor.component.light.PointLight"]=sb;sb.__name__=["haxor","component","light","PointLight"];sb.Create=function(a,b,c,d){var f=new wa;f.set_name("PointLight");f=f.AddComponent(sb);
f.color=a;f.intensity=b;f.atten=c;f.radius=d;return f};sb.__super__=P;sb.prototype=s(P.prototype,{__class__:sb});var Ya=function(a){v.call(this,a)};k["haxor.component.physics.Collider"]=Ya;Ya.__name__=["haxor","component","physics","Collider"];Ya.__super__=M;Ya.prototype=s(M.prototype,{get_type:function(){return this.m_type},set_enabled:function(a){M.prototype.set_enabled.call(this,a);g.physics.OnColliderUpdate(this,!1);return a},get_sphere:function(){this.m_sphere_dirty&&(this.GenerateSphere(),this.m_sphere_dirty=
!1);return this.m_sphere.get_clone()},get_aabb:function(){this.m_aabb_dirty&&(this.GenerateAABB(),this.m_aabb_dirty=!1);return this.m_aabb.get_clone()},OnBuild:function(){M.prototype.OnBuild.call(this);g.physics.CreateCollider(this);this.trigger=!1;this.m_aabb=ba.get_empty();this.m_sphere=new Q(0,0,0,0);this.m_sphere_dirty=this.m_aabb_dirty=!1},OnTransformUpdate:function(a){M.prototype.OnTransformUpdate.call(this,a);this.Refresh();g.physics.OnColliderUpdate(this,a)},GenerateSphere:function(){},GenerateAABB:function(){},
Refresh:function(){this.m_sphere_dirty=this.m_aabb_dirty=!0},__class__:Ya,__properties__:s(M.prototype.__properties__,{get_aabb:"get_aabb",get_sphere:"get_sphere",get_type:"get_type"})});var yb=function(a){v.call(this,a)};k["haxor.component.physics.BoxCollider"]=yb;yb.__name__=["haxor","component","physics","BoxCollider"];yb.__super__=Ya;yb.prototype=s(Ya.prototype,{get_center:function(){return g.data.get_v3().Set(this.m_center.x,this.m_center.y,this.m_center.z)},set_center:function(a){this.m_center.Set(a.x,
a.y,a.z);this.Refresh();return a},get_size:function(){return g.data.get_v3().Set(this.m_size.x,this.m_size.y,this.m_size.z)},set_size:function(a){this.m_size.Set(a.x,a.y,a.z);this.Refresh();return a},OnBuild:function(){this.m_type=Y.Box;Ya.prototype.OnBuild.call(this);this.m_center=new n(0,0,0);this.m_size=new n(1,1,1)},GenerateSphere:function(){var a=this.m_sphere,b=this.m_entity.m_transform.get_WorldMatrix(),c=g.data.get_v3().Set(this.m_center.x,this.m_center.y,this.m_center.z);b.Transform3x4(c);
a.x=c.x;a.y=c.y;a.z=c.z;b=x.GetScale(b,g.data.get_m4().SetIdentity());a.w=l.Max(b.m00,Math.max(b.m11,b.m22))*this.m_size.get_length()},GenerateAABB:function(){var a=this.m_aabb,b=this.m_entity.m_transform.get_WorldMatrix(),c=g.data.get_v3().Set(this.m_center.x,this.m_center.y,this.m_center.z),d=.5*this.m_size.x,f=.5*this.m_size.y,m=.5*this.m_size.z,d=g.data.get_v3().Set(d*b.m00,d*b.m10,d*b.m20),f=g.data.get_v3().Set(f*b.m01,f*b.m11,f*b.m21),m=g.data.get_v3().Set(m*b.m02,m*b.m12,m*b.m22);b.Transform3x4(c);
a.set_xMin(a.set_xMax(c.x));a.set_yMin(a.set_yMax(c.y));a.set_zMin(a.set_zMax(c.z));a.Encapsulate3(c.x+d.x+f.x+m.x,c.y+d.y+f.y+m.y,c.z+d.z+f.z+m.z);a.Encapsulate3(c.x-d.x+f.x+m.x,c.y-d.y+f.y+m.y,c.z-d.z+f.z+m.z);a.Encapsulate3(c.x+d.x-f.x+m.x,c.y+d.y-f.y+m.y,c.z+d.z-f.z+m.z);a.Encapsulate3(c.x-d.x-f.x+m.x,c.y-d.y-f.y+m.y,c.z-d.z-f.z+m.z);a.Encapsulate3(c.x+d.x+f.x-m.x,c.y+d.y+f.y-m.y,c.z+d.z+f.z-m.z);a.Encapsulate3(c.x-d.x+f.x-m.x,c.y-d.y+f.y-m.y,c.z-d.z+f.z-m.z);a.Encapsulate3(c.x+d.x-f.x-m.x,c.y+
d.y-f.y-m.y,c.z+d.z-f.z-m.z);a.Encapsulate3(c.x-d.x-f.x-m.x,c.y-d.y-f.y-m.y,c.z-d.z-f.z-m.z)},__class__:yb,__properties__:s(Ya.prototype.__properties__,{set_size:"set_size",get_size:"get_size",set_center:"set_center",get_center:"get_center"})});var Kb=function(a){v.call(this,a)};k["haxor.component.physics.RigidBody"]=Kb;Kb.__name__=["haxor","component","physics","RigidBody"];Kb.__super__=M;Kb.prototype=s(M.prototype,{get_velocity:function(){return g.data.get_v3().Set(this.m_velocity.x,this.m_velocity.y,
this.m_velocity.z)},set_velocity:function(a){this.m_speed=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);var b;b=0>=this.m_speed?0:1/this.m_speed;this.m_velocity.Set3(a);this.m_direction.Set3(a).Scale(b);return a},get_angularVelocity:function(){return g.data.get_v3().Set(this.m_angularVelocity.x,this.m_angularVelocity.y,this.m_angularVelocity.z)},set_angularVelocity:function(a){this.m_angularSpeed=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);var b;b=0>=this.m_angularSpeed?0:1/this.m_angularSpeed;this.m_angularVelocity.Set3(a);
this.m_angularDirection.Set3(a).Scale(b);return a},get_drag:function(){return this.m_drag},set_drag:function(a){return this.m_drag=Math.max(0,a)},get_angularDrag:function(){return this.m_angularDrag},set_angularDrag:function(a){return this.m_angularDrag=Math.max(0,a)},get_mass:function(){return this.m_mass},set_mass:function(a){this.m_mass=Math.max(0,a);this.m_imass=0>=this.m_mass?0:1/this.m_mass;return this.m_mass},OnBuild:function(){this.m_velocity=new n(0,0,0);this.m_dragForce=new n(0,0,0);this.m_direction=
new n(0,0,0);this.m_speed=0;this.m_avq=new F;this.m_angularVelocity=new n(0,0,0);this.m_dragTorque=new n(0,0,0);this.m_angularDirection=new n(0,0,0);this.m_angularSpeed=0;this.m_accel=new n(0,0,0);this.m_torque=new n(0,0,0);this.kinematic=this.m_hasTorque=this.m_hasForce=!1;this.set_mass(1);this.set_drag(0);this.set_angularDrag(0);this.gravity=!0;this.centerOfMass=new n(0,0,0);g.physics.CreateRigidBody(this)},AddTorque:function(a,b){var c;c=null==b?na.Force:b;var d=1,f;f=b==na.Velocity?this.get_angularVelocity():
this.m_torque;switch(c[1]){case 1:d=this.m_imass;break;case 2:d=this.m_imass}f.x+=a.x*d;f.y+=a.y*d;f.z+=a.z*d;this.m_hasTorque=b!=na.Velocity},AddForce:function(a,b){var c;c=null==b?na.Force:b;var d=1,f=q.get_fixedDelta(),m;m=b==na.Velocity?this.get_velocity():this.m_accel;switch(c[1]){case 3:d=f;break;case 1:d=this.m_imass*f*f;break;case 0:d=f*f;break;case 2:d=this.m_imass*f}m.x+=a.x*d;m.y+=a.y*d;m.z+=a.z*d;b==na.Velocity&&this.set_velocity(m);this.m_hasForce=b!=na.Velocity},OnDestroy:function(){},
ComputeForces:function(){this.gravity&&this.AddForce(S.gravity,na.Velocity);0<this.get_drag()&&0<this.m_speed&&(this.m_dragForce.x=-this.m_velocity.x*this.get_drag(),this.m_dragForce.y=-this.m_velocity.y*this.get_drag(),this.m_dragForce.z=-this.m_velocity.z*this.get_drag(),1E-4<=l.Abs(this.m_dragForce.x)&&(this.m_accel.x+=this.m_dragForce.x,this.m_hasForce=!0),1E-4<=l.Abs(this.m_dragForce.y)&&(this.m_accel.y+=this.m_dragForce.y,this.m_hasForce=!0),1E-4<=l.Abs(this.m_dragForce.z)&&(this.m_accel.z+=
this.m_dragForce.z,this.m_hasForce=!0));0<this.get_angularDrag()&&0<this.m_angularSpeed&&(this.m_dragTorque.x=-this.m_angularVelocity.x*this.get_angularDrag(),this.m_dragTorque.y=-this.m_angularVelocity.y*this.get_angularDrag(),this.m_dragTorque.z=-this.m_angularVelocity.z*this.get_angularDrag(),1E-4<=l.Abs(this.m_dragTorque.x)&&(this.m_torque.x+=this.m_dragTorque.x,this.m_hasTorque=!0),1E-4<=l.Abs(this.m_dragTorque.y)&&(this.m_torque.y+=this.m_dragTorque.y,this.m_hasTorque=!0),1E-4<=l.Abs(this.m_dragTorque.z)&&
(this.m_torque.z+=this.m_dragTorque.z,this.m_hasTorque=!0))},IntegrateVelocity:function(a){if(!this.kinematic){if(this.m_hasForce){var b=this.get_velocity();b.x+=this.m_accel.x*a;b.y+=this.m_accel.y*a;b.z+=this.m_accel.z*a;this.set_velocity(b)}this.m_hasTorque&&(b=this.get_angularVelocity(),b.x+=this.m_torque.x*a,b.y+=this.m_torque.y*a,b.z+=this.m_torque.z*a,this.set_angularVelocity(b))}},IntegratePosition:function(a){var b=!0;1E-4>l.Abs(this.m_velocity.x)&&1E-4>l.Abs(this.m_velocity.y)&&1E-4>l.Abs(this.m_velocity.z)&&
(b=!1);b&&(b=this.m_entity.m_transform.get_localPosition(),b.x+=this.m_velocity.x*a,b.y+=this.m_velocity.y*a,b.z+=this.m_velocity.z*a,this.m_entity.m_transform.set_localPosition(b));b=!1;1E-4>l.Abs(this.m_angularVelocity.x)&&1E-4>l.Abs(this.m_angularVelocity.y)&&1E-4>l.Abs(this.m_angularVelocity.z)&&(b=!1);b&&(b=this.m_entity.m_transform.get_localRotation(),this.m_avq.Set(this.m_angularVelocity.x,this.m_angularVelocity.y,this.m_angularVelocity.z,0),this.m_avq.Multiply(b,!1),this.m_avq.Scale(.25),
b.x+=this.m_avq.x*a,b.y+=this.m_avq.y*a,b.z+=this.m_avq.z*a,b.w+=this.m_avq.w*a,b.Normalize(),this.m_entity.m_transform.set_localRotation(b))},ResetForces:function(){this.m_accel.x=0;this.m_accel.y=0;this.m_accel.z=0;this.m_hasForce=!1;this.m_torque.x=0;this.m_torque.y=0;this.m_torque.z=0;this.m_hasTorque=!1},__class__:Kb,__properties__:s(M.prototype.__properties__,{set_mass:"set_mass",get_mass:"get_mass",set_angularDrag:"set_angularDrag",get_angularDrag:"get_angularDrag",set_drag:"set_drag",get_drag:"get_drag",
set_angularVelocity:"set_angularVelocity",get_angularVelocity:"get_angularVelocity",set_velocity:"set_velocity",get_velocity:"get_velocity"})});var qc=function(a){v.call(this,a)};k["haxor.component.physics.SphereCollider"]=qc;qc.__name__=["haxor","component","physics","SphereCollider"];qc.__super__=Ya;qc.prototype=s(Ya.prototype,{get_center:function(){return g.data.get_v3().Set(this.m_center.x,this.m_center.y,this.m_center.z)},set_center:function(a){this.m_center.Set(a.x,a.y,a.z);this.Refresh();return a},
get_radius:function(){return this.m_radius},set_radius:function(a){this.m_radius=a;this.Refresh();return a},OnBuild:function(){this.m_type=Y.Sphere;Ya.prototype.OnBuild.call(this);this.m_center=new n(0,0,0);this.m_radius=1;this.Refresh()},GenerateSphere:function(){var a=this.m_sphere,b=this.m_entity.m_transform.get_WorldMatrix(),c=g.data.get_v3().Set3(this.m_center);b.Transform3x4(c);a.Set3(c);b=x.GetScale(b,g.data.get_m4());a.w=l.Max(b.m00,Math.max(b.m11,b.m22))*this.m_radius},GenerateAABB:function(){var a=
this.m_aabb,b=this.m_entity.m_transform.get_WorldMatrix(),c=.5773507*this.get_radius(),d=g.data.get_v3().Set(c,c,c);b.Transform3x3(d);c=.5*Math.sqrt(d.x*d.x+d.y*d.y+d.z*d.z);d.Set3(this.m_center);b.Transform3x4(d);a.Set(-c+d.x,c+d.x,-c+d.y,c+d.y,-c+d.z,c+d.z)},__class__:qc,__properties__:s(Ya.prototype.__properties__,{set_radius:"set_radius",get_radius:"get_radius",set_center:"set_center",get_center:"get_center"})});var Xc=function(){this.cid=new Oa;this.list=[];this.front=[];this.back=[];for(var a=
0;64>a;)a++,this.front.push(null),this.back.push(null)};k["haxor.context.CameraContext"]=Xc;Xc.__name__=["haxor","context","CameraContext"];Xc.prototype={Create:function(a){this.skybox_material=new aa("internal/Skybox");this.skybox_material.ztest=!0;this.skybox_material.cull=0;this.skybox_material.zwrite=!1;this.skybox_material.set_shader(new C(ea.clear_skybox_source));this.list.push(a);this.SortCameraList();g.renderer.AddCamera(a)},Destroy:function(a){this.ClearTargets(a);E.remove(this.list,a);this.SortCameraList();
this.cid.set_id(a.__cid);g.renderer.RemoveCamera(a)},Bind:function(a){var b=this.front[a.__cid],c=a.m_target,b=null==b?c:b;a.UpdateProjection();g.renderer.UpdateCameraSAP(a);g.texture.BindTarget(b);g.renderer.UpdateDisplayList(a);la.Clear(a)},Resize:function(){for(var a=0,b=this.list.length;a<b;){var c=a++;this.UpdateViewport(this.list[c])}},ClearTargets:function(a){var b;b=this.front[a.__cid];null!=b&&v.Destroy(b);b=this.back[a.__cid];null!=b&&v.Destroy(b);this.front[a.__cid]=null;this.back[a.__cid]=
null},Unbind:function(a){this.SwapTargets(a)},SwapTargets:function(a){var b;b=this.front[a.__cid];this.front[a.__cid]=this.back[a.__cid];this.back[a.__cid]=b},UpdateViewport:function(a){var b=!1;1>a.m_quality?b=!0:0<a.get_filters().length&&(b=!0);var c=H.m_width,d=H.m_height;null!=a.m_target&&(c=a.m_target.m_width,d=a.m_target.m_height);a.m_aspect=c/d;var c=c*a.m_quality,d=d*a.m_quality,c=1>c?1:c,d=1>d?1:d,f=w["int"](a.m_viewport.get_xMin()*c),m=w["int"](a.m_viewport.get_yMin()*d),c=a.m_viewport.get_width()*
c,e=a.m_viewport.get_height()*d;a.m_pixelViewport.set_xMin(f);f;a.m_pixelViewport.set_y(d-e-m);a.m_pixelViewport.set_width(c);a.m_pixelViewport.set_height(e);d=this.front[a.__cid];null!=d&&(c!=d.m_width?this.ClearTargets(a):e!=d.m_height&&this.ClearTargets(a));d=this.front[a.__cid];null==d&&b&&(b=null==a.m_target?y.RGB8:a.m_target.m_format,this.front[a.__cid]=new Db(c,e,b,a.m_captureDepth),0>=a.get_filters().length?this.back[a.__cid]=this.front[a.__cid]:this.back[a.__cid]=new Db(c,e,b,a.m_captureDepth),
this.front[a.__cid].set_name(this.back[a.__cid].set_name("CameraScreenBuffer")));a.m_projection_dirty=!0;a.m_proj_uniform_dirty=!0},SortCameraList:function(){1<this.list.length&&this.list.sort(function(a,b){return a.get_order()==b.get_order()?a.m_entity.get_name()<b.m_entity.get_name()?-1:1:a.get_order()<b.get_order()?-1:1})},__class__:Xc};var $b=function(){this.i=[];this.v=[];this.m_v2=[];this.m_v3=[];this.m_v4=[];this.m_c=[];this.m_q=[];this.m_m4=[];this.m_aabb3=[];this.m_aabb2=[];this.m_collision=
[];this.m_ncollision=this.m_naabb2=this.m_naabb3=this.m_nm4=this.m_nq=this.m_nc=this.m_nv4=this.m_nv3=this.m_nv2=0;this.m4l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(var a=0,b=$b.MAX_TEMP;a<b;)a++,this.i.push(0),this.v.push(0),this.m_v2.push(new K(0,0)),this.m_v3.push(new n(0,0,0)),this.m_v4.push(new Q(0,0,0,0)),this.m_c.push(new t(0,0,0,1)),this.m_q.push(new F(0,0,0,1)),this.m_m4.push(new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),this.m_aabb3.push(ba.get_empty()),this.m_aabb2.push(Ca.get_empty()),this.m_collision.push(new ac)};
k["haxor.context.DataContext"]=$b;$b.__name__=["haxor","context","DataContext"];$b.prototype={get_v2:function(){return this.m_v2[this.m_nv2=(this.m_nv2+1)%this.m_v2.length]},get_v3:function(){return this.m_v3[this.m_nv3=(this.m_nv3+1)%this.m_v3.length]},get_v4:function(){return this.m_v4[this.m_nv4=(this.m_nv4+1)%this.m_v4.length]},get_c:function(){return this.m_c[this.m_nc=(this.m_nc+1)%this.m_c.length]},get_q:function(){return this.m_q[this.m_nq=(this.m_nq+1)%this.m_q.length]},get_aabb3:function(){return this.m_aabb3[this.m_naabb3=
(this.m_naabb3+1)%this.m_aabb3.length]},get_aabb2:function(){return this.m_aabb2[this.m_naabb2=(this.m_naabb2+1)%this.m_aabb2.length]},get_collision:function(){return this.m_collision[this.m_ncollision=(this.m_ncollision+1)%this.m_collision.length]},get_m4:function(){return this.m_m4[this.m_nq=(this.m_nm4+1)%this.m_m4.length]},__class__:$b,__properties__:{get_m4:"get_m4",get_collision:"get_collision",get_aabb2:"get_aabb2",get_aabb3:"get_aabb3",get_q:"get_q",get_c:"get_c",get_v4:"get_v4",get_v3:"get_v3",
get_v2:"get_v2"}};var g=function(){};k["haxor.context.EngineContext"]=g;g.__name__=["haxor","context","EngineContext"];g.Initialize=function(){u.Log("Haxor> Engine Context Initialize.",3);g.update=new hb("process.update",g.maxNodes);g.fixed_update=new hb("process.fixed-update",g.maxNodes);g.render=new hb("process.render",g.maxNodes);g.resize=new hb("process.resize",g.maxNodes);g.resources=new hb("process.resources",g.maxNodes);g.disposables=new hb("process.disposables",g.maxNodes);g.awake=[];g.start=
[];g.list=[g.update,g.render,g.resize,g.resources,g.disposables];g.data=new $b;sa.Initialize();S.Initialize();D.Initialize();g.renderer=new Yc;g.mesh=new Zc;g.material=new $c;g.texture=new ta;g.gizmo=new ad;g.camera=new Xc;g.transform=new bd;g.physics=new cd;g.kernel=new dd};g.Build=function(){g.mesh.Initialize();g.material.Initialize();g.texture.Initialize();g.gizmo.Initialize();g.transform.Initialize();g.renderer.Initialize();g.physics.Initialize();g.kernel.Initialize()};g.Enable=function(a){J.__instanceof(a,
$a)&&g.update.Add(a);J.__instanceof(a,wc)&&g.fixed_update.Add(a);J.__instanceof(a,Mb)&&g.render.Add(a);J.__instanceof(a,Qb)&&g.resize.Add(a);J.__instanceof(a,va)&&g.renderer.Enable(a);if(J.__instanceof(a,wa))for(var b=0,c=a.m_components.length;b<c;){var d=b++,d=a.m_components[d];J.__instanceof(d,ia)&&g.renderer.Enable(d)}};g.Disable=function(a){J.__instanceof(a,$a)&&g.update.Remove(a);J.__instanceof(a,wc)&&g.fixed_update.Remove(a);J.__instanceof(a,Mb)&&g.render.Remove(a);J.__instanceof(a,Qb)&&g.resize.Remove(a);
J.__instanceof(a,va)&&g.renderer.Disable(a);if(J.__instanceof(a,wa))for(var b=0,c=a.m_components.length;b<c;){var d=b++,d=a.m_components[d];J.__instanceof(d,ia)&&g.renderer.Disable(d)}};g.OnEntiyLayerChange=function(a,b,c){for(var d=0,f=a.m_components.length;d<f;){var m=d++,m=a.m_components[m];J.__instanceof(m,va)&&g.renderer.OnLayerChange(m,b,c)}};g.Destroy=function(a){if(!a.m_destroyed){a.m_destroyed=!0;for(var b=0,c=g.list.length;b<c;){var d=b++;g.list[d].Remove(a)}g.disposables.Add(a);if(J.__instanceof(a,
wa)){b=a.m_transform;b.set_parent(null);c=0;for(d=b.m_hierarchy.length;c<d;){var f=c++;g.Destroy(b.GetChild(f).get_entity())}b=0;for(c=a.m_components.length;b<c;)d=b++,g.Destroy(a.m_components[d])}}};var ad=function(){};k["haxor.context.GizmoContext"]=ad;ad.__name__=["haxor","context","GizmoContext"];ad.prototype={Initialize:function(){var a;a=this.gizmo_material=new aa("$GizmoMaterial");a.set_shader(new C(ea.grid_source));a.blend=!0;a.SetBlending(770,771);a.SetFloat("Area",1E3);a.SetColor("Tint",
new t(1,1,1,.4));a.ztest=!1;a=this.texture_material=new aa("$TextureMaterial");a.set_shader(new C(ea.texture_source));a.blend=!0;a.SetBlending(770,771);a.SetFloat2("Screen",H.m_width,H.m_height);a.SetFloat4("Rect",0,0,100,100);a.SetColor("Tint",new t(1,1,1,1));a.cull=0;a.ztest=!1;this.CreateGrid(100);this.CreateTextureQuad();this.wire_sphere_renderer=new xc;this.wire_cube_renderer=new yc;this.axis_renderer=new zc;this.canvas_renderer=new Ac;this.line_renderer=new Bc;this.point_renderer=new Cc},CreateTextureQuad:function(){var a=
this.texture=new Fa("$TextureQuad"),b;b=L.Alloc([0,0,0,0,-1,0,1,-1,0,0,0,0,1,-1,0,1,0,0]);a.Set("vertex",b,3);a.set_bounds(a.GenerateAttribBounds("vertex",g.data.get_aabb3()))},CreateGrid:function(a){this.grid=new Fa("$GridMesh");this.grid.primitive=1;var b=a+1;a=1/a;for(var c=0,d=0,f=new L(12*b),m,e=m=0;e<b;)e++,f.Set(m++,c-.5),f.Set(m++,0),f.Set(m++,.5),f.Set(m++,c-.5),f.Set(m++,0),f.Set(m++,-.5),c+=a;for(c=0;c<b;)c++,f.Set(m++,.5),f.Set(m++,0),f.Set(m++,d-.5),f.Set(m++,-.5),f.Set(m++,0),f.Set(m++,
d-.5),d+=a;this.grid.Set("vertex",f,3);this.grid.set_bounds(this.grid.GenerateAttribBounds("vertex",g.data.get_aabb3()))},DrawGrid:function(a,b){this.gizmo_material.SetFloat("Area",a);null!=b&&this.gizmo_material.SetFloat4("Tint",b.r,b.g,b.b,b.a);la.Render(this.grid,this.gizmo_material,null,U.m_main)},DrawWireSphere:function(a,b,c,d){this.wire_sphere_renderer.Push(c,g.data.get_v4().Set(b,b,b,1),g.data.get_v4().Set3(a),d)},DrawWireCube:function(a,b,c,d){this.wire_cube_renderer.Push(c,g.data.get_v4().Set3(b),
g.data.get_v4().Set3(a),d)},DrawAxis:function(a,b,c,d){this.axis_renderer.Push(c,g.data.get_v4().Set3(b),g.data.get_v4().Set3(a),d)},DrawLine:function(a,b,c,d){this.line_renderer.Push(c,g.data.get_v4().Set3(a),g.data.get_v4().Set3(b),d)},DrawPoint:function(a,b,c,d,f){this.point_renderer.Push(c,g.data.get_v4().Set(b,d?1:0,0,0),g.data.get_v4().Set(1,1,1,1).Set3(a),f)},Render:function(){var a;a=this.wire_sphere_renderer;a.Render();a.Clear();a=this.wire_cube_renderer;a.Render();a.Clear();a=this.axis_renderer;
a.Render();a.Clear();a=this.canvas_renderer;a.Render();a.Clear();a=this.line_renderer;a.Render();a.Clear();a=this.point_renderer;a.Render();a.Clear()},__class__:ad};var x=function(a,b,c,d,f,m,e,g,h,k,l,n,p,r,q,s){null==s&&(s=0);null==q&&(q=0);null==r&&(r=0);null==p&&(p=0);null==n&&(n=0);null==l&&(l=0);null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);null==e&&(e=0);null==m&&(m=0);null==f&&(f=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.m00=a;this.m01=b;this.m02=c;this.m03=d;this.m10=
f;this.m11=m;this.m12=e;this.m13=g;this.m20=h;this.m21=k;this.m22=l;this.m23=n;this.m30=p;this.m31=r;this.m32=q;this.m33=s};k["haxor.math.Matrix4"]=x;x.__name__=["haxor","math","Matrix4"];x.__properties__={get_identity:"get_identity",get_temp:"get_temp"};x.get_temp=function(){return g.data.get_m4()};x.get_identity=function(){return new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)};x.FromQuaternion=function(a,b){var c;c=null==b?new x:b;var d=a.x*a.x,f=a.y*a.y,m=a.z*a.z,e=a.x*a.y,g=a.x*a.z,h=a.y*a.z,k=a.w*a.x,
l=a.w*a.y,n=a.w*a.z;c.m00=1-2*(f+m);c.m01=2*(e-n);c.m02=2*(g+l);c.m10=2*(e+n);c.m11=1-2*(d+m);c.m12=2*(h-k);c.m20=2*(g-l);c.m21=2*(h+k);c.m22=1-2*(d+f);c.m30=c.m31=c.m32=0;c.m33=1;return c};x.FromArray=function(a,b){var c;c=null==b?new x:b;for(var d=0,f=a.length;d<f;){var m=d++;c.SetIndex(m,a[m])}return c};x.TRS=function(a,b,c,d){var f;f=null==c?1:c.x;var m;m=null==c?1:c.y;c=null==c?1:c.z;var e=a.x,h=a.y;a=a.z;var k=g.data.get_m4();x.FromQuaternion(b,k);b=null==d?new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,
0,1):d;b.m00=k.m00*f;b.m01=k.m01*m;b.m02=k.m02*c;b.m03=e;b.m10=k.m10*f;b.m11=k.m11*m;b.m12=k.m12*c;b.m13=h;b.m20=k.m20*f;b.m21=k.m21*m;b.m22=k.m22*c;b.m23=a;b.m30=b.m31=b.m32=0;b.m33=1;return b};x.Frustum=function(a,b,c,d,f,m,e){e=null==e?new x:e;var g=2*f,h=1/(b-a),k=1/(c-d),l=1/(m-f);e.m00=g*h;e.m01=0;e.m02=(b+a)*h;e.m03=0;e.m10=0;e.m11=g*k;e.m12=(c+d)*k;e.m13=0;e.m20=0;e.m21=0;e.m22=-(f+m)*l;e.m23=-g*m*l;e.m30=0;e.m31=0;e.m32=-1;e.m33=0;return e};x.FrustumInverse=function(a,b,c,d,f,m,e){e=null==
e?new x:e;var g=2*f;e.m00=(b-a)/g;e.m01=0;e.m02=0;e.m03=(b+a)/g;e.m10=0;e.m11=(c-d)/g;e.m12=0;e.m13=(c+d)/g;e.m20=0;e.m21=0;e.m22=0;e.m23=-1;e.m30=0;e.m31=0;e.m32=(m-f)/(-g*m);e.m33=(m+f)/(g*m);return e};x.Ortho=function(a,b,c,d,f,m,e){e=null==e?new x:e;var g=1/(b-a),h=1/(c-d),k=1/(m-f);e.m00=2*g;e.m01=0;e.m02=0;e.m03=-(b+a)*g;e.m10=0;e.m11=2*h;e.m12=0;e.m13=-(c+d)*h;e.m20=0;e.m21=0;e.m22=-2*k;e.m23=-(m+f)*k;e.m30=0;e.m31=0;e.m32=0;e.m33=1;return e};x.OrthoInverse=function(a,b,c,d,f,e,mc){a=g.data.get_m4().SetOrtho(a,
b,c,d,f,e);return x.GetInverseTransform(a,mc)};x.Perspective=function(a,b,c,d,f){a=Math.tan(.008726646259971648*a)*c;var e=-a;return x.Frustum(b*e,b*a,a,e,c,d,f)};x.PerspectiveInverse=function(a,b,c,d,f){a=Math.tan(.008726646259971648*a)*c;var e=-a;return x.FrustumInverse(b*e,b*a,a,e,c,d,f)};x.GetRotation=function(a,b){var c;c=null==b?new x:b;var d=g.data.get_v3();d.Set(c.m00,c.m01,c.m02).Normalize();c.m00=d.x;c.m01=d.y;c.m02=d.z;c.m03=0;d.Set(c.m10,c.m11,c.m12).Normalize();c.m10=d.x;c.m11=d.y;c.m12=
d.z;c.m13=0;d.Set(c.m20,c.m21,c.m22).Normalize();c.m20=d.x;c.m21=d.y;c.m22=d.z;c.m23=0;c.m30=c.m31=c.m32=0;c.m33=1;return c};x.GetScale=function(a,b){var c;c=null==b?new x:b;var d=Math.sqrt(a.m00*a.m00+a.m10*a.m10+a.m20*a.m20),f=Math.sqrt(a.m01*a.m01+a.m11*a.m11+a.m21*a.m21),e=Math.sqrt(a.m02*a.m02+a.m12*a.m12+a.m22*a.m22);return c.Set(d,0,0,0,0,f,0,0,0,0,e,0,0,0,0,1)};x.GetInverseTransform=function(a,b){var c;c=null==b?new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1):b;var d=a.m00,f=a.m01,e=a.m02,g=a.m03,
h=a.m10,k=a.m11,l=a.m12,n=a.m13,p=a.m20,r=a.m21,q=a.m22,s=a.m23,t=Math.sqrt(d*d+h*h+p*p),u=Math.sqrt(f*f+k*k+r*r),v=Math.sqrt(e*e+l*l+q*q),t=1E-4>=(0>t?-t:t)?0:1/t,u=1E-4>=(0>u?-u:u)?0:1/u,v=1E-4>=(0>v?-v:v)?0:1/v,d=d*t,f=f*u,e=e*v,h=h*t,k=k*u,l=l*v,p=p*t,r=r*u,q=q*v;c.Set(t*d,t*h,t*p,t*(d*-g+h*-n+p*-s),u*f,u*k,u*r,u*(f*-g+k*-n+r*-s),v*e,v*l,v*q,v*(e*-g+l*-n+q*-s),0,0,0,1);return c};x.LookRotation=function(a,b,c){return x.LookAt(g.data.get_v3().Set(0,0,0),a,b,c)};x.LookAt=function(a,b,c,d){null==
d&&(d=new x);null==c&&(c=g.data.get_v3().Set(0,1,0));b=g.data.get_v3().Set3(b).Sub(a).Normalize();c=n.Cross(b,c,g.data.get_v3()).Normalize();var f=n.Cross(c,b,g.data.get_v3());d.m00=c.x;d.m10=c.y;d.m20=c.z;d.m01=f.x;d.m11=f.y;d.m21=f.z;d.m02=-b.x;d.m12=-b.y;d.m22=-b.z;d.m03=-(c.x*a.x+c.y*a.y+c.z*a.z);d.m13=-(f.x*a.x+f.y*a.y+f.z*a.z);d.m23=b.x*a.x+b.y*a.y+b.z*a.z;d.m30=d.m31=d.m32=0;d.m33=1;return d};x.Parse=function(a,b){null==b&&(b=" ");for(var c=a.split(b),d=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,
1),f=0,e=c.length;f<e;){var g=f++,h=w.parseFloat(B.trim(c[g]));d.SetIndex(g,h)}return d};x.prototype={get_clone:function(){return new x(this.m00,this.m01,this.m02,this.m03,this.m10,this.m11,this.m12,this.m13,this.m20,this.m21,this.m22,this.m23,this.m30,this.m31,this.m32,this.m33)},get_quaternion:function(){return F.FromMatrix4(g.data.get_m4().SetMatrix4(this).ToRotation())},set_quaternion:function(a){x.FromQuaternion(a,this);return a},get_trace:function(){return this.m00+this.m11+this.m22+this.m33},
get_rotation:function(){return(new x(this.m00,this.m01,this.m02,this.m03,this.m10,this.m11,this.m12,this.m13,this.m20,this.m21,this.m22,this.m23,this.m30,this.m31,this.m32,this.m33)).ToRotation()},get_scale:function(){return x.GetScale(this)},get_translation:function(){return new x(1,0,0,this.m03,0,1,0,this.m13,0,0,1,this.m23,0,0,0,1)},get_inverseTransform:function(){return x.GetInverseTransform(this,null)},get_transposed:function(){return new x(this.m00,this.m10,this.m20,this.m30,this.m01,this.m11,
this.m21,this.m31,this.m02,this.m12,this.m22,this.m32,this.m03,this.m13,this.m23,this.m33)},ToRowMajor:function(){return[this.m00,this.m01,this.m02,this.m03,this.m10,this.m11,this.m12,this.m13,this.m20,this.m21,this.m22,this.m23,this.m30,this.m31,this.m32,this.m33]},ToColumnMajor:function(){return[this.m00,this.m10,this.m20,this.m30,this.m01,this.m11,this.m21,this.m31,this.m02,this.m12,this.m22,this.m32,this.m03,this.m13,this.m23,this.m33]},GetLine:function(a,b){null==b&&(b=new Q);return b.Set(this.GetRowCol(a,
0),this.GetRowCol(a,1),this.GetRowCol(a,2),this.GetRowCol(a,3))},SetLine:function(a,b,c,d,f){switch(a){case 0:this.m00=b;this.m01=c;this.m02=d;this.m03=f;break;case 1:this.m10=b;this.m11=c;this.m12=d;this.m13=f;break;case 2:this.m20=b;this.m21=c;this.m22=d;this.m23=f;break;case 3:this.m30=b,this.m31=c,this.m32=d,this.m33=f}},GetColumn:function(a,b){null==b&&(b=new Q);return b.Set(this.GetRowCol(0,a),this.GetRowCol(1,a),this.GetRowCol(2,a),this.GetRowCol(3,a))},SetColumn:function(a,b,c,d,f){switch(a){case 0:this.m00=
b;this.m10=c;this.m20=d;this.m30=f;break;case 1:this.m01=b;this.m11=c;this.m21=d;this.m31=f;break;case 2:this.m02=b;this.m12=c;this.m22=d;this.m32=f;break;case 3:this.m03=b,this.m13=c,this.m23=d,this.m33=f}},get_diagonalLR:function(){return new Q(this.m00,this.m11,this.m22,this.m33)},set_diagonalLR:function(a){this.m00=a.x;this.m11=a.y;this.m22=a.z;this.m33=a.w;return a},SetIdentity:function(){return this.Set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},Set:function(a,b,c,d,f,e,g,h,k,l,n,p,r,q,s,t){null==t&&
(t=0);null==s&&(s=0);null==q&&(q=0);null==r&&(r=0);null==p&&(p=0);null==n&&(n=0);null==l&&(l=0);null==k&&(k=0);null==h&&(h=0);null==g&&(g=0);null==e&&(e=0);null==f&&(f=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.m00=a;this.m01=b;this.m02=c;this.m03=d;this.m10=f;this.m11=e;this.m12=g;this.m13=h;this.m20=k;this.m21=l;this.m22=n;this.m23=p;this.m30=r;this.m31=q;this.m32=s;this.m33=t;return this},SetMatrix4:function(a){this.m00=a.m00;this.m01=a.m01;this.m02=a.m02;this.m03=a.m03;
this.m10=a.m10;this.m11=a.m11;this.m12=a.m12;this.m13=a.m13;this.m20=a.m20;this.m21=a.m21;this.m22=a.m22;this.m23=a.m23;this.m30=a.m30;this.m31=a.m31;this.m32=a.m32;this.m33=a.m33;return this},GetIndex:function(a){switch(a){case 0:return this.m00;case 1:return this.m01;case 2:return this.m02;case 3:return this.m03;case 4:return this.m10;case 5:return this.m11;case 6:return this.m12;case 7:return this.m13;case 8:return this.m20;case 9:return this.m21;case 10:return this.m22;case 11:return this.m23;
case 12:return this.m30;case 13:return this.m31;case 14:return this.m32;case 15:return this.m33}return 0},SetIndex:function(a,b){switch(a){case 0:this.m00=b;break;case 1:this.m01=b;break;case 2:this.m02=b;break;case 3:this.m03=b;break;case 4:this.m10=b;break;case 5:this.m11=b;break;case 6:this.m12=b;break;case 7:this.m13=b;break;case 8:this.m20=b;break;case 9:this.m21=b;break;case 10:this.m22=b;break;case 11:this.m23=b;break;case 12:this.m30=b;break;case 13:this.m31=b;break;case 14:this.m32=b;break;
case 15:this.m33=b}return this},SetRowCol:function(a,b,c){return this.SetIndex(b+(a<<2),c)},GetRowCol:function(a,b){return this.GetIndex(b+(a<<2))},SwapCol:function(a,b){var c=this.GetRowCol(0,a),d=this.GetRowCol(1,a),f=this.GetRowCol(2,a),e=this.GetRowCol(3,a);this.SetRowCol(0,a,this.GetRowCol(0,b));this.SetRowCol(1,a,this.GetRowCol(1,b));this.SetRowCol(2,a,this.GetRowCol(2,b));this.SetRowCol(3,a,this.GetRowCol(3,b));this.SetRowCol(0,b,c);this.SetRowCol(1,b,d);this.SetRowCol(2,b,f);this.SetRowCol(3,
b,e);return this},SwapRow:function(a,b){var c=this.GetRowCol(a,0),d=this.GetRowCol(a,1),f=this.GetRowCol(a,2),e=this.GetRowCol(a,3);this.SetRowCol(a,0,this.GetRowCol(b,0));this.SetRowCol(a,1,this.GetRowCol(b,1));this.SetRowCol(a,2,this.GetRowCol(b,2));this.SetRowCol(a,3,this.GetRowCol(b,3));this.SetRowCol(b,0,c);this.SetRowCol(b,1,d);this.SetRowCol(b,2,f);this.SetRowCol(b,3,e);return this},Transpose:function(){return this.Set(this.m00,this.m10,this.m20,this.m30,this.m01,this.m11,this.m21,this.m31,
this.m02,this.m12,this.m22,this.m32,this.m03,this.m13,this.m23,this.m33)},ToRotation:function(){var a=g.data.get_v3();a.Set(this.m00,this.m01,this.m02).Normalize();this.m00=a.x;this.m01=a.y;this.m02=a.z;this.m03=0;a.Set(this.m10,this.m11,this.m12).Normalize();this.m10=a.x;this.m11=a.y;this.m12=a.z;this.m13=0;a.Set(this.m20,this.m21,this.m22).Normalize();this.m20=a.x;this.m21=a.y;this.m22=a.z;this.m30=this.m31=this.m32=this.m23=0;this.m33=1;return this},Rotate:function(a){var b=g.data.get_v3();b.Set(this.m00,
this.m01,this.m02).Normalize();a.x=b.x*a.x+b.y*a.y+b.z*a.z;b.Set(this.m10,this.m11,this.m12).Normalize();a.y=b.x*a.x+b.y*a.y+b.z*a.z;b.Set(this.m20,this.m21,this.m22).Normalize();a.z=b.x*a.x+b.y*a.y+b.z*a.z;return a},SetTRS:function(a,b,c){return x.TRS(a,b,c,this)},ToInverseTransform:function(){return x.GetInverseTransform(g.data.get_m4().SetMatrix4(this),this)},MultiplyTransform:function(a){this.Set(this.m00*a.m00+this.m01*a.m10+this.m02*a.m20,this.m00*a.m01+this.m01*a.m11+this.m02*a.m21,this.m00*
a.m02+this.m01*a.m12+this.m02*a.m22,this.m00*a.m03+this.m01*a.m13+this.m02*a.m23+this.m03,this.m10*a.m00+this.m11*a.m10+this.m12*a.m20,this.m10*a.m01+this.m11*a.m11+this.m12*a.m21,this.m10*a.m02+this.m11*a.m12+this.m12*a.m22,this.m10*a.m03+this.m11*a.m13+this.m12*a.m23+this.m13,this.m20*a.m00+this.m21*a.m10+this.m22*a.m20,this.m20*a.m01+this.m21*a.m11+this.m22*a.m21,this.m20*a.m02+this.m21*a.m12+this.m22*a.m22,this.m20*a.m03+this.m21*a.m13+this.m22*a.m23+this.m23,0,0,0,1);return this},Multiply3x4:function(a){this.Set(this.m00*
a.m00+this.m01*a.m10+this.m02*a.m20+this.m03*a.m30,this.m00*a.m01+this.m01*a.m11+this.m02*a.m21+this.m03*a.m31,this.m00*a.m02+this.m01*a.m12+this.m02*a.m22+this.m03*a.m32,this.m00*a.m03+this.m01*a.m13+this.m02*a.m23+this.m03*a.m33,this.m10*a.m00+this.m11*a.m10+this.m12*a.m20+this.m13*a.m30,this.m10*a.m01+this.m11*a.m11+this.m12*a.m21+this.m13*a.m31,this.m10*a.m02+this.m11*a.m12+this.m12*a.m22+this.m13*a.m32,this.m10*a.m03+this.m11*a.m13+this.m12*a.m23+this.m13*a.m33,this.m20*a.m00+this.m21*a.m10+
this.m22*a.m20+this.m23*a.m30,this.m20*a.m01+this.m21*a.m11+this.m22*a.m21+this.m23*a.m31,this.m20*a.m02+this.m21*a.m12+this.m22*a.m22+this.m23*a.m32,this.m20*a.m03+this.m21*a.m13+this.m22*a.m23+this.m23*a.m33,this.m30,this.m31,this.m32,this.m33);return this},Multiply:function(a){this.Set(this.m00*a.m00+this.m01*a.m10+this.m02*a.m20+this.m03*a.m30,this.m00*a.m01+this.m01*a.m11+this.m02*a.m21+this.m03*a.m31,this.m00*a.m02+this.m01*a.m12+this.m02*a.m22+this.m03*a.m32,this.m00*a.m03+this.m01*a.m13+this.m02*
a.m23+this.m03*a.m33,this.m10*a.m00+this.m11*a.m10+this.m12*a.m20+this.m13*a.m30,this.m10*a.m01+this.m11*a.m11+this.m12*a.m21+this.m13*a.m31,this.m10*a.m02+this.m11*a.m12+this.m12*a.m22+this.m13*a.m32,this.m10*a.m03+this.m11*a.m13+this.m12*a.m23+this.m13*a.m33,this.m20*a.m00+this.m21*a.m10+this.m22*a.m20+this.m23*a.m30,this.m20*a.m01+this.m21*a.m11+this.m22*a.m21+this.m23*a.m31,this.m20*a.m02+this.m21*a.m12+this.m22*a.m22+this.m23*a.m32,this.m20*a.m03+this.m21*a.m13+this.m22*a.m23+this.m23*a.m33,
this.m30*a.m00+this.m31*a.m10+this.m32*a.m20+this.m33*a.m30,this.m30*a.m01+this.m31*a.m11+this.m32*a.m21+this.m33*a.m31,this.m30*a.m02+this.m31*a.m12+this.m32*a.m22+this.m33*a.m32,this.m30*a.m03+this.m31*a.m13+this.m32*a.m23+this.m33*a.m33);return this},Transform4x4:function(a){var b=this.m10*a.x+this.m11*a.y+this.m12*a.z+this.m13*a.w,c=this.m20*a.x+this.m21*a.y+this.m22*a.z+this.m23*a.w,d=this.m30*a.x+this.m31*a.y+this.m32*a.z+this.m33*a.w;a.x=this.m00*a.x+this.m01*a.y+this.m02*a.z+this.m03*a.w;
a.y=b;a.z=c;a.w=d;return a},Transform3x4:function(a){var b=this.m10*a.x+this.m11*a.y+this.m12*a.z+this.m13,c=this.m20*a.x+this.m21*a.y+this.m22*a.z+this.m23;a.x=this.m00*a.x+this.m01*a.y+this.m02*a.z+this.m03;a.y=b;a.z=c;return a},Transform3x3:function(a){var b=this.m10*a.x+this.m11*a.y+this.m12*a.z,c=this.m20*a.x+this.m21*a.y+this.m22*a.z;a.x=this.m00*a.x+this.m01*a.y+this.m02*a.z;a.y=b;a.z=c;return a},Transform2x3:function(a){var b=this.m10*a.x+this.m11*a.y+this.m13;a.x=this.m00*a.x+this.m01*a.y+
this.m03;a.y=b},Transform2x2:function(a){var b=this.m10*a.x+this.m11*a.y;a.x=this.m00*a.x+this.m01*a.y;a.y=b},SetLookAt:function(a,b,c){return x.LookAt(a,b,c,this)},SetFrustum:function(a,b,c,d,f,e){return x.Frustum(a,b,c,d,f,e,this)},SetFrustumInverse:function(a,b,c,d,f,e){return x.FrustumInverse(a,b,c,d,f,e,this)},SetOrtho:function(a,b,c,d,f,e){return x.Ortho(a,b,c,d,f,e,this)},SetOrthoInverse:function(a,b,c,d,f,e){return x.OrthoInverse(a,b,c,d,f,e,this)},SetPerspective:function(a,b,c,d){return x.Perspective(a,
b,c,d,this)},SetPerspectiveInverse:function(a,b,c,d){return x.PerspectiveInverse(a,b,c,d,this)},ToArray:function(){return[this.m00,this.m01,this.m02,this.m03,this.m10,this.m11,this.m12,this.m13,this.m20,this.m21,this.m22,this.m23,this.m30,this.m31,this.m32,this.m33]},ToString:function(a,b){null==b&&(b=2);null==a&&(a=!0);for(var c=this.ToArray(),d=[],f=0,e=c.length;f<e;){var g=f++;c[g]=l.RoundPlaces(c[g],b);d.push(0<=c[g]?" "+c[g]:c[g]+"")}c=a?"[":"";for(f=0;4>f;){e=f++;for(g=0;4>g;)var h=g++,c=c+
(d[h+4*e]+(3>h?",":""));c=3==e?c+"":a?c+" |":c+"\n"}a&&(c+="]");return c},__class__:x,__properties__:{set_diagonalLR:"set_diagonalLR",get_diagonalLR:"get_diagonalLR",get_transposed:"get_transposed",get_inverseTransform:"get_inverseTransform",get_translation:"get_translation",get_scale:"get_scale",get_rotation:"get_rotation",get_trace:"get_trace",set_quaternion:"set_quaternion",get_quaternion:"get_quaternion",get_clone:"get_clone"}};var O=function(a,b){this.type=a;this.m_render_count=0;this.m_gizmo_count=
b;if(e.TEXTURE_FLOAT&&!(0>=e.MAX_VERTEX_TEXTURES)){null==O.SHADER&&(O.SHADER=new C(ea.gizmo_source));this.material=new aa("Gizmo"+a+"Material");this.material.set_shader(O.SHADER);this.material.blend=!0;this.material.SetBlending(770,771);this.material.SetInt("Type",a);this.material.ztest=!1;var c=0,d=0;if(1<=b){c=l.Max(2,l.NextPOT(l.Ceil(Math.sqrt(O.DATA_OFFSET/4*b))));this.data=new Rb(c,c,y.Float4);for(var c=this.data.m_data.get_buffer(),d=0,f=c.m_length;d<f;){var m=d++;c.Set(m,3==m%4?1:0)}this.material.SetTexture("Data",
this.data);this.material.SetInt("DataSize",this.data.m_width);c=this.data.m_width;d=this.data.m_height}u.Log("Gizmos> Created Renderer ["+a+"] data["+c+"x"+d+"]",6);this.OnBuild()}};k["haxor.context.Gizmo"]=O;O.__name__=["haxor","context","Gizmo"];O.prototype={OnBuild:function(){},Push:function(a,b,c,d){if(e.TEXTURE_FLOAT&&!(0>=e.MAX_VERTEX_TEXTURES||this.m_render_count>=this.m_gizmo_count)){var f=this.m_render_count,m=this.data.m_data.get_buffer(),f=f*O.DATA_OFFSET;a=null==a?g.data.get_c().Set(1,
1,1,1):a;m.Set(f++,a.r);m.Set(f++,a.g);m.Set(f++,a.b);m.Set(f++,a.a);m.Set(f++,b.x);m.Set(f++,b.y);m.Set(f++,b.z);m.Set(f++,b.w);m.Set(f++,c.x);m.Set(f++,c.y);m.Set(f++,c.z);m.Set(f++,c.w);b=null==d?O.IDM:d;for(c=0;12>c;)d=c++,m.Set(f++,b.GetIndex(d));this.m_render_count++}},Clear:function(){this.m_render_count=0},Render:function(){if(e.TEXTURE_FLOAT&&!(0>=e.MAX_VERTEX_TEXTURES)){if(D.collider||D.colliderAABB||D.colliderSB)for(var a=g.physics.colliders,b=0,c=a.length;b<c;){var d=b++,d=a[d];D.collider&&
D.Collider(d);D.colliderAABB&&D.BoundingAABB(d.get_aabb());D.colliderSB&&D.BoundingSphere(d.get_sphere())}if(D.renderer)for(a=g.renderer.display,b=0,c=a.length;b<c;)for(var d=b++,d=a[d],f=0,m=d.m_length;f<m;){var mc=f++,mc=d.list[mc];null!=mc&&D.MeshRenderer(mc)}D.transform&&Ea.get_root().Traverse(function(a,b){if(a==Ea.get_root()||a==U.m_main.m_entity.m_transform)return!0;D.Transform(a);return!0});if(D.light)for(a=P.m_list,b=0,c=a.length;b<c;)d=b++,D.Light(a[d]);0<this.m_render_count&&(this.data.Apply(),
this.material.SetInt("Count",this.m_render_count),a=U.m_main.m_near,b=U.m_main.m_far,U.m_main.set_near(1),U.m_main.set_far(5E4),la.Render(this.mesh,this.material,null,U.m_main),U.m_main.set_near(a),U.m_main.set_far(b))}},__class__:O};var xc=function(){O.call(this,O.WIRE_SPHERE,O.MAX_GIZMOS)};k["haxor.context.WireSphereGizmo"]=xc;xc.__name__=["haxor","context","WireSphereGizmo"];xc.__super__=O;xc.prototype=s(O.prototype,{OnBuild:function(){var a=new Ka;a.set_name("$GizmoWireSphereMesh");a.primitive=
1;for(var b=new L(4320*this.m_gizmo_count),c=new L(12960*this.m_gizmo_count),d=0,f=0,e=0,g=0,h=this.m_gizmo_count;g<h;){g++;for(var k=0;720>k;){var l=k++,n=1/719,p;p=360*l*n;var r=.5*Math.sin(.017453292519943295*p),q=.5*Math.cos(.017453292519943295*p);p=360*(l+1)*n;l=.5*Math.sin(.017453292519943295*p);p=.5*Math.cos(.017453292519943295*p);c.Set(d++,q);c.Set(d++,0);c.Set(d++,r);b.Set(f++,e);c.Set(d++,p);c.Set(d++,0);c.Set(d++,l);b.Set(f++,e);c.Set(d++,0);c.Set(d++,q);c.Set(d++,r);b.Set(f++,e);c.Set(d++,
0);c.Set(d++,p);c.Set(d++,l);b.Set(f++,e);c.Set(d++,q);c.Set(d++,r);c.Set(d++,0);b.Set(f++,e);c.Set(d++,p);c.Set(d++,l);c.Set(d++,0);b.Set(f++,e)}e+=1}a.Set("id",b,1);a.Set("vertex",c,3);this.mesh=a},__class__:xc});var yc=function(){O.call(this,O.WIRE_CUBE,O.MAX_GIZMOS)};k["haxor.context.WireCubeGizmo"]=yc;yc.__name__=["haxor","context","WireCubeGizmo"];yc.__super__=O;yc.prototype=s(O.prototype,{OnBuild:function(){var a=new Ka;a.set_name("$GizmoWireCubeMesh");a.primitive=1;for(var b=[new n(-.5,-.5,
-.5),new n(-.5,-.5,.5),new n(.5,-.5,.5),new n(.5,-.5,-.5),new n(-.5,.5,-.5),new n(-.5,.5,.5),new n(.5,.5,.5),new n(.5,.5,-.5)],c=[0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,1,1,5,5,4,4,0,3,2,2,6,6,7,7,3,0,3,3,7,7,4,4,0,1,5,5,6,6,2,2,1],d=new L(3*c.length*this.m_gizmo_count),f=new L(c.length*this.m_gizmo_count),e=0,g=0,h=0,k=0,l=this.m_gizmo_count;k<l;){k++;for(var p=0,r=c.length;p<r;){var q=p++,q=c[q];d.Set(e++,b[q].x);d.Set(e++,b[q].y);d.Set(e++,b[q].z);f.Set(g++,h)}h+=1}a.Set("id",f,1);a.Set("vertex",d,
3);this.mesh=a},__class__:yc});var zc=function(){O.call(this,O.AXIS,O.MAX_GIZMOS)};k["haxor.context.AxisGizmo"]=zc;zc.__name__=["haxor","context","AxisGizmo"];zc.__super__=O;zc.prototype=s(O.prototype,{OnBuild:function(){var a=new Ka;a.set_name("$GizmoAxisMesh");a.primitive=1;for(var b=new t(.9,.3,.3,1),c=new t(.3,.9,.3,1),d=new t(.3,.3,.9,1),f=0,e=new L(6*this.m_gizmo_count),g=new L(18*this.m_gizmo_count),h=new L(18*this.m_gizmo_count),k=0,l=0,n=0,p=0,r=this.m_gizmo_count;p<r;){p++;g.Set(k++,0);
g.Set(k++,0);g.Set(k++,0);e.Set(n++,f);g.Set(k++,1);g.Set(k++,0);g.Set(k++,0);e.Set(n++,f);g.Set(k++,0);g.Set(k++,0);g.Set(k++,0);e.Set(n++,f);g.Set(k++,0);g.Set(k++,1);g.Set(k++,0);e.Set(n++,f);g.Set(k++,0);g.Set(k++,0);g.Set(k++,0);e.Set(n++,f);g.Set(k++,0);g.Set(k++,0);g.Set(k++,1);e.Set(n++,f);var q;q=b;h.Set(l++,q.r);h.Set(l++,q.g);h.Set(l++,q.b);h.Set(l++,q.a);h.Set(l++,q.r);h.Set(l++,q.g);h.Set(l++,q.b);h.Set(l++,q.a);q=c;h.Set(l++,q.r);h.Set(l++,q.g);h.Set(l++,q.b);h.Set(l++,q.a);h.Set(l++,
q.r);h.Set(l++,q.g);h.Set(l++,q.b);h.Set(l++,q.a);q=d;h.Set(l++,q.r);h.Set(l++,q.g);h.Set(l++,q.b);h.Set(l++,q.a);h.Set(l++,q.r);h.Set(l++,q.g);h.Set(l++,q.b);h.Set(l++,q.a);f+=1}a.Set("id",e,1);a.Set("vertex",g,3);a.Set("color",h,4);this.mesh=a},__class__:zc});var Bc=function(){O.call(this,O.LINE,3*O.MAX_GIZMOS)};k["haxor.context.LineGizmo"]=Bc;Bc.__name__=["haxor","context","LineGizmo"];Bc.__super__=O;Bc.prototype=s(O.prototype,{OnBuild:function(){var a=new Ka;a.set_name("$GizmoLineMesh");a.primitive=
1;for(var b=0,c=new L(2*this.m_gizmo_count),d=new L(6*this.m_gizmo_count),f=0,e=0,g=0,h=this.m_gizmo_count;g<h;)g++,d.Set(f++,0),d.Set(f++,0),d.Set(f++,0),c.Set(e++,b),d.Set(f++,1),d.Set(f++,1),d.Set(f++,1),c.Set(e++,b),b+=1;a.Set("id",c,1);a.Set("vertex",d,3);this.mesh=a},__class__:Bc});var Cc=function(){O.call(this,O.POINT,10)};k["haxor.context.PointGizmo"]=Cc;Cc.__name__=["haxor","context","PointGizmo"];Cc.__super__=O;Cc.prototype=s(O.prototype,{OnBuild:function(){var a=new Ka;a.set_name("$GizmoPointMesh");
for(var b=a.primitive=0,c=new L(this.m_gizmo_count),d=new L(3*this.m_gizmo_count),f=0,e=0,g=0,h=this.m_gizmo_count;g<h;)g++,d.Set(f++,0),d.Set(f++,0),d.Set(f++,0),c.Set(e++,b),b+=1;a.Set("id",c,1);a.Set("vertex",d,3);this.mesh=a},__class__:Cc});var Ac=function(){O.call(this,O.CANVAS,3E3);this.fill=new t(1,1,1,1);this.line=new t(0,0,0,1);this.p0=new n(0,0,0);this.p1=new n(0,0,0);this.start=new n(0,0,0);this.count=0;this.active=!1;null!=this.material&&(this.material.cull=0)};k["haxor.context.CanvasGizmo"]=
Ac;Ac.__name__=["haxor","context","CanvasGizmo"];Ac.__super__=O;Ac.prototype=s(O.prototype,{Begin:function(a,b,c){this.active||(this.fill.SetColor(a),null==b?this.line.a=0:this.line.SetColor(b),this.transform=c,this.count=0,this.active=!0)},Line:function(a){this.active&&(2<=this.count&&g.gizmo.DrawLine(this.p0,this.p1,this.line,this.transform),0>=this.count&&this.start.Set3(a),this.p1.Set3(this.p0),this.p0.Set3(a),2<=this.count&&(this.Push(this.fill,g.data.get_v4().Set(1,0,0,1),g.data.get_v4().Set3(this.start),
this.transform),this.Push(this.fill,g.data.get_v4().Set(1,0,0,1),g.data.get_v4().Set3(this.p1),this.transform),this.Push(this.fill,g.data.get_v4().Set(1,0,0,1),g.data.get_v4().Set3(this.p0),this.transform)),this.count++)},End:function(){this.active&&(g.gizmo.DrawLine(this.p0,this.start,this.line,this.transform),g.gizmo.DrawLine(this.p0,this.p1,this.line,this.transform),this.active=!1)},OnBuild:function(){var a=new Ka;a.set_name("$GizmoCanvasMesh");a.primitive=4;for(var b=0,c=new L(3*this.m_gizmo_count),
d=new L(9*this.m_gizmo_count),f=0,e=0,g=0,h=this.m_gizmo_count;g<h;)g++,d.Set(f++,0),d.Set(f++,0),d.Set(f++,0),c.Set(e++,b),b+=1,d.Set(f++,0),d.Set(f++,0),d.Set(f++,0),c.Set(e++,b),b+=1,d.Set(f++,0),d.Set(f++,0),d.Set(f++,0),c.Set(e++,b),b+=1;a.Set("id",c,1);a.Set("vertex",d,3);this.mesh=a},__class__:Ac});var dd=function(){};k["haxor.context.KernelContext"]=dd;dd.__name__=["haxor","context","KernelContext"];dd.prototype={Initialize:function(){this.list=[]},Execute:function(){for(var a=0,b=this.list.length;a<
b;){var c=a++;this.list[c].Execute()}},OnCreate:function(a){this.list.push(a)},OnDestroy:function(a){E.remove(this.list,a)},__class__:dd};var $c=function(){this.uniform_globals="ViewMatrix ProjectionMatrix WorldMatrix WorldMatrixInverse WorldMatrixIT Time RandomSeed RandomTexture ScreenTexture ScreenDepth Ambient CameraPosition ProjectionMatrixInverse ViewMatrixInverse Lights Fog CameraProjection Joints Binds".split(" ");this.mid=new Oa;this.sid=new Oa;this.uid=new Oa;this.zfunc=515;this.zwrite=this.ztest=
!0;this.blend=!1;this.blendSrc=1;this.blendDst=0;this.invert=!1;this.cull=2;this.pointSmooth=!0;this.locations=[];this.uniforms=[];this.programs=[];this.is_linked=[];this.vertex_shaders=[];this.fragment_shaders=[];this.globals=[];this.camera=[];this.transform=[];this.slot=0;this.viewmatrix=[];this.projmatrix=[];for(var a=0;1024>a;){a++;for(var b=[],c=[],d=0;512>d;)d++,b.push(-1);for(d=0;200>d;)d++,c.push(e.INVALID);this.camera.push(null);this.transform.push(null);this.globals.push([]);this.locations.push(b);
this.uniforms.push(c);this.programs.push(e.INVALID);this.is_linked.push(!1);this.vertex_shaders.push(e.INVALID);this.fragment_shaders.push(e.INVALID);this.viewmatrix.push(!1);this.projmatrix.push(!1)}};k["haxor.context.MaterialContext"]=$c;$c.__name__=["haxor","context","MaterialContext"];$c.prototype={Initialize:function(){e.m_gl.DepthFunc(515);e.m_gl.Enable(2929);e.m_gl.DepthMask(!0);e.m_gl.Disable(3042);e.m_gl.BlendFunc(1,0);e.m_gl.Enable(2884);e.m_gl.FrontFace(2305);e.m_gl.CullFace(1029);e.m_gl.Enable(3089)},
SetPointSmooth:function(a){a!=this.pointSmooth&&(this.pointSmooth=a)},UpdateFlags:function(a){a.zfunc!=this.zfunc&&(this.zfunc=a.zfunc,e.m_gl.DepthFunc(this.zfunc));a.ztest!=this.ztest&&((this.ztest=a.ztest)?e.m_gl.Enable(2929):e.m_gl.Disable(2929));a.zwrite!=this.zwrite&&(this.zwrite=a.zwrite,e.m_gl.DepthMask(this.zwrite));a.blend!=this.blend&&((this.blend=a.blend)?e.m_gl.Enable(3042):e.m_gl.Disable(3042));var b=!1;a.blendSrc!=this.blendSrc&&(b=!0,this.blendSrc=a.blendSrc);a.blendDst!=this.blendDst&&
(b=!0,this.blendDst=a.blendDst);b&&e.m_gl.BlendFunc(this.blendSrc,this.blendDst);a.invert!=this.invert&&(this.invert=a.invert,e.m_gl.FrontFace(this.invert?2304:2305));a.cull!=this.cull&&(this.cull=a.cull,0==this.cull?e.m_gl.Disable(2884):(e.m_gl.Enable(2884),e.m_gl.CullFace(1==this.cull?1028:1029)))},InitializeMaterial:function(a){this.programs[a.__cid]=e.m_gl.CreateProgram()},CompileShader:function(a){if(!J.__instanceof(a,Dc)){var b="",c="",b=this.CreateCompileShader(a,35633,this.vertex_shaders),
c=this.CreateCompileShader(a,35632,this.fragment_shaders);a.m_hasError&&(a.error="",a.error+=this.FormatShaderError("[vs]",b),a.error+=this.FormatShaderError("[fs]",c),u.LogError("Shader> Compile Error @ ["+a.get_name()+"]"),u.Log(a.error))}},CreateCompileShader:function(a,b,c){var d;d=c[a.__cid]==e.INVALID?e.m_gl.CreateShader(b):c[a.__cid];b=35633==b?a.get_vs():a.get_fs();c[a.__cid]=d;e.m_gl.ShaderSource(d,b);e.m_gl.CompileShader(d);return 0==e.m_gl.GetShaderParameter(d,35713)?(a.m_hasError=!0,e.m_gl.GetShaderInfoLog(d)):
""},FormatShaderError:function(a,b){for(var c=b.split("\n"),d="",f=0,e=c.length;f<e;){var g=f++,g=c[g];0>g.indexOf("ERROR")||(g=g.split(":"),d=5==g.length?d+(a+" "+g[2]+":"+g[3]+" : "+g[4]+"\n"):4==g.length?d+(a+" "+g[2]+":"+g[3]+"\n"):3==g.length?d+(a+" "+g[0]+":"+g[2]+"\n"):2==g.length?d+(a+" "+g[0]+":"+g[1]+"\n"):d+(a+" "+g[1]+"\n"))}return d},UpdateShader:function(a,b,c){var d=this.programs[a.__cid],f;this.is_linked[a.__cid]=!1;null!=b&&(f=this.vertex_shaders[b.__cid],b=this.fragment_shaders[b.__cid],
e.m_gl.DetachShader(d,f),e.m_gl.DetachShader(d,b));if(null!=c){f=this.vertex_shaders[c.__cid];b=this.fragment_shaders[c.__cid];e.m_gl.AttachShader(d,f);e.m_gl.AttachShader(d,b);f=g.mesh.attribs;b=0;for(var m=f.length;b<m;){var h=b++;e.m_gl.BindAttribLocation(d,h,f[h])}e.m_gl.LinkProgram(d);this.is_linked[a.__cid]=!0;0==e.m_gl.GetProgramParameter(d,35714)&&(u.LogError("Material> ["+a.get_name()+"] Link Error @ ["+c.get_name()+"]"),this.is_linked[a.__cid]=!1);c=a.m_uniforms;f=0;for(b=c.length;f<b;)m=
f++,this.CreateUniform(a,c[m]);c=0;for(f=this.locations[a.__cid].length;c<f;)b=c++,this.locations[a.__cid][b]=-1;c=this.uniform_globals.slice();f=0;for(b=g.data.get_m4().SetIdentity();f<c.length;){m=c[f];if(!this.is_linked[a.__cid])break;if(e.m_gl.GetUniformLocation(d,m)==e.INVALID)E.remove(c,m);else{switch(m){case "Fog":a.SetFloat4Array(m,[da.color.r,da.color.g,da.color.b,da.color.a,da.density,da.exp,da.start,da.end]);break;case "Lights":a.SetFloat4Array(m,P.m_buffer);break;case "Ambient":a.SetColor(m,
g.data.get_c().Set(1,1,1,1));break;case "Time":a.SetFloat(m,0);break;case "RandomSeed":a.SetFloat(m,0);break;case "RandomTexture":a.SetTexture(m,z.get_random());break;case "WorldMatrix":a.SetMatrix4(m,b);break;case "WorldMatrixInverse":a.SetMatrix4(m,b);break;case "WorldMatrixIT":a.SetMatrix4(m,b);break;case "CameraPosition":a.SetVector3(m,g.data.get_v3().Set(0,0,0));break;case "CameraProjection":a.SetVector3(m,g.data.get_v3().Set(0,0,0));break;case "ViewMatrix":a.SetMatrix4(m,b);break;case "ViewMatrixInverse":a.SetMatrix4(m,
b);break;case "ProjectionMatrix":a.SetMatrix4(m,b);break;case "ProjectionMatrixInverse":a.SetMatrix4(m,b)}f++}}this.globals[a.__cid]=c}},UpdateMaterial:function(a){},CreateUniform:function(a,b){b.__d=!0;b.exists=!0;if(this.is_linked[a.__cid]){var c=e.m_gl.GetUniformLocation(this.programs[a.__cid],b.name);this.uniforms[a.__cid][b.__cid]=c;b.exists=c!=e.INVALID}},DestroyUniform:function(a,b){null!=a&&(this.uniforms[a.__cid][b.__cid]=e.INVALID);g.material.uid.set_id(b.__cid)},GetAttribLocation:function(a){if(null==
this.current||!this.is_linked[this.current.__cid])return-1;var b=this.programs[this.current.__cid],c=this.locations[this.current.__cid][a.__cid];-1==c&&(c=e.m_gl.GetAttribLocation(b,a.m_name),0>c&&(this.locations[this.current.__cid][a.__cid]=-2));return c},Bind:function(a,b,c,d){var f=a!=this.current;this.UseMaterial(a);this.UpdateMaterialUniforms(b,c,d,f)},Unbind:function(){if(null!=this.current){for(var a=this.current.m_uniforms,b=0,c=a.length;b<c;){var d=b++;null!=a[d].texture&&(a[d].texture.__slot=
-1)}this.current=null}},UseMaterial:function(a){if(a!=this.current&&(this.Unbind(),this.current=a,null!=a)){this.slot=0;this.viewmatrix[a.__cid]=!1;this.projmatrix[a.__cid]=!1;var b=this.programs[a.__cid];this.UpdateFlags(a);this.is_linked[a.__cid]&&e.m_gl.UseProgram(b)}},UpdateMaterialUniforms:function(a,b,c,d){if(null!=this.current){this.viewmatrix[this.current.__cid]=null==b?!1:b.m_view_uniform_dirty;this.projmatrix[this.current.__cid]=null==b?!1:b.m_proj_uniform_dirty;null==a&&(a=Ea.get_root());
(d=a!=this.transform[this.current.__cid])&&null!=this.transform[this.current.__cid]&&(this.transform[this.current.__cid].m_uniform_dirty=!1);this.transform[this.current.__cid]=a;d=d||a.m_uniform_dirty;var f=b!=this.camera[this.current.__cid]&&null!=b,e=this.viewmatrix[this.current.__cid]||f,f=this.projmatrix[this.current.__cid]||f;null!=b&&(this.camera[this.current.__cid]=b);this.is_linked[this.current.__cid]&&this.SetLights(a,this.current,c);this.is_linked[this.current.__cid]&&this.UploadUniforms(d,
e,f,a,b);this.viewmatrix[this.current.__cid]=!1;this.projmatrix[this.current.__cid]=!1}},UploadUniforms:function(a,b,c,d,f){for(var e=this.current.m_uniforms,g=0,h=e.length;g<h;){var k=g++,k=e[k];this.UploadGlobalUniform(k,a,b,c,d,f);this.UploadUniform(this.current,k)}},UploadUniform:function(a,b){var c;c=this.uniforms[a.__cid][b.__cid];if(c!=e.INVALID){var d=b.__d,f=-1;if(null!=b.texture){0>b.texture.__slot&&(b.texture.__slot=f=this.slot++);var m=b.data;b.texture.__slot!=m.Get(0)&&(d=!0,m.Set(0,
b.texture.__slot));g.texture.Bind(b.texture,b.texture.__slot)}d&&this.ApplyUniform(c,b,f)}},ApplyUniform:function(a,b,c){c=b.offset;var d=b.data.m_length>c;if(b.isFloat){var f=b.data;switch(c){case 1:d?e.m_gl.Uniform1fv(a,f):e.Uniform1f(a,f.Get(0));break;case 2:d?e.m_gl.Uniform2fv(a,f):e.Uniform2f(a,f.Get(0),f.Get(1));break;case 3:d?e.m_gl.Uniform3fv(a,f):e.Uniform3f(a,f.Get(0),f.Get(1),f.Get(2));break;case 4:d?e.m_gl.Uniform4fv(a,f):e.Uniform4f(a,f.Get(0),f.Get(1),f.Get(2),f.Get(3));break;case 16:e.m_gl.UniformMatrix4fv(a,
!1,f)}}else switch(f=b.data,c){case 1:d?e.m_gl.Uniform1iv(a,f):e.Uniform1i(a,f.Get(0));break;case 2:d?e.m_gl.Uniform2iv(a,f):e.Uniform2i(a,f.Get(0),f.Get(1));break;case 3:d?e.m_gl.Uniform3iv(a,f):e.Uniform3i(a,f.Get(0),f.Get(1),f.Get(2));break;case 4:d?e.m_gl.Uniform4iv(a,f):e.Uniform4i(a,f.Get(0),f.Get(1),f.Get(2),f.Get(3))}b.__d=!1},UploadGlobalUniform:function(a,b,c,d,f,e){switch(a.name){case "Fog":a.SetFloat4Array([da.color.r,da.color.g,da.color.b,da.color.a,da.density,da.exp,da.start,da.end]);
break;case "Lights":a.SetFloat4Array(P.m_buffer);break;case "Ambient":a.SetColor(P.ambient);break;case "Time":a.SetFloat(q.m_elapsed);break;case "RandomSeed":a.SetFloat(Math.random());break;case "RandomTexture":a.SetTexture(z.get_random());break;case "WorldMatrix":b&&a.SetMatrix4(f.get_WorldMatrix());break;case "WorldMatrixInverse":b&&a.SetMatrix4(f.get_WorldMatrixInverse());break;case "WorldMatrixIT":b&&a.SetMatrix4(f.get_WorldMatrixInverse(),!0);break;case "CameraPosition":c&&a.SetVector3(e.m_entity.m_transform.get_position());
break;case "CameraProjection":c&&a.SetVector3(g.data.get_v3().Set(e.m_near,e.m_far,0));break;case "ViewMatrix":c&&a.SetMatrix4(e.m_entity.m_transform.get_WorldMatrixInverse());break;case "ViewMatrixInverse":c&&a.SetMatrix4(e.m_entity.m_transform.get_WorldMatrix());break;case "ProjectionMatrix":d&&a.SetMatrix4(function(a){e.UpdateProjection();return e.m_projectionMatrix}(this));break;case "ProjectionMatrixInverse":d&&a.SetMatrix4(function(a){e.UpdateProjection();return e.m_projectionMatrixInverse}(this))}},
SetLights:function(a,b,c){if(b.lighting&&(b=P.m_list,!(0>=b.length))){var d=c.m_bounds;c=g.data.get_v3();var f=g.data.get_v3(),e=0;ba.Center(d,c);e=Math.max(e,d.m_xMax-d.m_xMin);e=Math.max(e,d.m_yMax-d.m_yMin);e=Math.max(e,d.m_zMax-d.m_zMin);d=x.GetScale(a.get_WorldMatrix(),g.data.get_m4());e=.5*e*l.Max(d.m00,Math.max(d.m11,d.m22));a.get_WorldMatrix().Transform3x4(c);for(var d=a=0,h=b.length;d<h;){var k=d++;if(a>=P.max)break;var p=b[k];if(p.get_enabled()&&J.__instanceof(p,sb)){var k=p,q=e+.5*k.radius,
p=p.m_entity.m_transform.get_WorldMatrix();f.Set(p.m03,p.m13,p.m23);n.Distance(c,f)>q||(D.light&&(q=new t(1,1,1,.1),g.gizmo.DrawLine(c,f,q,null),ka.Point(c,3,q),ka.Point(f,3,q)),P.SetLightData(a,0,k.intensity,k.radius,k.atten,f.x,f.y,f.z,k.color.r,k.color.g,k.color.b,k.color.a),a++)}}P.SetLightData(a,-1,0,0,0,0,0,0,0,0,0,0)}},DestroyMaterial:function(a){var b=this.programs[a.__cid];null!=a.m_shader&&(e.m_gl.DetachShader(b,this.vertex_shaders[a.m_shader.__cid]),e.m_gl.DetachShader(b,this.fragment_shaders[a.m_shader.__cid]));
e.m_gl.DeleteProgram(b);g.material.mid.set_id(a.__cid);for(var b=0,c=a.m_uniforms.length;b<c;){var d=b++;this.uid.set_id(a.m_uniforms[d].__cid)}},DestroyShader:function(a){e.m_gl.DeleteShader(this.vertex_shaders[a.__cid]);e.m_gl.DeleteShader(this.fragment_shaders[a.__cid]);g.material.sid.set_id(a.__cid)},__class__:$c};var Zc=function(){this.attribs="vertex normal uv0 uv1 uv2 color weight bone".split(" ");this.aid=new Oa;this.mid=new Oa;this.buffers=[];this.activated=[];this.vao=[];this.m_auto_white=
!1;for(var a=0;32>a;)a++,this.activated.push(!1);for(a=0;512>a;)a++,this.buffers.push(e.INVALID);this.bound_element=e.INVALID};k["haxor.context.MeshContext"]=Zc;Zc.__name__=["haxor","context","MeshContext"];Zc.prototype={Initialize:function(){u.Log("MeshContext> Initialize.",3)},Create:function(a){e.VAO_ENABLED&&0>=this.mid.get_stored()&&this.vao.push(e.INVALID);a.__cid=this.mid.get_id();e.VAO_ENABLED&&(this.vao[a.__cid]=e.INVALID)},Destroy:function(a){a.Clear();e.VAO_ENABLED&&this.vao[a.__cid]!=
e.INVALID&&e.DeleteVAO(this.vao[a.__cid]);this.mid.set_id(a.__cid)},Bind:function(a){a!=this.current&&(this.Unbind(a),this.current=a,null!=this.current&&this.ActivateAttributes())},ActivateAttributes:function(){var a=!1;if(e.VAO_ENABLED){var a=!0,b=this.vao[this.current.__cid];b==e.INVALID&&(this.vao[this.current.__cid]=b=e.m_gl.CreateVAO(),a=!1);e.BindVAO(b)}for(var c,b=this.current.m_attribs,d=!1,f=0,m=b.length;f<m;){c=f++;c=b[c];var h=c._loc_;5==h&&(d=!0,this.m_auto_white=!1);if(0>h&&(h=g.material.GetAttribLocation(c),
0>h))continue;this.activated[h]||(this.activated[h]=!0,e.m_gl.EnableVertexAttrib(h));!a&&0<c.get_count()&&(e.m_gl.BindBuffer(34962,this.buffers[c.__cid]),e.m_gl.VertexAttribPointer(h,c.offset,5126,!1,0,0))}d||(this.activated[5]&&(e.m_gl.DisableVertexAttrib(5),this.activated[5]=!1),a||this.m_auto_white||(e.m_gl.VertexAttrib4f(5,1,1,1,1),this.m_auto_white=!0));!a&&this.current.m_indexed&&(c=this.current.m_topology_attrib,this.bound_element!=this.buffers[c.__cid]&&(this.bound_element=this.buffers[c.__cid],
e.m_gl.BindBuffer(34963,this.bound_element)))},Unbind:function(a){if(null!=this.current){a=this.current.m_attribs;for(var b=0,c=a.length;b<c;){var d=b++,d=a[d]._loc_;0<=d&&this.activated[d]&&(e.m_gl.DisableVertexAttrib(d),this.activated[d]=!1)}}},Draw:function(a){if(a.m_indexed)e.m_gl.DrawElements(a.primitive,a.m_topology_attrib.data.m_length,5123,0),ma.triangles+=a.m_topology_attrib.data.m_length/3|0;else{e.m_gl.DrawArrays(a.primitive,0,a.m_vcount);var b=3;1==a.primitive&&(b=2);0==a.primitive&&(b=
1);ma.triangles+=a.m_vcount/b|0}},RemoveAttrib:function(a,b){var c=this.buffers[a.__cid];c!=e.INVALID&&(e.m_gl.DeleteBuffer(c),this.buffers[a.__cid]=e.INVALID,this.aid.set_id(a.__cid),e.VAO_ENABLED&&this.vao[b.__cid]!=e.INVALID&&(e.DeleteVAO(this.vao[b.__cid]),this.vao[b.__cid]=e.INVALID))},UpdateAttrib:function(a,b,c,d){e.VAO_ENABLED&&this.vao[d.__cid]!=e.INVALID&&(e.DeleteVAO(this.vao[d.__cid]),this.vao[d.__cid]=e.INVALID);d=this.buffers[a.__cid];c=c?34963:34962;a._loc_=this.attribs.indexOf(a.m_name);
d==e.INVALID&&(d=e.m_gl.CreateBuffer(),this.buffers[a.__cid]=d);e.m_gl.BindBuffer(c,d);e.m_gl.BufferData(c,a.data,b)},__class__:Zc};var cd=function(){this.rid=new Oa;this.cid=new Oa;this.colliders=[];this.rigidbodies=[];this.rbc=[];this.crb=[];this.collider_dirty=[]};k["haxor.context.PhysicsContext"]=cd;cd.__name__=["haxor","context","PhysicsContext"];cd.prototype={Initialize:function(){this.accum_dt=0},CreateCollider:function(a){this.colliders.push(a);var b=this.cid.get_next();a.__cid=this.cid.get_id();
b>=a.__cid?(this.crb.push(null),this.collider_dirty.push(!0)):this.collider_dirty[a.__cid]=!0;this.crb[a.__cid]=a.m_entity.GetComponent(Kb);S.get_broadphase().Add(a)},OnColliderUpdate:function(a,b){this.collider_dirty[a.__cid]=!0},CreateRigidBody:function(a){this.rigidbodies.push(a);var b=this.rid.get_id();a.__cid=b;b>=this.rbc.length?this.rbc.push([]):this.rbc[b]=[];for(var c=a.m_entity.GetComponents(Ya),d=0,f=c.length;d<f;){var e=d++,e=c[e];this.rbc[b].push(e);this.crb[e.__cid]=a}},Step:function(){var a=
g.fixed_update,b=S.get_broadphase(),c=S.m_solver,d=0;c.broadphase=b;for(this.accum_dt=q.m_delta;0<=this.accum_dt&&!(5<=d);){d++;for(var b=0,f=a.m_length;b<f;){var e=b++;a.list[e].m_destroyed||a.list[e].OnFixedUpdate()}this.UpdateColliders();b=this.rigidbodies;f=0;for(e=b.length;f<e;){var h=f++;b[h].get_enabled()&&!b[h].kinematic&&(b[h].ComputeForces(),b[h].IntegrateVelocity(q.get_fixedDelta()))}f=0;for(e=c.iterations;f<e;)f++,c.Step();f=0;for(e=b.length;f<e;)h=f++,b[h].get_enabled()&&(b[h].kinematic||
b[h].IntegratePosition(q.get_fixedDelta())),b[h].ResetForces();this.accum_dt-=q.get_fixedDelta()}},UpdateColliders:function(){var a=S.get_broadphase();a.Step();for(var b=0,c=this.colliders.length;b<c;){var d=b++,d=this.colliders[d];d.get_enabled()&&(this.collider_dirty[d.__cid]&&(a.Clear(d),a.Update(d),a.Query(d)),this.collider_dirty[d.__cid]=!1)}},DestroyCollider:function(a){E.remove(this.colliders,a);this.cid.set_id(a.__cid);var b=this.crb[a.__cid];this.crb[a.__cid]=null;S.get_broadphase().Remove(a);
null!=b&&E.remove(this.rbc[b.__cid],a);S.get_broadphase().Remove(a)},DestroyRigidBody:function(a){E.remove(this.rigidbodies,a);a=this.rbc[a.__cid];for(var b=0,c=a.length;b<c;){var d=b++;this.crb[a[d].__cid]=null}},__class__:cd};var tb=function(a,b){null==b&&(b=!0);this.name=a;this.__cid=tb.m_cid;u.Log("\tProcess ["+a+"]["+this.__cid+"] created.",8);b&&tb.m_cid++};k["haxor.context.BaseProcess"]=tb;tb.__name__=["haxor","context","BaseProcess"];tb.prototype={get_length:function(){return 0},Add:function(a){},
Remove:function(a){},Clear:function(){},__class__:tb,__properties__:{get_length:"get_length"}};var hb=function(a,b,c){null==c&&(c=!0);tb.call(this,a,c);this.list=[];for(a=this.m_length=0;a<b;)a++,this.list.push(null)};k["haxor.context.Process"]=hb;hb.__name__=["haxor","context","Process"];hb.__super__=tb;hb.prototype=s(tb.prototype,{get_length:function(){return this.m_length},Add:function(a){0<=a.__pid[this.__cid]?u.Log("Process "+this.name+"> Failed to Add ["+a.get_name()+"@"+a.m_type_name+"]",7):
(this.m_length>=this.list.length&&this.list.push(null),this.list[this.m_length]=a,a.__pid[this.__cid]=this.m_length,this.m_length++)},Remove:function(a){var b=a.__pid[this.__cid];if(0>b)u.Log("Process "+this.name+"> Failed to Remove ["+a.get_name()+"@"+a.m_type_name+"]",7);else{var c=this.list[this.m_length-1];c.__pid[this.__cid]=a.__pid[this.__cid];a.__pid[this.__cid]=-1;this.list[b]=c;this.list[this.m_length-1]=a;this.m_length--}},Swap:function(a,b,c){null==c&&(c=!1);var d=a.__pid[this.__cid];if(!(0>
d)){var f=b.__pid[this.__cid];0>f||(c||(this.list[d]=b,this.list[f]=a),b.__pid[this.__cid]=d,a.__pid[this.__cid]=f)}},Clear:function(){this.m_length=0;this.list=[]},Sort:function(a){this.list.sort(a);a=0;for(var b=this.m_length;a<b;){var c=a++,d=this.list[c];null!=d&&(d.__pid[this.__cid]=c)}},ToString:function(){for(var a="",b=0,c=this.m_length;b<c;)var d=b++,d=this.list[d],a=a+("["+d.get_name()+","+d.__pid[this.__cid]+"]");return a},__class__:hb});var Yc=function(){this.rid=new Oa;this.fcid=new Oa;
this.sap=new Ec(.01,!1);this.sap_dirty=!1;this.deferred_culling=0;this.deferred_offset=100;this.display=[];this.sort=[];for(var a=0;32>a;){var b=a++,b=new hb("process.renderers",g.maxNodes,31==b);this.display.push(b);this.sort.push(!1)}};k["haxor.context.RendererContext"]=Yc;Yc.__name__=["haxor","context","RendererContext"];Yc.prototype={Initialize:function(){},Create:function(a){a.__cid=this.rid.get_id();a.m_has_mesh&&(a.__fcid=this.fcid.get_id(),this.sap.Create(a.__fcid))},UpdateSkinning:function(a,
b){var c;c=b?a.m_jt:a.m_bmt;if(null!=c){var d=c.m_data.get_buffer(),f;f=b?a.m_jf32:a.m_bmf32;for(var e=0,g=f.length;e<g;){var h=e++;d.Set(h,f[h])}c.Apply();b&&(d=c.m_width,c=c.m_height,f=0>=d?0:1/d,e=0>=c?0:1/c,a.m_material.SetTexture("Joints",a.m_jt),a.m_material.SetTexture("Binds",a.m_bmt),a.m_material.SetFloat4("SkinTexSize",d,c,f,e))}},AddCamera:function(a){a.__fcid=this.fcid.get_id();this.sap.Create(a.__fcid)},RemoveCamera:function(a){this.fcid.set_id(a.__fcid);this.sap.Remove(a.__fcid)},OnMaterialChange:function(a){this.sort[a.m_entity.m_layer]=
!0},OnMeshChange:function(a){this.sort[a.m_entity.m_layer]=!0},OnVisibilityChange:function(a,b){for(var c=a.m_entity.m_components,d=0,f=c.length;d<f;){var e=d++;c[e].OnVisibilityChange(b)}},DeferredCulling:function(a){return!1},OnLayerChange:function(a,b,c){this.sort[b]=!0;this.display[b].Remove(a);a.get_enabled()&&(this.display[c].Add(a),this.sort[c]=!0)},UpdateDisplayList:function(a){a=a.m_layers;for(var b=0,c=a.length;b<c;){var d=b++,d=a[d],f=this.display[d];this.sort[d]&&(this.sort[d]=!1,1<f.m_length&&
f.Sort(ha(this,this.DisplayListSort)))}},Enable:function(a){this.display[a.m_entity.m_layer].Add(a);this.sort[a.m_entity.m_layer]=!0;a.m_has_mesh&&(a.m_culling_dirty=!0)},Disable:function(a){this.display[a.m_entity.m_layer].Remove(a);this.sort[a.m_entity.m_layer]=!0},UpdateCameraSAP:function(a){if(this.sap_dirty||a.m_view_uniform_dirty||a.m_proj_uniform_dirty){var b=g.data.get_v3().Set4(a.m_frustum[0]),c=g.data.get_v3().Set4(a.m_frustum[1]),d=g.data.get_v3().Set4(a.m_frustum[2]),f=g.data.get_v3().Set4(a.m_frustum[3]),
e=g.data.get_v3().Set4(a.m_frustum[4]),h=g.data.get_v3().Set4(a.m_frustum[5]),k=g.data.get_v3().Set4(a.m_frustum[6]),n=g.data.get_v3().Set4(a.m_frustum[7]);a.m_entity.m_transform.get_WorldMatrix().Transform3x4(b);a.m_entity.m_transform.get_WorldMatrix().Transform3x4(c);a.m_entity.m_transform.get_WorldMatrix().Transform3x4(d);a.m_entity.m_transform.get_WorldMatrix().Transform3x4(f);a.m_entity.m_transform.get_WorldMatrix().Transform3x4(e);a.m_entity.m_transform.get_WorldMatrix().Transform3x4(h);a.m_entity.m_transform.get_WorldMatrix().Transform3x4(k);
a.m_entity.m_transform.get_WorldMatrix().Transform3x4(n);var p=g.data.get_v3().Set(b.x,b.y,b.z),b=g.data.get_v3().Set(b.x,b.y,b.z);p.x=l.Min(p.x,l.Min(c.x,Math.min(d.x,f.x)));p.y=l.Min(p.y,l.Min(c.y,Math.min(d.y,f.y)));p.z=l.Min(p.z,l.Min(c.z,Math.min(d.z,f.z)));b.x=l.Max(b.x,l.Max(c.x,Math.max(d.x,f.x)));b.y=l.Max(b.y,l.Max(c.y,Math.max(d.y,f.y)));b.z=l.Max(b.z,l.Max(c.z,Math.max(d.z,f.z)));p.x=l.Min(p.x,l.Min(e.x,l.Min(h.x,Math.min(k.x,n.x))));p.y=l.Min(p.y,l.Min(e.y,l.Min(h.y,Math.min(k.y,n.y))));
p.z=l.Min(p.z,l.Min(e.z,l.Min(h.z,Math.min(k.z,n.z))));b.x=l.Max(b.x,l.Max(e.x,l.Max(h.x,Math.max(k.x,n.x))));b.y=l.Max(b.y,l.Max(e.y,l.Max(h.y,Math.max(k.y,n.y))));b.z=l.Max(b.z,l.Max(e.z,l.Max(h.z,Math.max(k.z,n.z))));a.m_aabb.Set3(p,b);this.UpdateSAP(a.__fcid,a,p,b)}},UpdateSAP:function(a,b,c,d){this.sap_dirty=!0;this.sap.Update(a,b,c,d)},IsSAPCulled:function(a,b){return!a.m_has_mesh||a.m_culling_dirty?!1:!this.sap.Overlap(a.__fcid,b.__fcid)},Destroy:function(a){this.display[a.m_entity.m_layer].Remove(a);
this.sort[a.m_entity.m_layer]=!0;this.rid.set_id(a.__cid);a.m_has_mesh&&(this.fcid.set_id(a.__fcid),this.sap.Remove(a.__fcid))},DisplayListSort:function(a,b){if(null==a&&null==b)return 0;if(null==a)return 1;if(null==b)return-1;if(null==a.m_material&&null==b.m_material)return 0;if(null==a.m_material)return 1;if(null==b.m_material)return-1;var c=a.m_material.queue,d=b.m_material.queue;return c!=d?c<d?-1:1:a.m_has_mesh||b.m_has_mesh?a.m_has_mesh?!b.m_has_mesh||a.m_material.get_uid()<b.m_material.get_uid()?
-1:a.m_material.get_uid()>b.m_material.get_uid()?1:null==a.m_mesh&&null==b.m_mesh?0:null==a.m_mesh?1:null==b.m_mesh||a.m_mesh.get_uid()<b.m_mesh.get_uid()?-1:a.m_mesh.get_uid()>b.m_mesh.get_uid()?1:0:1:0},__class__:Yc};var ea=function(){};k["haxor.context.ShaderContext"]=ea;ea.__name__=["haxor","context","ShaderContext"];var ta=function(){this.tid=new Oa;this.target=this.bind=null;this.active=-1;this.next_slot=0;this.bind=[];this.ids=[];this.framebuffers=[];this.renderbuffers=[]};k["haxor.context.TextureContext"]=
ta;ta.__name__=["haxor","context","TextureContext"];ta.TextureToTarget=function(a){return a.get_type()==N.Texture2D||a.get_type()==N.RenderTexture?3553:a.get_type()==N.TextureCube?34067:3553};ta.FormatToChannelBits=function(a){switch(a[1]){case 0:return 6406;case 2:return 6407;case 7:case 4:return 6409;case 8:case 5:return 6407;case 1:return 6409;case 10:return 6402;case 11:return e.TEXTURE_SRGB?e.SRGB:6407;case 12:if(e.TEXTURE_SRGB)return e.SRGB_ALPHA;break;case 13:if(e.TEXTURE_SRGB)return e.SRGB8_ALPHA8}return 6408};
ta.FormatToChannelType=function(a){switch(a[1]){case 4:case 5:case 6:return e.HALF_FLOAT;case 7:case 8:case 9:return 5126;case 10:return 5123}return 5121};ta.FormatToChannelLayout=function(a){switch(a[1]){case 0:return 6406;case 2:return 6407;case 1:case 4:case 7:return 6409;case 8:case 5:return 6407;case 10:return 6402;case 11:return e.TEXTURE_SRGB?e.SRGB:6407;case 12:if(e.TEXTURE_SRGB)return e.SRGB_ALPHA;break;case 13:if(e.TEXTURE_SRGB)return e.SRGB8_ALPHA8}return 6408};ta.prototype={Initialize:function(){for(var a=
0,b=e.MAX_ACTIVE_TEXTURE;a<b;)a++,this.bind.push(null);for(a=0;2048>a;)a++,this.ids.push(e.INVALID),this.framebuffers.push(e.INVALID),this.renderbuffers.push(e.INVALID)},Alloc:function(a){var b=a.m_width,c=a.m_height,d=ta.FormatToChannelLayout(a.m_format),f=ta.FormatToChannelBits(a.m_format),m=ta.FormatToChannelType(a.m_format),g;g=a.get_type()==N.Texture2D?3553:a.get_type()==N.RenderTexture?3553:a.get_type()==N.TextureCube?34067:3553;this.Bind(a);e.m_gl.TexImage2DAlloc(g,0,d,b,c,0,f,m)},Create:function(a){a.__slot=
-1;var b=e.m_gl.CreateTexture();this.ids[a.__cid]=b;this.UpdateParameters(a);a.get_type()!=N.TextureCube&&this.Alloc(a);if(a.get_type()==N.RenderTexture){var c=e.m_gl.CreateFramebuffer();this.framebuffers[a.__cid]=c;e.m_gl.BindFramebuffer(36160,c);e.m_gl.FramebufferTexture2D(36160,36064,3553,b,0);null!=a.m_depth?e.m_gl.FramebufferTexture2D(36160,36096,3553,this.ids[a.m_depth.__cid],0):(b=e.m_gl.CreateRenderbuffer(),this.renderbuffers[a.__cid]=b,e.m_gl.BindRenderbuffer(36161,b),e.m_gl.RenderbufferStorage(36161,
33189,a.m_width,a.m_height),e.m_gl.FramebufferRenderbuffer(36160,36096,36161,b));e.BindFramebuffer(36160,e.NULL);e.BindRenderbuffer(36161,e.NULL);this.Unbind()}},Bind:function(a,b){null==b&&(b=-1);0>b?this.ApplyBind(a,!1):this.bind[b]!=a&&(this.active!=b&&(e.m_gl.ActiveTexture(33984+b),this.active=b),this.ApplyBind(a,!0))},ApplyBind:function(a,b){if(this.bound!=a||b){this.bind[this.active]=a;var c=this.ids[a.__cid],d;d=a.get_type()==N.Texture2D?3553:a.get_type()==N.RenderTexture?3553:a.get_type()==
N.TextureCube?34067:3553;e.m_gl.BindTexture(d,c);this.bound=a}},Unbind:function(){null!=this.bound&&(this.bound=null,e.BindTexture(3553,e.NULL))},BindTarget:function(a){null==a?this.target!=a&&(e.BindFramebuffer(36160,e.NULL),e.BindRenderbuffer(36161,e.NULL),this.target=null):this.target!=a&&(e.m_gl.BindFramebuffer(36160,this.framebuffers[a.__cid]),null==a.m_depth&&e.m_gl.BindRenderbuffer(36161,this.renderbuffers[a.__cid]),this.target=a)},UpdateParameters:function(a){var b;b=a.get_type()==N.Texture2D?
3553:a.get_type()==N.RenderTexture?3553:a.get_type()==N.TextureCube?34067:3553;this.Bind(a);e.m_gl.TexParameteri(b,10242,0!=(a.m_wrap&Da.ClampX)?33071:10497);e.m_gl.TexParameteri(b,10243,0!=(a.m_wrap&Da.ClampY)?33071:10497);e.TEXTURE_ANISOTROPY_ENABLED&&e.TexParameterf(b,e.TEXTURE_ANISOTROPY,Math.max(1,a.m_aniso));var c=a.m_minFilter,d=a.m_magFilter,f=!1;a.m_format==y.Half&&(f=!0);a.m_format==y.Half3&&(f=!0);a.m_format==y.Half4&&(f=!0);var m=!1;a.m_format==y.Float&&(m=!0);a.m_format==y.Float3&&(m=
!0);a.m_format==y.Float4&&(m=!0);f&&!e.TEXTURE_HALF_LINEAR&&(d=c=V.Nearest);m&&!e.TEXTURE_FLOAT_LINEAR&&(d=c=V.Nearest);switch(c[1]){case 0:e.m_gl.TexParameteri(b,10241,9728);break;case 3:e.m_gl.TexParameteri(b,10241,9986);break;case 2:e.m_gl.TexParameteri(b,10241,9984);break;case 1:e.m_gl.TexParameteri(b,10241,9729);break;case 5:e.m_gl.TexParameteri(b,10241,9987);break;case 6:e.m_gl.TexParameteri(b,10241,9987);break;case 4:e.m_gl.TexParameteri(b,10241,9985)}switch(d[1]){case 0:e.m_gl.TexParameteri(b,
10240,9728);break;case 3:e.m_gl.TexParameteri(b,10240,9728);break;case 2:e.m_gl.TexParameteri(b,10240,9728);break;case 1:e.m_gl.TexParameteri(b,10240,9729);break;case 5:e.m_gl.TexParameteri(b,10240,9729);break;case 6:e.m_gl.TexParameteri(b,10240,9729);break;case 4:e.m_gl.TexParameteri(b,10240,9729)}},Update:function(a){var b;b=a.get_type()==N.Texture2D?3553:a.get_type()==N.RenderTexture?3553:a.get_type()==N.TextureCube?34067:3553;this.Bind(a);34067==b?(null!=a.m_faces[0]&&this.WriteTexture(34069,
a.m_faces[0]),null!=a.m_faces[1]&&this.WriteTexture(34070,a.m_faces[1]),null!=a.m_faces[2]&&this.WriteTexture(34071,a.m_faces[2]),null!=a.m_faces[3]&&this.WriteTexture(34072,a.m_faces[3]),null!=a.m_faces[4]&&this.WriteTexture(34073,a.m_faces[4]),null!=a.m_faces[5]&&this.WriteTexture(34074,a.m_faces[5])):this.WriteTexture(b,a)},UploadTexture:function(a,b,c,d,f,m,g){var h=this,k=a.m_data,l=c,n=ta.FormatToChannelLayout(a.m_format);ta.FormatToChannelBits(a.m_format);var p=ta.FormatToChannelType(a.m_format),
q=f/m|0;1>=q&&(q=1);new ja(function(c){if(l>=f)return null!=g&&g(),!1;h.Bind(a);for(c=0;c<q;){c++;if(!(0>l)){if(l>=k.m_height)return null!=g&&g(),!1;var m=(b+l*d)*k.m_channels,r=d*k.m_channels;k.get_buffer().SetViewSlice(m,r);e.TexSubImage2D(3553,0,b,l,d,1,n,p,k.get_buffer());k.get_buffer().ResetSlice()}l++}return!0},!1,!0)},WriteTexture:function(a,b){var c=b.m_width,d=b.m_height,f=ta.FormatToChannelLayout(b.m_format),m=ta.FormatToChannelBits(b.m_format),g=ta.FormatToChannelType(b.m_format);b.m_format==
y.Depth?e.m_gl.TexImage2DAlloc(a,0,f,c,d,0,f,g):b.get_type()==N.Compute||b.get_type()==N.Texture2D?e.TexImage2D(a,0,f,c,d,0,m,g,b.m_data.get_buffer()):b.get_type()==N.RenderTexture&&e.m_gl.FramebufferTexture2D(36160,36064,a,this.ids[b.__cid],0)},CrossToCubemap:function(a,b){var c=this;a.get_type()!=N.Texture2D&&a.get_type()!=N.RenderTexture&&a.get_type();var d=ta.FormatToChannelLayout(a.m_format),f=ta.FormatToChannelBits(a.m_format),m=ta.FormatToChannelType(a.m_format),g=[1,4,5,6,7,9],h=[34072,34070,
34073,34069,34074,34071],k=b.m_width/4,l=b.m_height/3,n=b.m_data.m_channels*b.m_data.get_buffer().get_bytesPerElement(),p=k*n;ja.RunOnce(function(){c.Bind(a);for(var q=0,r=g.length;q<r;){var s=q++,t=g[s],s=h[s],t=t%4*k+(t/4|0)*l*b.m_width;e.m_gl.TexImage2DAlloc(s,0,d,k,l,0,f,m);for(var u=0;u<l;){var v=u++;b.m_data.get_buffer().SetViewSlice(t*n,p);e.TexSubImage2D(s,0,0,l-1-v,k,1,d,m,b.m_data.get_buffer());b.m_data.get_buffer().ResetSlice();t+=b.m_width}}},!1,!0)},UpdateMipmaps:function(a){this.Bind(a);
a=a.get_type()==N.Texture2D?3553:a.get_type()==N.RenderTexture?3553:a.get_type()==N.TextureCube?34067:3553;e.m_gl.GenerateMipmap(a)},Destroy:function(a){var b=this.ids[a.__cid];b!=e.INVALID&&e.m_gl.DeleteTexture(b);if(a.get_type()==N.RenderTexture){var b=this.framebuffers[a.__cid],c=this.renderbuffers[a.__cid];b!=e.INVALID&&e.m_gl.DeleteFramebuffer(b);c!=e.INVALID&&e.m_gl.DeleteRenderbuffer(c)}g.texture.tid.set_id(a.__cid)},__class__:ta};var bd=function(){this.tid=new Oa};k["haxor.context.TransformContext"]=
bd;bd.__name__=["haxor","context","TransformContext"];bd.prototype={Initialize:function(){},OnChange:function(a){a.m_uniform_dirty=!0;a=a.m_entity.m_components;for(var b=0,c=a.length;b<c;){var d=b++;a[d].OnTransformUpdate(!1)}},OnHierarchyChange:function(a){a=a.m_entity.m_components;for(var b=0,c=a.length;b<c;){var d=b++;a[d].OnTransformUpdate(!0)}},__class__:bd};var Oa=function(){this.m_id=0;this.m_cache=[]};k["haxor.context.UID"]=Oa;Oa.__name__=["haxor","context","UID"];Oa.prototype={get_id:function(){return 0>=
this.m_cache.length?this.m_id++:this.m_cache.shift()},set_id:function(a){this.m_cache.push(a);return a},get_stored:function(){return this.m_cache.length},get_next:function(){return this.m_id},__class__:Oa,__properties__:{get_next:"get_next",get_stored:"get_stored",set_id:"set_id",get_id:"get_id"}};var r=function(){};k["haxor.core.Asset"]=r;r.__name__=["haxor","core","Asset"];r.__properties__={get_progress:"get_progress"};r.get_progress=function(){for(var a=0,b=0,c=r.m_load_progress.keys();c.hasNext();)var d=
c.next(),a=r.m_load_progress.exists(d)?a+r.m_load_progress.get(d):a+0,b=b+1;return 0>=b?0:a/b};r.Get=function(a){return r.m_database.exists(a)?r.m_database.get(a):null};r.Remove=function(a){if(r.m_database.exists(a)){var b=r.m_database.get(a);r.m_database.remove(a);return b}return null};r.Add=function(a,b){r.m_database.set(a,b);J.__instanceof(b,v)&&(J.__cast(b,v).__db=a)};r.LoadTexture2D=function(a,b){r.m_load_progress.set(a,0);ya.LoadTexture2D(b,!0,function(b,d){r.UpdateProgress(a,d,b)})};r.LoadTextureCubeCross=
function(a,b){r.m_load_progress.set(a,0);ya.LoadTextureCubeCross(b,!0,function(b,d){r.UpdateProgress(a,d,b)})};r.LoadCollada=function(a,b){ya.LoadCollada(b,function(b,d){r.UpdateProgress(a,d,b)})};r.LoadShader=function(a,b){ya.LoadShader(b,function(b,d){r.UpdateProgress(a,d,b)})};r.LoadMaterial=function(a,b){ya.LoadMaterial(b,function(b,d){r.UpdateProgress(a,d,b)})};r.Instantiate=function(a){return a.Clone()};r.UpdateProgress=function(a,b,c){var d=Za.m_instance;r.m_load_progress.set(a,b);d.OnLoadProgress(a,
b);if(1<=b&&(r.Add(a,c),d.OnLoadComplete(a,c),1<=r.get_progress())){for(a=r.m_database.keys();a.hasNext();)b=a.next(),c=r.m_database.get(b),J.__instanceof(c,bc)&&r.Add(b,c.get_asset());Za.m_instance.LoadComplete()}};var X={__ename__:!0,__constructs__:"Unknown Windows Linux Android MacOS iOS HTML NodeJS".split(" "),Unknown:["Unknown",0]};X.Unknown.toString=A;X.Unknown.__enum__=X;X.Windows=["Windows",1];X.Windows.toString=A;X.Windows.__enum__=X;X.Linux=["Linux",2];X.Linux.toString=A;X.Linux.__enum__=
X;X.Android=["Android",3];X.Android.toString=A;X.Android.__enum__=X;X.MacOS=["MacOS",4];X.MacOS.toString=A;X.MacOS.__enum__=X;X.iOS=["iOS",5];X.iOS.toString=A;X.iOS.__enum__=X;X.HTML=["HTML",6];X.HTML.toString=A;X.HTML.__enum__=X;X.NodeJS=["NodeJS",7];X.NodeJS.toString=A;X.NodeJS.__enum__=X;var xa={__ename__:!0,__constructs__:["None","File","HTTP","HTTPS"],None:["None",0]};xa.None.toString=A;xa.None.__enum__=xa;xa.File=["File",1];xa.File.toString=A;xa.File.__enum__=xa;xa.HTTP=["HTTP",2];xa.HTTP.toString=
A;xa.HTTP.__enum__=xa;xa.HTTPS=["HTTPS",3];xa.HTTPS.toString=A;xa.HTTPS.__enum__=xa;var u=function(){};k["haxor.core.Console"]=u;u.__name__=["haxor","core","Console"];u.Initialize=function(){var a={log:function(a){}};try{u.m_console=console}catch(b){u.m_console=a}};u.Breakpoint=function(){debugger};u.Log=function(a,b){null==b&&(b=0);u.verbose>=b&&u.m_console.log(a)};u.LogImage=function(a,b){u.m_console.log("%c                                                                                                                                                            ",
"background: transparent url("+a+") no-repeat; font-size: "+(b-3)+"px;")};u.LogWarning=function(a,b){null==u.m_console&&console.log("[W] "+a);null==b&&(b=[]);switch(b.length){case 0:u.m_console.warn(a);break;case 1:u.m_console.warn(a,b[0]);break;case 2:u.m_console.warn(a,b[0],b[1]);break;case 3:u.m_console.warn(a,b[0],b[1],b[2]);break;case 4:u.m_console.warn(a,b[0],b[1],b[2],b[3])}};u.LogError=function(a,b){if(null==u.m_console)console.log("[E] "+a);else switch(null==b&&(b=[]),b.length){case 0:u.m_console.error(a);
break;case 1:u.m_console.error(a,b[0]);break;case 2:u.m_console.error(a,b[0],b[1]);break;case 3:u.m_console.error(a,b[0],b[1],b[2]);break;case 4:u.m_console.error(a,b[0],b[1],b[2],b[3])}};u.ClearStyle=function(){u.m_style=""};u.Clear=function(){null!=u.m_console&&u.m_console.clear()};u.TimeStart=function(a){null!=u.m_console&&u.m_console.time(a)};u.TimeEnd=function(a){null!=u.m_console&&u.m_console.timeEnd(a)};u.StackTrace=function(){null!=u.m_console&&u.m_console.trace()};u.SetStyle=function(a,b,
c,d){null==d&&(d="'Lucida Console', Monaco, monospace");null==c&&(c="rgba(255,255,255,0)");null==b&&(b="rgba(0,0,0,1)");null==a&&(a="12px");u.m_style="background-color: "+c+"; font-size: "+a+"; color: "+b+"; font-family: "+d+";"};var D=function(){};k["haxor.core.Debug"]=D;D.__name__=["haxor","core","Debug"];D.Initialize=function(){D.collider=!1;D.colliderAABB=!1;D.colliderSB=!1;D.transform=!1;D.renderer=!1;D.rendererAABB=!1;D.light=!1};D.Collider=function(a){var b=a.m_entity.m_transform.get_WorldMatrix(),
c=g.data.get_v3().Set(),d;d=a.trigger?D.color_trigger:D.color_collider;a.get_enabled()?d.a=1:d.a=.01;switch(a.get_type()[1]){case 2:c.Set3(a.m_center);ka.WireCube(c,a.m_size,d,b);break;case 3:var f=g.data.get_v3().Set(.5773507,.5773507,.5773507);x.GetScale(b,g.data.get_m4()).Transform3x3(f);c.Set3(a.m_center);ka.WireSphere(c,Math.sqrt(f.x*f.x+f.y*f.y+f.z*f.z)*a.get_radius(),d,b)}};D.BoundingAABB=function(a){ka.WireCube(a.get_center(),(new n(0,0,0)).Set(l.Abs(a.m_xMax-a.m_xMin),l.Abs(a.m_yMax-a.m_yMin),
l.Abs(a.m_zMax-a.m_zMin)),D.color_bounding)};D.BoundingSphere=function(a){ka.WireSphere(g.data.get_v3().Set(a.x,a.y,a.z),a.w,D.color_bounding)};D.MeshRenderer=function(a){var b=a.m_mesh.m_bounds,c=g.data.get_c().SetColor(D.color_renderer);c.a=a.m_visible&&!a.m_culled?1:.2;ka.WireCube(b.get_center(),(new n(0,0,0)).Set(l.Abs(b.m_xMax-b.m_xMin),l.Abs(b.m_yMax-b.m_yMin),l.Abs(b.m_zMax-b.m_zMin)),c,a.m_entity.m_transform.get_WorldMatrix());D.rendererAABB&&(b=a.m_aabb,c=g.data.get_c().SetColor(D.color_bounding),
c.a=a.m_visible&&!a.m_culled?1:.2,ka.WireCube(b.get_center(),(new n(0,0,0)).Set(l.Abs(b.m_xMax-b.m_xMin),l.Abs(b.m_yMax-b.m_yMin),l.Abs(b.m_zMax-b.m_zMin)),c))};D.Transform=function(a){ka.Axis(g.data.get_v3().Set(),g.data.get_v3().Set(.5,.5,.5),D.color_white,a.get_WorldMatrix())};D.Camera=function(a){D.Transform(a.m_entity.m_transform);D.Transform(a.m_entity.m_transform.m_parent);for(var b=a.m_frustum,c=[],d=0,f=b.length;d<f;){var e=d++;c.push(g.data.get_v4().Set4(b[e]));a.m_entity.m_transform.get_WorldMatrix().Transform4x4(c[e])}b=
c;a=g.data.get_v3();c=g.data.get_v3();a.Set4(b[0]);c.Set4(b[1]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[1]);c.Set4(b[2]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[2]);c.Set4(b[3]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[3]);c.Set4(b[0]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[4]);c.Set4(b[5]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[5]);c.Set4(b[6]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[6]);c.Set4(b[7]);g.gizmo.DrawLine(a,c,D.color_white,
null);a.Set4(b[7]);c.Set4(b[4]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[0]);c.Set4(b[4]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[1]);c.Set4(b[5]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[2]);c.Set4(b[6]);g.gizmo.DrawLine(a,c,D.color_white,null);a.Set4(b[3]);c.Set4(b[7]);g.gizmo.DrawLine(a,c,D.color_white,null)};D.Light=function(a){var b=g.data.get_c();if(J.__instanceof(a,sb)){var c=a.m_entity.m_transform.get_position();b.SetColor(D.color_light);a.get_enabled()?b.a=1:b.a=
.33;ka.WireSphere(c,a.radius,b);b.SetColor(a.color);a.get_enabled()?b.a=1:b.a=.33;ka.Point(c,15,a.color)}};var ub={__ename__:!0,__constructs__:["Play","Editor"],Play:["Play",0]};ub.Play.toString=A;ub.Play.__enum__=ub;ub.Editor=["Editor",1];ub.Editor.toString=A;ub.Editor.__enum__=ub;var Ja=function(){};k["haxor.core.Engine"]=Ja;Ja.__name__=["haxor","core","Engine"];Ja.Initialize=function(){u.Log("Haxor> Engine Initialize.",3);g.Initialize();Ja.state=ub.Play};Ja.Collect=function(){for(var a=g.disposables,
b=0,c=g.collectRate;b<c;){b++;if(0>=a.m_length)break;var d=a.list[0];d.OnDestroy();a.Remove(d)}};Ja.Update=function(){if(Ja.state!=ub.Editor){var a,b;a=g.awake;b=0;for(var c=a.length;b<c;){b++;var d=a.shift();d.OnAwake();d.m_is_awake=!0}a=g.start;for(b=0;b<a.length;)c=a[b++],c.get_enabled()&&c.m_is_awake&&(c.OnStart(),c.m_is_start=!0,E.remove(a,c),b--);a=g.update;b=0;for(c=a.m_length;b<c;){var d=b++,f=a.list[d];if(null!=f&&!f.m_destroyed){if(f.m_is_behaviour){if(!f.m_is_awake)continue;if(!f.m_is_start)continue}a.list[d].OnUpdate()}}sa.Update();
g.physics.Step()}};Ja.Render=function(){Pa.Render();Ja.RenderIRenderers();Pa.RenderFinish()};Ja.RenderIRenderers=function(){for(var a=g.render,b=0,c=a.m_length;b<c;){var d=b++;a.list[d].m_destroyed||a.list[d].OnRender()}};Ja.Resize=function(){Pa.Resize();if(Ja.state!=ub.Editor)for(var a=g.resize,b=0,c=a.m_length;b<c;){var d=b++;a.list[d].m_destroyed||a.list[d].OnResize(H.m_width,H.m_height)}};var wa=function(a){null==a&&(a="");v.call(this,a);this.m_enabled=!0;this.m_components=[];this.m_layer=1;this.m_transform=
this.AddComponent(Ea)};k["haxor.core.Entity"]=wa;wa.__name__=["haxor","core","Entity"];wa.__super__=v;wa.prototype=s(v.prototype,{get_enabled:function(){return this.m_enabled&&!this.m_destroyed},set_enabled:function(a){if(this.m_destroyed)return!1;if(this.m_enabled==a)return a;this.m_enabled=a;for(var b=0,c=this.m_components.length;b<c;){var d=b++,d=this.m_components[d];d.m_is_behaviour&&d.set_enabled(a)}return a},get_transform:function(){return this.m_transform},get_camera:function(){return this.GetComponent(U)},
get_data:function(){return this.GetComponent(Yb)},get_animation:function(){return this.GetComponent(sa)},get_renderer:function(){return this.GetComponent(va)},get_rigidbody:function(){return this.GetComponent(Kb)},get_layer:function(){return this.m_layer},set_layer:function(a){0>=a&&(a=1);if(this.m_layer==a)return a;var b=this.m_layer;this.m_layer=a;g.OnEntiyLayerChange(this,b,this.m_layer);return this.m_layer},AddComponent:function(a){if(this.m_destroyed)return null;if(null!=this.m_transform&&a==
Ea)return this.m_transform;var b=null,b=ib.createInstance(a,[""]);if(null==b)return null;b.m_entity=this;b.m_is_behaviour&&b.set_enabled(this.m_enabled&&!this.m_destroyed);b.OnBuild();this.m_components.push(b);return b},GetComponent:function(a){for(var b=0,c=this.m_components.length;b<c;){var d=b++;if(J.__instanceof(this.m_components[d],a))return this.m_components[d]}return null},GetComponents:function(a){for(var b=[],c=0,d=this.m_components.length;c<d;){var f=c++;J.__instanceof(this.m_components[f],
a)&&b.push(this.m_components[f])}return b},GetComponentInChildren:function(a){var b=null;this.m_transform.Traverse(function(c,d){if(null!=b)return!0;var f=c.m_entity.GetComponents(a);0<f.length&&(b=f[0]);return!0});return b},GetComponentsInChildren:function(a){var b=[];this.m_transform.Traverse(function(c,d){for(var f=c.m_entity.GetComponents(a),e=0,g=f.length;e<g;){var h=e++;b.push(f[h])}return!0});return b},OnDestroy:function(){for(var a=0,b=this.m_components.length;a<b;){var c=a++;this.m_components[c].OnDestroy()}this.m_components=
null},__class__:wa,__properties__:s(v.prototype.__properties__,{set_layer:"set_layer",get_layer:"get_layer",get_rigidbody:"get_rigidbody",get_renderer:"get_renderer",get_animation:"get_animation",get_data:"get_data",get_camera:"get_camera",get_transform:"get_transform",set_enabled:"set_enabled",get_enabled:"get_enabled"})});var cc=function(){};k["haxor.core.RenderQueue"]=cc;cc.__name__=["haxor","core","RenderQueue"];var db=function(){};k["haxor.core.BlendMode"]=db;db.__name__=["haxor","core","BlendMode"];
var ed=function(){};k["haxor.core.MeshMode"]=ed;ed.__name__=["haxor","core","MeshMode"];var Eb=function(){};k["haxor.core.MeshPrimitive"]=Eb;Eb.__name__=["haxor","core","MeshPrimitive"];var fd=function(){};k["haxor.core.CullMode"]=fd;fd.__name__=["haxor","core","CullMode"];var vb=function(){};k["haxor.core.DepthTest"]=vb;vb.__name__=["haxor","core","DepthTest"];var La={__ename__:!0,__constructs__:["Custom","Perspective","Ortho","UI"],Custom:["Custom",0]};La.Custom.toString=A;La.Custom.__enum__=La;
La.Perspective=["Perspective",1];La.Perspective.toString=A;La.Perspective.__enum__=La;La.Ortho=["Ortho",2];La.Ortho.toString=A;La.Ortho.__enum__=La;La.UI=["UI",3];La.UI.toString=A;La.UI.__enum__=La;var y={__ename__:!0,__constructs__:"Alpha8 Luminance RGB8 RGBA8 Half Half3 Half4 Float Float3 Float4 Depth sRGB sRGBA sRGBA8".split(" "),Alpha8:["Alpha8",0]};y.Alpha8.toString=A;y.Alpha8.__enum__=y;y.Luminance=["Luminance",1];y.Luminance.toString=A;y.Luminance.__enum__=y;y.RGB8=["RGB8",2];y.RGB8.toString=
A;y.RGB8.__enum__=y;y.RGBA8=["RGBA8",3];y.RGBA8.toString=A;y.RGBA8.__enum__=y;y.Half=["Half",4];y.Half.toString=A;y.Half.__enum__=y;y.Half3=["Half3",5];y.Half3.toString=A;y.Half3.__enum__=y;y.Half4=["Half4",6];y.Half4.toString=A;y.Half4.__enum__=y;y.Float=["Float",7];y.Float.toString=A;y.Float.__enum__=y;y.Float3=["Float3",8];y.Float3.toString=A;y.Float3.__enum__=y;y.Float4=["Float4",9];y.Float4.toString=A;y.Float4.__enum__=y;y.Depth=["Depth",10];y.Depth.toString=A;y.Depth.__enum__=y;y.sRGB=["sRGB",
11];y.sRGB.toString=A;y.sRGB.__enum__=y;y.sRGBA=["sRGBA",12];y.sRGBA.toString=A;y.sRGBA.__enum__=y;y.sRGBA8=["sRGBA8",13];y.sRGBA8.toString=A;y.sRGBA8.__enum__=y;var V={__ename__:!0,__constructs__:"Nearest Linear NearestMipmapNearest NearestMipmapLinear LinearMipmapNearest LinearMipmapLinear Trilinear".split(" "),Nearest:["Nearest",0]};V.Nearest.toString=A;V.Nearest.__enum__=V;V.Linear=["Linear",1];V.Linear.toString=A;V.Linear.__enum__=V;V.NearestMipmapNearest=["NearestMipmapNearest",2];V.NearestMipmapNearest.toString=
A;V.NearestMipmapNearest.__enum__=V;V.NearestMipmapLinear=["NearestMipmapLinear",3];V.NearestMipmapLinear.toString=A;V.NearestMipmapLinear.__enum__=V;V.LinearMipmapNearest=["LinearMipmapNearest",4];V.LinearMipmapNearest.toString=A;V.LinearMipmapNearest.__enum__=V;V.LinearMipmapLinear=["LinearMipmapLinear",5];V.LinearMipmapLinear.toString=A;V.LinearMipmapLinear.__enum__=V;V.Trilinear=["Trilinear",6];V.Trilinear.toString=A;V.Trilinear.__enum__=V;var Da=function(){};k["haxor.core.TextureWrap"]=Da;Da.__name__=
["haxor","core","TextureWrap"];var N={__ename__:!0,__constructs__:["None","Texture2D","TextureCube","RenderTexture","Compute"],None:["None",0]};N.None.toString=A;N.None.__enum__=N;N.Texture2D=["Texture2D",1];N.Texture2D.toString=A;N.Texture2D.__enum__=N;N.TextureCube=["TextureCube",2];N.TextureCube.toString=A;N.TextureCube.__enum__=N;N.RenderTexture=["RenderTexture",3];N.RenderTexture.toString=A;N.RenderTexture.__enum__=N;N.Compute=["Compute",4];N.Compute.toString=A;N.Compute.__enum__=N;var Xa=function(){};
k["haxor.core.ClearFlag"]=Xa;Xa.__name__=["haxor","core","ClearFlag"];var R={__ename__:!0,__constructs__:["None","Down","Up","Hold"],None:["None",0]};R.None.toString=A;R.None.__enum__=R;R.Down=["Down",1];R.Down.toString=A;R.Down.__enum__=R;R.Up=["Up",2];R.Up.toString=A;R.Up.__enum__=R;R.Hold=["Hold",3];R.Hold.toString=A;R.Hold.__enum__=R;var ra={__ename__:!0,__constructs__:["Clamp","Loop","Oscilate"],Clamp:["Clamp",0]};ra.Clamp.toString=A;ra.Clamp.__enum__=ra;ra.Loop=["Loop",1];ra.Loop.toString=A;
ra.Loop.__enum__=ra;ra.Oscilate=["Oscilate",2];ra.Oscilate.toString=A;ra.Oscilate.__enum__=ra;var Y={__ename__:!0,__constructs__:"Point Plane Box Sphere Capsule Mesh".split(" "),Point:["Point",0]};Y.Point.toString=A;Y.Point.__enum__=Y;Y.Plane=["Plane",1];Y.Plane.toString=A;Y.Plane.__enum__=Y;Y.Box=["Box",2];Y.Box.toString=A;Y.Box.__enum__=Y;Y.Sphere=["Sphere",3];Y.Sphere.toString=A;Y.Sphere.__enum__=Y;Y.Capsule=["Capsule",4];Y.Capsule.toString=A;Y.Capsule.__enum__=Y;Y.Mesh=["Mesh",5];Y.Mesh.toString=
A;Y.Mesh.__enum__=Y;var na={__ename__:!0,__constructs__:["Acceleration","Force","Impulse","Velocity"],Acceleration:["Acceleration",0]};na.Acceleration.toString=A;na.Acceleration.__enum__=na;na.Force=["Force",1];na.Force.toString=A;na.Force.__enum__=na;na.Impulse=["Impulse",2];na.Impulse.toString=A;na.Impulse.__enum__=na;na.Velocity=["Velocity",3];na.Velocity.toString=A;na.Velocity.__enum__=na;var Ba={__ename__:!0,__constructs__:["Auto","Bone1","Bone2","Bone3","Bone4"],Auto:["Auto",0]};Ba.Auto.toString=
A;Ba.Auto.__enum__=Ba;Ba.Bone1=["Bone1",1];Ba.Bone1.toString=A;Ba.Bone1.__enum__=Ba;Ba.Bone2=["Bone2",2];Ba.Bone2.toString=A;Ba.Bone2.__enum__=Ba;Ba.Bone3=["Bone3",3];Ba.Bone3.toString=A;Ba.Bone3.__enum__=Ba;Ba.Bone4=["Bone4",4];Ba.Bone4.toString=A;Ba.Bone4.__enum__=Ba;var $=function(){};k["haxor.core.ShaderFeature"]=$;$.__name__=["haxor","core","ShaderFeature"];var Sb=function(){};k["haxor.core.ShaderPrecision"]=Sb;Sb.__name__=["haxor","core","ShaderPrecision"];var wc=function(){};k["haxor.core.IFixedUpdateable"]=
wc;wc.__name__=["haxor","core","IFixedUpdateable"];wc.prototype={__class__:wc};var Jd=function(){};k["haxor.core.ILateUpdateable"]=Jd;Jd.__name__=["haxor","core","ILateUpdateable"];Jd.prototype={__class__:Jd};var Pa=function(){};k["haxor.core.RenderEngine"]=Pa;Pa.__name__=["haxor","core","RenderEngine"];Pa.Render=function(){ma.BeginRender();Pa.RenderCameras()};Pa.RenderCameras=function(){for(var a=g.camera.list,b=0,c=a.length;b<c;){var d=b++,d=U.m_current=a[d];Pa.RenderCamera(d)}};Pa.RenderCamera=
function(a){if(a.get_enabled()){g.camera.Bind(a);for(var b=a.m_layers,c=0,d=b.length;c<d;){var f=c++;Pa.RenderCameraLayer(b[f],a)}a==U.m_main&&g.gizmo.Render();g.camera.Unbind(a)}};Pa.RenderCameraLayer=function(a,b){for(var c=g.renderer.display[a],d=0,f=c.m_length;d<f;){var e=d++,e=c.list[e];0==(e.m_entity.m_layer&a)||U.SAPCulling&&g.renderer.IsSAPCulled(e,b)||Pa.RenderRenderer(e)}};Pa.RenderRenderer=function(a){a.UpdateCulling();ma.visible++;a.OnRender()};Pa.RenderFinish=function(){for(var a=g.camera.list,
b=0,c=a.length;b<c;){var d=b++;a[d].m_view_uniform_dirty=!1;a[d].m_proj_uniform_dirty=!1}g.renderer.sap_dirty=!1;g.kernel.Execute();g.material.Unbind();g.mesh.Unbind()};Pa.Resize=function(){g.camera.Resize()};var ma=function(){};k["haxor.core.RenderStats"]=ma;ma.__name__=["haxor","core","RenderStats"];ma.__properties__={get_total:"get_total"};ma.get_total=function(){return ma.visible+ma.culled};ma.Initialize=function(){ma.visible=0;ma.culled=0;ma.triangles=0;ma.renderers=0};ma.BeginRender=function(){ma.visible=
0;ma.culled=0;ma.triangles=0;ma.renderers=g.renderer.rid.get_next()};var gd=function(a){v.call(this,a)};k["haxor.core.Scene"]=gd;gd.__name__=["haxor","core","Scene"];gd.__super__=v;gd.prototype=s(v.prototype,{__class__:gd});var q=function(){};k["haxor.core.Time"]=q;q.__name__=["haxor","core","Time"];q.__properties__={get_frame:"get_frame",get_ups:"get_ups",get_fps:"get_fps",get_elapsed:"get_elapsed",set_fixedDelta:"set_fixedDelta",get_fixedDelta:"get_fixedDelta",get_frameDelta:"get_frameDelta",get_delta:"get_delta",
get_clock:"get_clock",get_system:"get_system"};q.get_system=function(){return q.m_system-q.m_clock_0};q.get_clock=function(){return q.m_clock};q.get_delta=function(){return q.m_delta};q.get_frameDelta=function(){return q.m_frame_delta};q.get_fixedDelta=function(){return q.m_fixedDelta};q.set_fixedDelta=function(a){return q.m_fixedDelta=a};q.get_elapsed=function(){return q.m_elapsed};q.get_fps=function(){return q.m_fps};q.get_ups=function(){return q.m_ups};q.get_frame=function(){return q.m_frame};
q.Initialize=function(){q.m_system=0;q.m_clock_0=0;q.m_clock_0=q.m_system-q.m_clock_0;q.m_clock=q.m_system-q.m_clock_0;q.m_clock_dt=0;q.m_start_clock=q.m_clock;q.m_last_clock=q.m_clock;q.m_last_frame_clock=q.m_clock;q.m_stats_clock=q.m_clock;q.m_elapsed=0;q.m_delta=0;q.m_frame_delta=0;q.m_ups=0;q.m_fps=0;q.m_updates=0;q.m_frame_count=0;q.m_frame=0;q.m_fixedDelta=.01};q.Update=function(){q.m_clock=q.m_system-q.m_clock_0;q.m_clock_dt=q.m_clock-q.m_last_clock;0>=q.m_clock_dt&&(q.m_clock_dt=1);q.m_last_clock=
q.m_clock;q.m_delta=.001*q.m_clock_dt;q.m_delta=.1<q.m_delta?.1:0>=q.m_delta?.01:q.m_delta;q.m_elapsed+=q.m_delta;q.m_updates+=1;1E3<=q.m_clock-q.m_stats_clock&&(q.m_stats_clock+=q.m_clock-q.m_stats_clock,q.m_ups=q.m_updates,q.m_fps=q.m_frame_count,q.m_updates=0,q.m_frame_count=0,u.Log("FPS: "+q.m_fps,7))};q.Render=function(){q.m_frame_count+=1;q.m_frame++;q.m_frame_delta=.001*(q.m_clock-q.m_last_frame_clock);q.m_frame_delta=.1<q.m_frame_delta?.1:0>=q.m_frame_delta?.01:q.m_frame_delta;q.m_clock>q.m_last_frame_clock&&
(q.m_last_frame_clock=q.m_clock)};var ca=function(a,b,c,d,f,e){null==f&&(f=0);null==d&&(d=.3);v.call(this);null==ca.m_table&&(ca.m_table=new lb);this.m_target=a;this.m_property=b;this.m_value=c;this.m_delay=f;this.m_elapsed=0<this.m_delay?-this.m_delay:0;this.m_duration=d;this.m_added=this.m_active=!1;this.m_easing=null==e?function(a){return a}:e;ca.m_table.exists(this.m_target)||ca.m_table.set(this.m_target,[])};k["haxor.core.Tween"]=ca;ca.__name__=["haxor","core","Tween"];ca.__interfaces__=[$a];
ca.Add=function(a,b,c,d,f,e){null==f&&(f=0);null==d&&(d=.3);a=new ca(a,b,c,d,f,e);a.Run();return a};ca.Cancel=function(a,b){null==b&&(b="");if(ca.m_table.exists(a))for(var c=ca.m_table.get(a),d=0,f=c.length;d<f;){var e=d++,e=c[e];""!=b&&e.m_property!=b||e.Remove()}};ca.GetTweens=function(a,b,c){null==c&&(c=!1);null==b&&(b="");var d=[];if(null==a)for(a=ca.m_table.iterator();a.hasNext();){b=a.next();c=0;for(var f=b.length;c<f;){var e=c++;d.push(b[e])}}else{if(!ca.m_table.exists(a))return[];for(var f=
ca.m_table.get(a),e=0,g=f.length;e<g;){var h=e++,h=f[h];if(null==a||h.m_target==a)if(""==b||h.m_property==b)c&&0>h.m_elapsed||d.push(h)}}return d};ca.__super__=v;ca.prototype=s(v.prototype,{Run:function(){this.m_active=!0;this.m_added||(g.update.Add(this),this.m_added=!0,ca.m_table.get(this.m_target).push(this))},Pause:function(){this.m_active=!1},Stop:function(){this.m_elapsed=-this.m_delay;this.m_active=!1},Remove:function(){this.m_added&&(g.update.Remove(this),this.m_added=!1);this.m_active=!1;
var a=ca.m_table.get(this.m_target);E.remove(a,this)},OnUpdate:function(){if(this.m_active)if(0>=this.m_elapsed){if(this.m_elapsed+=q.m_delta,0<=this.m_elapsed){for(var a=ca.GetTweens(this.m_target,this.m_property,!0),b=0,c=a.length;b<c;){var d=b++;a[d]!=this&&a[d].Remove()}this.m_start=Qa.getProperty(this.m_target,this.m_property)}}else if(a=l.Clamp01(0>=this.m_duration?1:this.m_elapsed/this.m_duration),this.Sample(a),this.m_elapsed+=q.m_delta,this.m_elapsed>=this.m_duration){this.Sample(1);if(null!=
this.oncomplete)this.oncomplete();this.Remove()}},Sample:function(a){a=this.m_easing(a);"number"==typeof this.m_value?Qa.setProperty(this.m_target,this.m_property,l.Lerp(this.m_start,this.m_value,a)):J.__instanceof(this.m_value,t)?Qa.setProperty(this.m_target,this.m_property,t.Lerp(this.m_start,this.m_value,a)):J.__instanceof(this.m_value,F)?Qa.setProperty(this.m_target,this.m_property,F.Lerp(this.m_start,this.m_value,a)):J.__instanceof(this.m_value,Md)?Qa.setProperty(this.m_target,this.m_property,
l.LerpInt(this.m_start,this.m_value,a)):J.__instanceof(this.m_value,K)?Qa.setProperty(this.m_target,this.m_property,K.Lerp(this.m_start,this.m_value,a)):J.__instanceof(this.m_value,n)?Qa.setProperty(this.m_target,this.m_property,n.Lerp(this.m_start,this.m_value,a)):J.__instanceof(this.m_value,Q)&&Qa.setProperty(this.m_target,this.m_property,Q.Lerp(this.m_start,this.m_value,a))},__class__:ca});var eb=function(a,b){null==b&&(b="");v.call(this,b);this.m_layout=new hd(this);this.m_rotation=this.m_height=
this.m_width=this.m_py=this.m_px=this.m_y=this.m_x=0;this.m_sy=this.m_sx=1;this.m_mouseEnabled=!0;this.m_globalAlpha=this.m_alpha=1;this.m_visible=this.m_globalVisible=!0;this.m_parent=null;this.set_element(a);""==b?this.set_name(this.m_type_name+this.get_uid()):this.set_name(b)};k["haxor.dom.DOMEntity"]=eb;eb.__name__=["haxor","dom","DOMEntity"];eb.__super__=v;eb.prototype=s(v.prototype,{get_x:function(){return this.m_x},set_x:function(a){this.m_x=a;this.UpdateTransform();return a},get_y:function(){return this.m_y},
set_y:function(a){this.m_y=a;this.UpdateTransform();return a},get_px:function(){return this.m_px},set_px:function(a){this.m_px=a;this.UpdateTransform();return a},get_py:function(){return this.m_py},set_py:function(a){this.m_py=a;this.UpdateTransform();return a},get_width:function(){return this.m_width},set_width:function(a){this.m_width=Math.max(0,a);this.UpdateRect();return this.m_width},get_height:function(){return this.m_height},set_height:function(a){this.m_height=Math.max(0,a);this.UpdateRect();
return this.m_height},get_sx:function(){return this.m_sx},set_sx:function(a){this.m_sx=a;this.UpdateTransform();return a},get_sy:function(){return this.m_sy},set_sy:function(a){this.m_sy=a;this.UpdateTransform();return a},get_rotation:function(){return this.m_rotation},set_rotation:function(a){this.m_rotation=a;this.UpdateTransform();return a},get_mouseX:function(){return null==this.get_parent()?p.mouse.x:this.get_parent().get_mouseX()-this.m_x},get_mouseY:function(){return null==this.get_parent()?
p.mouse.y:this.get_parent().get_mouseY()-this.get_y()},get_rect:function(){var a=this.get_layout().get_margin();return new Ca(w["int"](this.m_x-this.m_px+a.get_xMin()),w["int"](this.m_y-this.m_py+a.get_yMin()),w["int"](this.m_width-(a.get_xMin()+a.get_xMax())),w["int"](this.m_height-(a.get_yMin()+a.get_yMax())))},get_alpha:function(){return this.m_alpha},set_alpha:function(a){this.m_alpha=a;this.UpdateMaterial();return a},get_visible:function(){return this.m_visible},set_visible:function(a){this.m_visible=
a;this.UpdateMaterial();return a},get_mouseEnabled:function(){return this.m_mouseEnabled},set_mouseEnabled:function(a){this.m_mouseEnabled=a;null!=this.m_element&&this.m_element.style.setProperty("pointer-events",a?"auto":"none","");return a},get_layout:function(){return this.m_layout},get_parent:function(){return this.m_parent},get_stage:function(){return T.m_instance},set_name:function(a){v.prototype.set_name.call(this,a);null!=this.m_element&&this.m_element.setAttribute("name",a);return a},get_element:function(){return this.m_element},
set_element:function(a){if(this.m_element==a)return a;var b=this.m_element;this.get_stage()!=this&&null!=b&&(b.parentElement.replaceChild(a,b),b.remove());this.m_element=b=a;this.get_stage()!=this&&null!=b&&(b.style.position="absolute",b.style.left=b.style.top="0px",b.setAttribute("script",this.m_type_name),b.setAttribute("name",this.get_name()));return b},UpdateMaterial:function(){if(this.get_stage()!=this){var a;a=null==this.get_parent()?1:this.get_parent().m_globalAlpha;var b;b=null==this.get_parent()?
!0:this.get_parent().m_globalVisible;var c=this.m_element;a=0>a||0>this.m_alpha;this.m_globalAlpha=l.Clamp01(this.m_alpha)*l.Clamp01(this.m_alpha);a&&(this.m_globalAlpha=-this.m_globalAlpha);this.m_globalVisible=this.m_visible&&b&&!a;c.style.opacity=this.m_globalAlpha+"";c.style.display=this.m_globalVisible?"block":"none"}},UpdateRect:function(){if(this.get_stage()!=this){var a=this.m_element,b=this.get_layout().m_margin;this.get_layout().Update();a.style.width=w["int"](this.m_width-(b.get_xMin()+
b.get_xMax()))+"px";a.style.height=w["int"](this.m_height-(b.get_yMin()+b.get_yMax()))+"px";this.OnRepaint()}},UpdateTransform:function(){if(this.get_stage()!=this){var a=this.m_element,b=this.get_layout().m_margin;this.get_layout().Update();var c=l.Floor(this.m_x-this.m_px+b.get_xMin()),b=l.Floor(this.m_y-this.m_py+b.get_yMin()),d=c+this.m_px,f=b+this.m_py,e=this.get_application().get_vendor(),g=a.style.getPropertyValue(e+"transform-origin");""!=g&&null!=g&&a.style.removeProperty(e+"transform-origin");
a.style.cssText=a.style.cssText+" "+e+"transform-origin: "+d+"px "+f+"px;";a.style.setProperty(e+"transform","rotate3d(0,0,1,"+this.m_rotation+"deg) scale3d("+this.m_sx+","+this.m_sy+",1.0) translate3d("+c+"px,"+b+"px,0px)","")}},OnRepaint:function(){},OnAdded:function(){},OnAddedToStage:function(){},OnRemoved:function(){},AddedToStage:function(){this.m_added_stage||(this.m_added_stage=!0,this.OnAddedToStage())},__class__:eb,__properties__:s(v.prototype.__properties__,{set_element:"set_element",get_element:"get_element",
get_stage:"get_stage",get_parent:"get_parent",get_layout:"get_layout",set_mouseEnabled:"set_mouseEnabled",get_mouseEnabled:"get_mouseEnabled",set_visible:"set_visible",get_visible:"get_visible",set_alpha:"set_alpha",get_alpha:"get_alpha",get_rect:"get_rect",get_mouseY:"get_mouseY",get_mouseX:"get_mouseX",set_rotation:"set_rotation",get_rotation:"get_rotation",set_sy:"set_sy",get_sy:"get_sy",set_sx:"set_sx",get_sx:"get_sx",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width",
set_py:"set_py",get_py:"get_py",set_px:"set_px",get_px:"get_px",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"})});var Ga=function(a,b){null==b&&(b="");this.m_children=[];var c;c=null==a?window.document.createElement("div"):a;eb.call(this,c,b)};k["haxor.dom.Container"]=Ga;Ga.__name__=["haxor","dom","Container"];Ga.DOMPath=function(a){for(var b=[];null!=a;){if(a.hasAttribute("script")){if(0<=a.getAttribute("script").toLowerCase().indexOf("stage"))break;b.push(a.getAttribute("name"))}a=a.parentElement}b.reverse();
return b.join(".")};Ga.__super__=eb;Ga.prototype=s(eb.prototype,{get_childCount:function(){return null==this.m_children?0:this.m_children.length},IsChild:function(a){if(null==this.m_children)return!1;for(var b=0,c=this.m_children;b<c.length;){var d=c[b];++b;if(d==a)return!0}return!1},Parse:function(a){a=a.children;for(var b=1,c=a.length;b<c;){var d=b++,d=a.item(d);T.BuildStep(d,this)}b=0;for(c=a.length;b<c;)if(d=b++,d=a.item(d),null!=d)switch(d.nodeName.toLowerCase()){case "container":d.remove();
break;case "sprite":d.remove()}},AddChild:function(a){this.AddChildAt(a)},AddChildAt:function(a,b){null==b&&(b=-1);if(a!=this&&!this.IsChild(a)){null!=a.get_parent()&&a.get_parent().RemoveChild(a);var c;c=0>b?this.m_children.length:b;this.m_children.push(a);this.m_element.appendChild(a.m_element);a.m_parent=this;this.SetChildIndex(a,c);this.UpdateTransform();this.UpdateRect();this.UpdateMaterial();null==this.get_stage()&&T.m_instance!=this||this.AddedToStage()}},RemoveChild:function(a){this.IsChild(a)&&
(E.remove(this.m_children,a),this.m_element.removeChild(a.m_element),a.m_parent=null)},GetChildByName:function(a){for(var b=0,c=this.m_children.length;b<c;){var d=b++;if(this.m_children[d].get_name()==a)return this.m_children[d]}return null},GetChildAt:function(a){return this.m_children[a]},GetChildIndex:function(a){for(var b=0,c=this.m_children.length;b<c;){var d=b++;if(this.m_children[d]==a)return d}return-1},SetChildIndex:function(a,b){if(this.IsChild(a)){var c=l.ClampInt(b,0,this.m_children.length-
1);if(a!=this.m_children[c]){var d=this.m_children[c].m_element;this.m_element.removeChild(a.m_element);this.m_element.insertBefore(a.m_element,d);E.remove(this.m_children,a);this.m_children.splice(c,0,a)}}},Find:function(a){a=a.split(".");if(0>=a.length)return null;for(var b=this,c=0,d=a.length;c<d;){var f=c++,b=b.GetChildByName(a[f]);if(!J.__instanceof(b,Ga)&&f>=a.length-1)break}return b},Traverse:function(a){this.TraverseStep(0,this,a)},TraverseStep:function(a,b,c){if((null==c||c(a,b))&&J.__instanceof(b,
Ga))for(var d=0,f=b.m_children.length;d<f;){var e=d++;this.TraverseStep(a+1,b.m_children[e],c)}},UpdateMaterial:function(){eb.prototype.UpdateMaterial.call(this);for(var a=0,b=this.m_children.length;a<b;){var c=a++;this.m_children[c].UpdateMaterial()}},UpdateTransform:function(){eb.prototype.UpdateTransform.call(this);for(var a=0,b=this.m_children.length;a<b;){var c=a++;this.m_children[c].UpdateTransform()}},UpdateRect:function(){eb.prototype.UpdateRect.call(this);for(var a=0,b=this.m_children.length;a<
b;){var c=a++;this.m_children[c].UpdateRect()}},AddedToStage:function(){eb.prototype.AddedToStage.call(this);for(var a=0,b=this.m_children.length;a<b;){var c=a++;this.m_children[c].AddedToStage()}},__class__:Ga,__properties__:s(eb.prototype.__properties__,{get_childCount:"get_childCount"})});var hd=function(a){this.m_element=a;this.m_lock=!1;this.m_margin=Ca.get_empty();this.m_x=this.m_y=0;this.m_height=this.m_width=1;this.m_py=this.m_px=0};k["haxor.dom.DOMLayout"]=hd;hd.__name__=["haxor","dom","DOMLayout"];
hd.prototype={get_px:function(){return this.m_px},set_px:function(a){this.m_px=a;0!=(this.m_flag&Z.PivotX)&&this.Update();return a},get_py:function(){return this.m_py},set_py:function(a){this.m_py=a;0!=(this.m_flag&Z.PivotY)&&this.Update();return a},get_x:function(){return this.m_x},set_x:function(a){this.m_x=a;0!=(this.m_flag&Z.PositionX)&&this.Update();return a},get_y:function(){return this.m_y},set_y:function(a){this.m_y=a;0!=(this.m_flag&Z.PositionY)&&this.Update();return a},get_width:function(){return this.m_width},
set_width:function(a){this.m_width=a;0!=(this.m_flag&Z.SizeX)&&this.Update();return a},get_height:function(){return this.m_height},set_height:function(a){this.m_height=a;0!=(this.m_flag&Z.SizeY)&&this.Update();return a},get_flag:function(){return this.m_flag},set_flag:function(a){this.m_flag=a;this.Update();return a},get_margin:function(){return this.m_margin.get_clone()},set_margin:function(a){this.m_margin.SetAABB2(a);this.m_element.UpdateTransform();return a},Set:function(a,b,c,d,f){this.m_flag=
a;this.m_px=b;this.m_py=c;this.m_x=d;this.m_y=f;this.Update()},FitSize:function(){this.m_height=this.m_width=1;this.set_flag(Z.SizeXY)},FitWidth:function(){this.set_width(1);this.set_flag(this.m_flag|Z.SizeX)},FitHeight:function(){this.set_height(1);this.set_flag(this.m_flag|Z.SizeY)},Update:function(){if(!this.m_lock){this.m_lock=!0;var a=this.m_element.get_parent(),b;b=null==a?0:a.get_width()-a.get_layout().get_margin().get_xMin()-a.get_layout().get_margin().get_xMax();a=null==a?0:a.get_height()-
a.get_layout().get_margin().get_yMin()-a.get_layout().get_margin().get_yMax();0!=(this.m_flag&Z.PositionX)&&this.m_element.set_x(b*this.m_x);0!=(this.m_flag&Z.PositionY)&&this.m_element.set_y(a*this.m_y);0!=(this.m_flag&Z.PivotX)&&this.m_element.set_px(this.m_element.get_width()*this.m_px);0!=(this.m_flag&Z.PivotY)&&this.m_element.set_py(this.m_element.get_height()*this.m_py);0!=(this.m_flag&Z.SizeX)&&this.m_element.set_width(b*this.m_width);0!=(this.m_flag&Z.SizeY)&&this.m_element.set_height(a*this.m_height);
this.m_lock=!1}},__class__:hd,__properties__:{set_margin:"set_margin",get_margin:"get_margin",set_flag:"set_flag",get_flag:"get_flag",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x",set_py:"set_py",get_py:"get_py",set_px:"set_px",get_px:"get_px"}};var T=function(a){T.m_instance=this;Ga.call(this,a,"stage");g.resize.Add(this)};k["haxor.dom.DOMStage"]=T;T.__name__=["haxor","dom","DOMStage"];T.__interfaces__=
[Qb];T.BuildStep=function(a,b){var c=null;if(null==a)return!1;if(null!=b){switch(a.nodeName.toLowerCase()){case "container":c=T.BuildContainer(a);break;case "sprite":c=T.BuildSprite(a)}if(null!=c)b.AddChild(c);else if(null!=b.m_element&&null==a.getAttribute("script")&&b.m_element!=a)return b.m_element.appendChild(a),!0}if(J.__instanceof(c,Ga))for(var d=a.children,f=0;f<d.length;){var e=d.item(f);T.BuildStep(e,c)&&f--;f++}return!1};T.BuildSprite=function(a){var b=T._ss(a.getAttribute("src")),c=null!=
a.getAttribute("canvas"),d=null!=a.getAttribute("pattern"),b=new Fc(b,c);b.set_pattern(d);T.BuildDOMEntity(a,b);return b};T.BuildContainer=function(a){var b=new Ga;T.BuildDOMEntity(a,b);return b};T.BuildDOMEntity=function(a,b){var c;c=a.getAttribute("name");null!=c&&""!=c&&b.set_name(T._ss(c));c=a.getAttribute("style");null!=c&&""!=c&&(b.m_element.style.cssText=c);null!=b.m_element&&(b.m_element.style.position="absolute");var d=T._tv(a.getAttribute("px"),a.getAttribute("py"),a.getAttribute("pxy")),
f=T._tv(a.getAttribute("x"),a.getAttribute("y"),a.getAttribute("xy")),e=T._tv(a.getAttribute("sx"),a.getAttribute("sy"),a.getAttribute("sxy"),1,1),g=T._tv(a.getAttribute("w"),a.getAttribute("h"),a.getAttribute("wh"));c=[0];var h;b.set_sx(e[2]);b.set_sy(e[3]);e=d;h=Z.PivotX;d=Z.PivotY;if(0<e[0]){var k=b.get_layout();k.set_flag(k.m_flag|h);b.get_layout().set_px(e[2])}else b.set_px(e[2]);0<e[1]?(h=b.get_layout(),h.set_flag(h.m_flag|d),b.get_layout().set_py(e[3])):b.set_py(e[3]);e=f;h=Z.PositionX;d=Z.PositionY;
0<e[0]?(f=b.get_layout(),f.set_flag(f.m_flag|h),b.get_layout().set_x(e[2])):b.set_x(e[2]);0<e[1]?(f=b.get_layout(),f.set_flag(f.m_flag|d),b.get_layout().set_y(e[3])):b.set_y(e[3]);e=g;h=Z.SizeX;d=Z.SizeY;0<e[0]?(g=b.get_layout(),g.set_flag(g.m_flag|h),b.get_layout().set_width(e[2])):b.set_width(e[2]);0<e[1]?(g=b.get_layout(),g.set_flag(g.m_flag|d),b.get_layout().set_height(e[3])):b.set_height(e[3]);T._sn(a.getAttribute("alpha"),c,1);b.set_alpha(c[0]);T._sn(a.getAttribute("rotation"),c,0);b.set_rotation(c[0]);
c=a.getAttribute("margin");null!=c&&""!=c&&(c=c.split(" "),e=b.get_layout().m_margin,g=0,1==c.length?(g=w.parseFloat(c[0]),e.Set(g,g,g,g)):(1<=c.length&&(g=w.parseFloat(c[0]),e.set_xMin(g)),2<=c.length&&(g=w.parseFloat(c[1]),e.set_xMax(g)),3<=c.length&&(g=w.parseFloat(c[2]),e.set_yMin(g)),4<=c.length&&(g=w.parseFloat(c[3]),e.set_yMax(g))),b.get_layout().set_margin(e))};T._tv=function(a,b,c,d,f){null==f&&(f=0);null==d&&(d=0);var e=[0,0,0,0],g=[0],h=!1,k=!1;if(null!=c){var n=c.split(" ");1==n.length&&
(h=h||T._sn(n[0],g),k=k||h,e[2]=g[0],e[3]=g[0]);2<=n.length&&(h=h||T._sn(n[0],g),e[2]=g[0],k=k||T._sn(n[1],g),e[3]=g[0])}else null!=a&&(h=h||T._sn(a,g),e[2]=g[0]),null!=b&&(k=k||T._sn(b,g),e[3]=g[0]);null==c&&null==a&&(e[2]=d);null==c&&null==b&&(e[3]=f);h&&(1E-6>=l.Abs(e[2])?e[2]=0:e[2]/=100);k&&(1E-6>=l.Abs(e[3])?e[3]=0:e[3]/=100);e[0]=h?1:0;e[1]=k?1:0;return e};T._sn=function(a,b,c){if(null==a)return b[0]=c,!1;c=!1;0<=a.indexOf("%")&&(c=!0,a=B.replace(a,"%",""));b[0]=w.parseFloat(a);return c};T._ss=
function(a){return null==a?"":0==a.indexOf("@")?r.Get(E.substr(a,1,null)):a};T.__super__=Ga;T.prototype=s(Ga.prototype,{set_width:function(a){return a},set_height:function(a){return a},OnResize:function(a,b){this.m_width=a;this.m_height=b;this.UpdateRect()},__class__:T});var Z=function(){};k["haxor.dom.LayoutFlag"]=Z;Z.__name__=["haxor","dom","LayoutFlag"];var Fc=function(a,b,c){null==c&&(c="");null==b&&(b=!1);this.m_pattern=!1;this.m_slices=[];this.m_src="";var d=null;b&&(d=window.document.createElement("canvas"),
d.style.position="absolute",this._rc=d.getContext("2d"));b=new Image;""!=a&&(b.src=this.m_src=a,b.style.backgroundImage="url("+this.m_src+")",b.style.backgroundRepeat="repeat",this.set_image(b));null==d&&(d=b);Ga.call(this,d,c)};k["haxor.dom.Sprite"]=Fc;Fc.__name__=["haxor","dom","Sprite"];Fc.__super__=Ga;Fc.prototype=s(Ga.prototype,{get_slices:function(){return this.m_slices.slice()},set_slices:function(a){this.m_slices=null==a?a=[]:a.slice();this.OnRepaint();return a},get_image:function(){return this.m_image},
set_image:function(a){var b=this;if(this.m_image==a)return a;this.m_image=a;this.m_image.onload=function(){0>=b.get_width()&&b.set_width(b.m_image.naturalWidth);0>=b.get_height()&&b.set_height(b.m_image.naturalHeight);b.m_image.onload=null};0>=this.get_width()&&this.set_width(this.m_image.naturalWidth);0>=this.get_height()&&this.set_height(this.m_image.naturalHeight);if(null==this.m_image)return a;this.OnRepaint();return a},set_pattern:function(a){if(this.m_pattern==a)return a;this.m_pattern=a;this.OnRepaint();
return a},get_pattern:function(){return this.m_pattern},OnRepaint:function(){Ga.prototype.OnRepaint.call(this);if(null!=this.m_image&&null!=this.m_element)if(null==this._rc)this.m_pattern?(this.m_image.src="",this.m_image.style.backgroundImage="url("+this.m_src+")",this.m_image.style.backgroundRepeat="repeat"):(this.m_image.src=this.m_src,this.m_image.style.removeProperty("background-image"));else{var a=this.m_element;a.width=this.m_width-(this.get_layout().get_margin().get_xMin()+this.get_layout().get_margin().get_xMax());
a.height=this.m_height-(this.get_layout().get_margin().get_yMin()+this.get_layout().get_margin().get_yMax());if(this.m_pattern){var b=this._rc.createPattern(this.m_image,"repeat");this._rc.rect(0,0,a.width,a.height);this._rc.fillStyle=b;this._rc.fill()}else this.DrawSlicedImage(this._rc,this.m_image,a.width,a.height,this.m_slices)}},DrawSlicedImage:function(a,b,c,d,f){if(null!=b){null==f&&(f=[]);c=a.canvas;var e=b.naturalWidth,g=b.naturalHeight,h=c.width,k=c.height;c=0>=f.length?0:f[0];c=Math.min(c,
h/2);d=0>=f.length?0:1>=f.length?f[0]:f[1];d=Math.min(d,h/2);var l;l=0>=f.length?0:1>=f.length?f[0]:f[2];l=Math.min(l,k/2);f=0>=f.length?0:1>=f.length?f[0]:f[3];f=Math.min(f,k/2);var n=c,p=l,q=c,r=Math.max(1,e-c-d),s=l,t=Math.max(1,e-d),u=d,v=l,w=l,z=c,x=Math.max(1,g-l-f),y=c,A=l,B=Math.max(1,e-c-d),C=Math.max(1,g-l-f),D=Math.max(1,e-d),E=l,F=d,G=Math.max(1,g-l-f),H=Math.max(1,g-f),I=c,J=f,K=c,L=Math.max(1,g-f),M=Math.max(1,e-c-d),N=f,e=Math.max(1,e-d),g=Math.max(1,g-f),O=d,P=f,Q=c,R=l,S=c,T=Math.max(0,
h-c-d),U=l,V=Math.max(0,h-d),W=d,X=l,Y=l,Z=c,$=Math.max(0,k-l-f),aa=c,ba=l,ca=Math.max(0,h-c-d),da=Math.max(0,k-l-f),ea=Math.max(0,h-d),fa=l,ga=d,ha=Math.max(0,k-l-f),ia=Math.max(0,k-f),ja=c,ka=f,la=c,ma=Math.max(0,k-f),na=Math.max(0,h-c-d),pa=f,h=Math.max(0,h-d),k=Math.max(0,k-f),qa=d,ra=f;0<c&&0<l&&a.drawImage(b,0,0,n,p,0,0,Q,R);0<l&&a.drawImage(b,q,0,r,s,S,0,T,U);0<d&&0<l&&a.drawImage(b,t,0,u,v,V,0,W,X);0<c&&a.drawImage(b,0,w,z,x,0,Y,Z,$);a.drawImage(b,y,A,B,C,aa,ba,ca,da);0<d&&a.drawImage(b,D,
E,F,G,ea,fa,ga,ha);0<c&&0<f&&a.drawImage(b,0,H,I,J,0,ia,ja,ka);0<f&&a.drawImage(b,K,L,M,N,la,ma,na,pa);0<d&&0<f&&a.drawImage(b,e,g,O,P,h,k,qa,ra)}},__class__:Fc,__properties__:s(Ga.prototype.__properties__,{set_pattern:"set_pattern",get_pattern:"get_pattern",set_image:"set_image",get_image:"get_image",set_slices:"set_slices",get_slices:"get_slices"})});var id=function(a,b,c){null==c&&(c=!1);this.m_mirror=c;this.m_table=[];var d;d=c?0:a;for(var f=0;f<a;){f++;var e=[];this.m_table.push(e);for(var g=
0;g<d;)g++,e.push(b);c&&d++}};k["haxor.ds.PairTable"]=id;id.__name__=["haxor","ds","PairTable"];id.prototype={get_mirror:function(){return this.m_mirror},get_rows:function(){return this.m_table.length},get_cols:function(){return this.m_table.length},Get:function(a,b){return this.get_mirror()?this.m_table[Math.max(a,b)][Math.min(a,b)]:this.m_table[a][b]},Set:function(a,b,c){this.get_mirror()?this.m_table[Math.max(a,b)][Math.min(a,b)]=c:this.m_table[a][b]=c},Line:function(a){return this.m_table[a]},
Iterate:function(a){for(var b=0,c=this.m_table.length;b<c;)for(var d=b++,f=this.m_table[d],e=0,g=f.length;e<g;){var h=e++;a(h,d,f[h])}},__class__:id,__properties__:{get_cols:"get_cols",get_rows:"get_rows",get_mirror:"get_mirror"}};var Kd=function(a,b){null==b&&(b=0);this.m_type=a;this.m_top=0;this.m_list=[];for(var c=0;c<b;)c++,this.Generate()};k["haxor.ds.Pool"]=Kd;Kd.__name__=["haxor","ds","Pool"];Kd.prototype={Get:function(){0>=this.m_top&&this.Generate();return this.m_list[--this.m_top]},Put:function(a){this.m_list[this.m_top++]=
a},Generate:function(){var a=ib.createInstance(this.m_type,[]);this.m_list.unshift(a);this.m_top++},__class__:Kd};var Ec=function(a,b){null==b&&(b=!0);null==a&&(a=0);this.m_has_query=b;this.x=new dc(a,this.m_has_query);this.y=new dc(a,this.m_has_query);this.z=new dc(a,this.m_has_query)};k["haxor.ds.SAP"]=Ec;Ec.__name__=["haxor","ds","SAP"];Ec.prototype={Create:function(a){this.x.Create(a);this.y.Create(a);this.z.Create(a)},Update:function(a,b,c,d){this.x.Update(a,b,c.x,d.x);this.y.Update(a,b,c.y,
d.y);this.z.Update(a,b,c.z,d.z)},Remove:function(a){this.x.Remove(a);this.y.Remove(a);this.z.Remove(a)},Overlap:function(a,b){var c,d;c=this.x.list[a];d=this.x.list[b];if(!c.Overlap(d))return!1;c=this.y.list[a];d=this.y.list[b];if(!c.Overlap(d))return!1;c=this.z.list[a];d=this.z.list[b];return c.Overlap(d)?!0:!1},Query:function(a,b){if(this.m_has_query){var c,d,f,e;c=this.x.list[a];d=this.y.list[a];f=this.z.list[a];for(e=c.next;null!=e;)e.Overlap(c)&&this.y.list[e.id].Overlap(d)&&this.z.list[e.id].Overlap(f)&&
null!=b&&b(c.data,e.data),e=e.next;for(e=c.prev;null!=e;)e.Overlap(c)&&this.y.list[e.id].Overlap(d)&&this.z.list[e.id].Overlap(f)&&null!=b&&b(c.data,e.data),e=e.prev}},__class__:Ec};var dc=function(a,b){null==b&&(b=!0);null==a&&(a=0);this.list=[];for(var c=0;1E3>c;)c++,this.list.push(null);this.m_has_query=b;this.m_bias=a};k["haxor.ds.SAPList"]=dc;dc.__name__=["haxor","ds","SAPList"];dc.prototype={Create:function(a){for(;this.list.length<=a;)this.list.push(null);null==this.list[a]&&(this.list[a]=
new jd)},Update:function(a,b,c,d){this.list[a].id=a;this.list[a].data=b;b=(d-c)*this.m_bias*.5;this.list[a].Set(c-b,d+b);this.m_has_query&&this.RelocateInterval(this.list[a])},AddInterval:function(a){if(null==this.start)this.start=a,a.next=a.prev=null;else if(a!=this.start)for(var b=this.start;null!=b;){if(a.min<b.min){this.InsertInterval(a,b);break}if(null==b.next){this.InsertInterval(a,b);break}b=b.next}},InsertInterval:function(a,b){a!=b&&(a.min>b.min?(a.next=b.next,a.prev=b,b.next=a,null!=a.next&&
(a.next.prev=a)):(a.next=b,a.prev=b.prev,b.prev=a,null!=a.prev&&(a.prev.next=a),b==this.start&&(this.start=a)))},RelocateInterval:function(a){if(null==a.prev&&null==a.next)this.AddInterval(a);else{for(var b=a,c=0,d=null;null!=b;){var f=b.next,b=b.prev;if(null==f&&null==b)break;null!=b&&a.min<b.min&&(c=-1,d=b);null!=f&&a.min>f.min&&(c=1,d=f);if(0==c)break;b=0>c?b:f;c=0}null!=d&&(this.RemoveInterval(a),this.InsertInterval(a,d))}},Remove:function(a){this.RemoveInterval(this.list[a])},RemoveInterval:function(a){if(this.m_has_query){var b=
a.prev,c=a.next;null!=b&&(b.next=c);null!=c&&(c.prev=b);a.next=a.prev=null;a==this.start&&(this.start=c)}},Iterate:function(a){for(var b=this.start;null!=b;)a(b),b=b.next},ToString:function(a){null==a&&(a=2);var b="";if(this.m_has_query)for(var c=this.start;null!=c;)b+=c.ToString(a),c=c.next;else for(var c=0,d=this.list.length;c<d;)var f=c++,b=b+this.list[f].ToString(a);return b},__class__:dc};var jd=function(){this.id=this.max=this.min=0};k["haxor.ds.SAPInterval"]=jd;jd.__name__=["haxor","ds","SAPInterval"];
jd.prototype={Set:function(a,b){this.min=a;this.max=b},Overlap:function(a){return a.min>this.min?a.min<=this.max:a.max>=this.min},ToString:function(a){null==a&&(a=2);return"["+l.RoundPlaces(this.min,a)+","+l.RoundPlaces(this.max,a)+"]"},__class__:jd};var kd=function(){};k["haxor.ds.IUSetItem"]=kd;kd.__name__=["haxor","ds","IUSetItem"];kd.prototype={__class__:kd};var ld=function(){this.m_list=[];this.m_length=0};k["haxor.ds.USet"]=ld;ld.__name__=["haxor","ds","USet"];ld.prototype={get_length:function(){return this.m_length},
Add:function(a){0<=a.usid||(this.m_length>=this.m_list.length?this.m_list.push(a):this.m_list[this.m_length]=a,a.usid=this.m_length++)},Remove:function(a){var b=a.usid;if(!(0>b||0>=this.m_length)){var c=this.m_list[this.m_length-1];this.m_list[b]=c;c.usid=b;a.usid=-1;this.m_length--}},Get:function(a){return this.m_list[a]},Clear:function(){this.m_length=0},__class__:ld,__properties__:{get_length:"get_length"}};var da=function(){};k["haxor.graphics.Fog"]=da;da.__name__=["haxor","graphics","Fog"];var e=
function(){};k["haxor.graphics.GL"]=e;e.__name__=["haxor","graphics","GL"];e.__properties__={get_api:"get_api",get_MAX_UNIFORM_BONES:"get_MAX_UNIFORM_BONES"};e.get_MAX_UNIFORM_BONES=function(){return(e.MAX_VERTEX_UNIFORM_LENGTH-32)/6|0};e.get_api=function(){return e.m_gl.get_api()};e.Initialize=function(a){e.m_gl=new Gc(a)};e.Resize=function(){e.m_gl.Resize()};e.BindBuffer=function(a,b){e.m_gl.BindBuffer(a,b)};e.BindVAO=function(a){e.m_gl.BindVAO(a)};e.BufferData=function(a,b,c){e.m_gl.BufferData(a,
b,c)};e.BufferSubData=function(a,b,c){e.m_gl.BufferSubData(a,b,c)};e.CreateBuffer=function(){return e.m_gl.CreateBuffer()};e.CreateVAO=function(){return e.m_gl.CreateVAO()};e.DrawArrays=function(a,b,c){e.m_gl.DrawArrays(a,b,c)};e.DrawElements=function(a,b,c,d){e.m_gl.DrawElements(a,b,c,d)};e.DeleteBuffer=function(a){e.m_gl.DeleteBuffer(a)};e.DeleteVAO=function(a){e.m_gl.DeleteVAO(a)};e.DisableVertexAttrib=function(a){e.m_gl.DisableVertexAttrib(a)};e.EnableVertexAttrib=function(a){e.m_gl.EnableVertexAttrib(a)};
e.VertexAttrib1f=function(a,b){e.m_gl.VertexAttrib1f(a,b)};e.VertexAttrib2f=function(a,b,c){e.m_gl.VertexAttrib2f(a,b,c)};e.VertexAttrib3f=function(a,b,c,d){e.m_gl.VertexAttrib3f(a,b,c,d)};e.VertexAttrib4f=function(a,b,c,d,f){e.m_gl.VertexAttrib4f(a,b,c,d,f)};e.VertexAttribPointer=function(a,b,c,d,f,m){e.m_gl.VertexAttribPointer(a,b,c,d,f,m)};e.CompileShader=function(a){e.m_gl.CompileShader(a)};e.CreateShader=function(a){return e.m_gl.CreateShader(a)};e.DetachShader=function(a,b){e.m_gl.DetachShader(a,
b)};e.DeleteShader=function(a){e.m_gl.DeleteShader(a)};e.GetShaderInfoLog=function(a){return e.m_gl.GetShaderInfoLog(a)};e.GetShaderParameter=function(a,b){return e.m_gl.GetShaderParameter(a,b)};e.ShaderSource=function(a,b){e.m_gl.ShaderSource(a,b)};e.AttachShader=function(a,b){e.m_gl.AttachShader(a,b)};e.BindAttribLocation=function(a,b,c){e.m_gl.BindAttribLocation(a,b,c)};e.CreateProgram=function(){return e.m_gl.CreateProgram()};e.DeleteProgram=function(a){e.m_gl.DeleteProgram(a)};e.GetAttribLocation=
function(a,b){return e.m_gl.GetAttribLocation(a,b)};e.GetUniformLocation=function(a,b){return e.m_gl.GetUniformLocation(a,b)};e.GetProgramInfoLog=function(a){return e.m_gl.GetProgramInfoLog(a)};e.GetProgramParameter=function(a,b){return e.m_gl.GetProgramParameter(a,b)};e.LinkProgram=function(a){e.m_gl.LinkProgram(a)};e.UseProgram=function(a){e.m_gl.UseProgram(a)};e.ActiveTexture=function(a){e.m_gl.ActiveTexture(a)};e.BindFramebuffer=function(a,b){e.m_gl.BindFramebuffer(a,b)};e.BindRenderbuffer=function(a,
b){e.m_gl.BindRenderbuffer(a,b)};e.BindTexture=function(a,b){e.m_gl.BindTexture(a,b)};e.CreateFramebuffer=function(){return e.m_gl.CreateFramebuffer()};e.CreateRenderbuffer=function(){return e.m_gl.CreateRenderbuffer()};e.CreateTexture=function(){return e.m_gl.CreateTexture()};e.DeleteFramebuffer=function(a){e.m_gl.DeleteFramebuffer(a)};e.DeleteRenderbuffer=function(a){e.m_gl.DeleteRenderbuffer(a)};e.DeleteTexture=function(a){e.m_gl.DeleteTexture(a)};e.FramebufferRenderbuffer=function(a,b,c,d){e.m_gl.FramebufferRenderbuffer(a,
b,c,d)};e.FramebufferTexture2D=function(a,b,c,d,f){e.m_gl.FramebufferTexture2D(a,b,c,d,f)};e.GenerateMipmap=function(a){e.m_gl.GenerateMipmap(a)};e.PixelStorei=function(a,b){e.m_gl.PixelStorei(a,b)};e.RenderbufferStorage=function(a,b,c,d){e.m_gl.RenderbufferStorage(a,b,c,d)};e.TexImage2D=function(a,b,c,d,f,m,g,h,k){e.m_gl.TexImage2D(a,b,c,d,f,m,g,h,k)};e.TexImage2DAlloc=function(a,b,c,d,f,m,g,h){e.m_gl.TexImage2DAlloc(a,b,c,d,f,m,g,h)};e.TexSubImage2D=function(a,b,c,d,f,m,g,h,k){e.m_gl.TexSubImage2D(a,
b,c,d,f,m,g,h,k)};e.TexStorage2D=function(a,b,c,d,f){e.m_gl.TexStorage2D(a,b,c,d,f)};e.TexParameterf=function(a,b,c){e.m_gl.TexParameterf(a,b,c)};e.TexParameteri=function(a,b,c){e.m_gl.TexParameteri(a,b,c)};e.Uniform1f=function(a,b){e.m_gl.Uniform1f(a,b)};e.Uniform2f=function(a,b,c){e.m_gl.Uniform2f(a,b,c)};e.Uniform3f=function(a,b,c,d){e.m_gl.Uniform3f(a,b,c,d)};e.Uniform4f=function(a,b,c,d,f){e.m_gl.Uniform4f(a,b,c,d,f)};e.Uniform1i=function(a,b){e.m_gl.Uniform1i(a,b)};e.Uniform2i=function(a,b,
c){e.m_gl.Uniform2i(a,b,c)};e.Uniform3i=function(a,b,c,d){e.m_gl.Uniform3i(a,b,c,d)};e.Uniform4i=function(a,b,c,d,f){e.m_gl.Uniform4i(a,b,c,d,f)};e.Uniform1fv=function(a,b){e.m_gl.Uniform1fv(a,b)};e.Uniform2fv=function(a,b){e.m_gl.Uniform2fv(a,b)};e.Uniform3fv=function(a,b){e.m_gl.Uniform3fv(a,b)};e.Uniform4fv=function(a,b){e.m_gl.Uniform4fv(a,b)};e.Uniform1iv=function(a,b){e.m_gl.Uniform1iv(a,b)};e.Uniform2iv=function(a,b){e.m_gl.Uniform2iv(a,b)};e.Uniform3iv=function(a,b){e.m_gl.Uniform3iv(a,b)};
e.Uniform4iv=function(a,b){e.m_gl.Uniform4iv(a,b)};e.UniformMatrix2fv=function(a,b,c){e.m_gl.UniformMatrix2fv(a,b,c)};e.UniformMatrix3fv=function(a,b,c){e.m_gl.UniformMatrix3fv(a,b,c)};e.UniformMatrix4fv=function(a,b,c){e.m_gl.UniformMatrix4fv(a,b,c)};e.BlendFunc=function(a,b){e.m_gl.BlendFunc(a,b)};e.Disable=function(a){e.m_gl.Disable(a)};e.Enable=function(a){e.m_gl.Enable(a)};e.DepthMask=function(a){e.m_gl.DepthMask(a)};e.DepthFunc=function(a){e.m_gl.DepthFunc(a)};e.CullFace=function(a){e.m_gl.CullFace(a)};
e.FrontFace=function(a){e.m_gl.FrontFace(a)};e.Clear=function(a){e.m_gl.Clear(a)};e.ClearDepth=function(a){e.m_gl.ClearDepth(a)};e.ClearColor=function(a,b,c,d){e.m_gl.ClearColor(a,b,c,d)};e.Viewport=function(a,b,c,d){e.m_gl.Viewport(a,b,c,d)};e.Scissor=function(a,b,c,d){e.m_gl.Scissor(a,b,c,d)};e.ReadPixels=function(a,b,c,d,f,m,g){e.m_gl.ReadPixels(a,b,c,d,f,m,g)};e.GetError=function(){return e.m_gl.GetError()};e.GetErrorCode=function(){return e.m_gl.GetErrorCode()};e.GetErrorString=function(a){return e.m_gl.GetErrorString(a)};
e.LogError=function(){e.m_gl.LogError()};e.Assert=function(a){};e.Flush=function(){null};e.Focus=function(){e.m_gl.Focus()};var ka=function(){};k["haxor.graphics.Gizmo"]=ka;ka.__name__=["haxor","graphics","Gizmo"];ka.Grid=function(a,b){g.gizmo.DrawGrid(a,b)};ka.Axis=function(a,b,c,d){g.gizmo.DrawAxis(a,b,c,d)};ka.Line=function(a,b,c,d){g.gizmo.DrawLine(a,b,c,d)};ka.Point=function(a,b,c,d,f){null==d&&(d=!0);null==b&&(b=1);g.gizmo.DrawPoint(a,b,c,d,f)};ka.WireSphere=function(a,b,c,d){null==b&&(b=1);
g.gizmo.DrawWireSphere(a,b,c,d)};ka.WireCube=function(a,b,c,d){g.gizmo.DrawWireCube(a,b,c,d)};ka.BeginPath=function(a,b,c){g.gizmo.canvas_renderer.Begin(a,b,c)};ka.LinePath=function(a){g.gizmo.canvas_renderer.Line(a)};ka.EndPath=function(){g.gizmo.canvas_renderer.End()};var Ma={__ename__:!0,__constructs__:["None","OpenGL","OpenGLES","WebGL"],None:["None",0]};Ma.None.toString=A;Ma.None.__enum__=Ma;Ma.OpenGL=["OpenGL",1];Ma.OpenGL.toString=A;Ma.OpenGL.__enum__=Ma;Ma.OpenGLES=["OpenGLES",2];Ma.OpenGLES.toString=
A;Ma.OpenGLES.__enum__=Ma;Ma.WebGL=["WebGL",3];Ma.WebGL.toString=A;Ma.WebGL.__enum__=Ma;var ec=function(a){this.m_api=Ma.None;this.m_application=a};k["haxor.graphics.GraphicContext"]=ec;ec.__name__=["haxor","graphics","GraphicContext"];ec.prototype={get_api:function(){return this.m_api},CheckExtensions:function(){},Destroy:function(){},Flush:function(){},Focus:function(){},Resize:function(){},BindBuffer:function(a,b){},BindVAO:function(a){},BufferData:function(a,b,c){},BufferSubData:function(a,b,
c){},CreateBuffer:function(){return e.INVALID},CreateVAO:function(){return e.INVALID},DeleteBuffer:function(a){},DeleteVAO:function(a){},DrawArrays:function(a,b,c){},DrawElements:function(a,b,c,d){},EnableVertexAttrib:function(a){},DisableVertexAttrib:function(a){},VertexAttrib1f:function(a,b){},VertexAttrib2f:function(a,b,c){},VertexAttrib3f:function(a,b,c,d){},VertexAttrib4f:function(a,b,c,d,f){},VertexAttribPointer:function(a,b,c,d,f,e){},CompileShader:function(a){},CreateShader:function(a){return e.INVALID},
DeleteShader:function(a){},DetachShader:function(a,b){},GetShaderInfoLog:function(a){return""},GetShaderParameter:function(a,b){return-1},ShaderSource:function(a,b){},AttachShader:function(a,b){},BindAttribLocation:function(a,b,c){},CreateProgram:function(){return e.INVALID},DeleteProgram:function(a){},GetAttribLocation:function(a,b){return-1},GetUniformLocation:function(a,b){return e.INVALID},GetProgramInfoLog:function(a){return""},GetProgramParameter:function(a,b){return-1},LinkProgram:function(a){},
UseProgram:function(a){},Uniform1f:function(a,b){},Uniform2f:function(a,b,c){},Uniform3f:function(a,b,c,d){},Uniform4f:function(a,b,c,d,f){},Uniform1i:function(a,b){},Uniform2i:function(a,b,c){},Uniform3i:function(a,b,c,d){},Uniform4i:function(a,b,c,d,f){},Uniform1fv:function(a,b){},Uniform2fv:function(a,b){},Uniform3fv:function(a,b){},Uniform4fv:function(a,b){},Uniform1iv:function(a,b){},Uniform2iv:function(a,b){},Uniform3iv:function(a,b){},Uniform4iv:function(a,b){},UniformMatrix2fv:function(a,
b,c){},UniformMatrix3fv:function(a,b,c){},UniformMatrix4fv:function(a,b,c){},ActiveTexture:function(a){},BindFramebuffer:function(a,b){},BindRenderbuffer:function(a,b){},BindTexture:function(a,b){},CreateFramebuffer:function(){return e.INVALID},CreateRenderbuffer:function(){return e.INVALID},CreateTexture:function(){return e.INVALID},DeleteFramebuffer:function(a){},DeleteRenderbuffer:function(a){},DeleteTexture:function(a){},FramebufferRenderbuffer:function(a,b,c,d){},FramebufferTexture2D:function(a,
b,c,d,f){},GenerateMipmap:function(a){},PixelStorei:function(a,b){},RenderbufferStorage:function(a,b,c,d){},TexImage2DAlloc:function(a,b,c,d,f,e,g,h){},TexImage2D:function(a,b,c,d,f,e,g,h,k){},TexSubImage2D:function(a,b,c,d,f,e,g,h,k){},TexStorage2D:function(a,b,c,d,f){},TexParameterf:function(a,b,c){},TexParameteri:function(a,b,c){},BlendFunc:function(a,b){},Disable:function(a){},Enable:function(a){},DepthMask:function(a){},DepthFunc:function(a){},CullFace:function(a){},FrontFace:function(a){},Clear:function(a){},
ClearDepth:function(a){},ClearColor:function(a,b,c,d){},Viewport:function(a,b,c,d){},Scissor:function(a,b,c,d){},ReadPixels:function(a,b,c,d,f,e,g){},GetErrorCode:function(){return 0},GetErrorString:function(a){switch(a){case 0:return"";case 1280:return"Invalid Enum.";case 1281:return"Numeric argument is out of range.";case 1282:return"Operation not allowed in the current state.";case 1286:return"Write or Read in FrameBuffer not complete.";case 1285:return"Out of Memory."}return"Unknown Error."},
GetError:function(){return this.GetErrorString(this.GetErrorCode())},Assert:function(a){var b=this.GetErrorCode();if(0!=b)throw"GraphicContext> "+this.GetErrorString(b)+" - "+a;},LogError:function(){u.Log(this.GetError())},__class__:ec,__properties__:{get_api:"get_api"}};var Ca=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.SetXYWH(a,b,c,d)};k["haxor.math.AABB2"]=Ca;Ca.__name__=["haxor","math","AABB2"];Ca.__properties__={get_empty:"get_empty",get_temp:"get_temp"};
Ca.get_temp=function(){return g.data.get_aabb2()};Ca.FromMinMax=function(a,b,c,d){var f=new Ca;f.m_xMin=a;f.m_xMax=b;f.m_yMin=c;f.m_yMax=d;f.Validate();return f};Ca.get_empty=function(){return new Ca};Ca.prototype={get_clone:function(){return Ca.FromMinMax(this.get_xMin(),this.get_xMax(),this.get_yMin(),this.get_yMax())},get_min:function(){return new K(this.m_xMin,this.m_yMin)},set_min:function(a){this.set_xMin(a.x);this.set_yMin(a.y);return a},get_max:function(){return new K(this.m_xMax,this.m_yMax)},
set_max:function(a){this.set_xMax(a.x);this.set_yMax(a.y);return a},get_xMin:function(){return this.m_xMin},set_xMin:function(a){this.m_xMin=a;this.Validate();return a},get_yMin:function(){return this.m_yMin},set_yMin:function(a){this.m_yMin=a;this.Validate();return a},get_xMax:function(){return this.m_xMax},set_xMax:function(a){this.m_xMax=a;this.Validate();return a},get_yMax:function(){return this.m_yMax},set_yMax:function(a){this.m_yMax=a;this.Validate();return a},get_center:function(){return new K(this.get_xMin()+
.5*(this.get_xMax()-this.get_xMin()),this.get_yMin()+.5*(this.get_yMax()-this.get_yMin()))},set_center:function(a){var b=.5*l.Abs(this.get_xMax()-this.get_xMin()),c=.5*l.Abs(this.get_yMax()-this.get_yMin());this.m_xMin=a.x-b;this.m_xMax=a.x+b;this.m_yMin=a.y-c;this.m_yMax=a.y+c;return a},get_x:function(){return this.get_xMin()},set_x:function(a){this.set_xMin(a);return a},get_y:function(){return this.get_yMin()},set_y:function(a){this.set_yMin(a);return a},get_width:function(){return l.Abs(this.get_xMax()-
this.get_xMin())},set_width:function(a){this.set_xMax(this.get_xMin()+a);return a},get_height:function(){return l.Abs(this.get_yMax()-this.get_yMin())},set_height:function(a){this.set_yMax(this.get_yMin()+a);return a},get_size:function(){return new K(l.Abs(this.get_xMax()-this.get_xMin()),l.Abs(this.get_yMax()-this.get_yMin()))},set_size:function(a){this.set_width(a.x);this.set_height(a.y);return a},Validate:function(){},Add:function(a){this.m_xMax=Math.max(a.m_xMax,this.m_xMax);this.m_xMin=Math.min(a.m_xMin,
this.m_xMin);this.m_yMax=Math.max(a.m_yMax,this.m_yMax);this.m_yMin=Math.min(a.m_yMin,this.m_yMin);return this},Set:function(a,b,c,d){this.m_xMin=a;this.m_yMin=c;this.m_xMax=b;this.m_yMax=d;this.Validate();return this},SetXYWH:function(a,b,c,d){this.m_xMin=a;this.m_yMin=b;this.m_xMax=this.m_xMin+c;this.m_yMax=this.m_yMin+d;return this},SetAABB2:function(a){this.m_xMin=a.m_xMin;this.m_yMin=a.m_yMin;this.m_xMax=a.m_xMax;this.m_yMax=a.m_yMax;return this},Encapsulate:function(a){this.set_xMin(l.Min(a.x,
this.get_xMin()));this.set_xMax(l.Max(a.x,this.get_xMax()));this.set_yMin(l.Min(a.y,this.get_yMin()));this.set_yMax(l.Max(a.y,this.get_yMax()))},Encapsulate3:function(a,b){null==b&&(b=0);null==a&&(a=0);this.m_xMin=Math.min(a,this.m_xMin);this.m_xMax=Math.max(a,this.m_xMax);this.m_yMin=Math.min(b,this.m_yMin);this.m_yMax=Math.max(b,this.m_yMax);this.Validate();return this},ToString:function(a){null==a&&(a=2);var b=l.RoundPlaces(this.m_xMin,a)+"",c=l.RoundPlaces(this.m_xMax,a)+"",d=l.RoundPlaces(this.m_yMin,
a)+"";a=l.RoundPlaces(this.m_yMax,a)+"";return"["+b+","+c+"|"+d+","+a+"]"},__class__:Ca,__properties__:{set_size:"set_size",get_size:"get_size",set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x",set_center:"set_center",get_center:"get_center",set_yMax:"set_yMax",get_yMax:"get_yMax",set_xMax:"set_xMax",get_xMax:"get_xMax",set_yMin:"set_yMin",get_yMin:"get_yMin",set_xMin:"set_xMin",get_xMin:"get_xMin",set_max:"set_max",
get_max:"get_max",set_min:"set_min",get_min:"get_min",get_clone:"get_clone"}};var la=function(){};k["haxor.graphics.Graphics"]=la;la.__name__=["haxor","graphics","Graphics"];la.Viewport=function(a){var b=!1;0<l.Abs(a.get_xMin()-la.m_last_viewport.get_xMin())?b=!0:0<l.Abs(a.get_yMin()-la.m_last_viewport.get_yMin())?b=!0:0<l.Abs(l.Abs(a.get_xMax()-a.get_xMin())-la.m_last_viewport.get_width())?b=!0:0<l.Abs(l.Abs(a.get_yMax()-a.get_yMin())-la.m_last_viewport.get_height())&&(b=!0);b&&(la.m_last_viewport.SetAABB2(a),
e.Viewport(a.get_xMin(),a.get_yMin(),l.Abs(a.get_xMax()-a.get_xMin()),l.Abs(a.get_yMax()-a.get_yMin())),e.Scissor(a.get_xMin(),a.get_yMin(),l.Abs(a.get_xMax()-a.get_xMin()),l.Abs(a.get_yMax()-a.get_yMin())))};la.Clear=function(a){la.Viewport(a.m_pixelViewport);if(a.clear!=Xa.None){var b=0;0!=(a.clear&Xa.Color)&&(b|=16384);0!=(a.clear&Xa.Skybox)&&(b|=16384);0!=(a.clear&Xa.Depth)&&(b|=256);e.m_gl.ClearColor(a.background.r,a.background.g,a.background.b,a.background.a);e.m_gl.ClearDepth(1);e.m_gl.Clear(b);
0!=(a.clear&Xa.Skybox)&&null!=a.skybox&&(b=g.camera.skybox_material,b.SetTexture("SkyboxTexture",a.skybox),b.SetMatrix4("SkyboxProjectionMatrixInverse",a.m_skyboxProjectionInverse),la.Render(W.get_screen(),b,null,a))}};la.Render=function(a,b,c,d){g.material.Bind(b,c,d,a);g.mesh.Bind(a);g.mesh.Draw(a)};la.DrawTexture=function(a,b,c,d,f,e){null==f&&(f=256);null==d&&(d=256);null==c&&(c=0);null==b&&(b=0);if(null!=a){var h=g.gizmo.texture_material;h.SetFloat2("Screen",H.m_width,H.m_height);h.SetFloat4("Rect",
b,c,d,f);h.SetTexture("Texture",a);a=null==e?g.data.get_c().Set(1,1,1,1):e;h.SetFloat4("Tint",a.r,a.g,a.b,a.a);la.Render(g.gizmo.texture,h)}};la.ReadPixels=function(a,b,c,d,f){e.m_gl.ReadPixels(a,b,c,d,6408,5121,f)};var H=function(){};k["haxor.graphics.Screen"]=H;H.__name__=["haxor","graphics","Screen"];H.__properties__={set_cursor:"set_cursor",get_cursor:"get_cursor",set_fullscreen:"set_fullscreen",get_fullscreen:"get_fullscreen",get_height:"get_height",get_width:"get_width"};H.get_width=function(){return H.m_width};
H.get_height=function(){return H.m_height};H.get_fullscreen=function(){return H.m_fullscreen};H.set_fullscreen=function(a){H.m_fullscreen=H.m_application.OnFullscreenRequest(a);return H.m_fullscreen};H.get_cursor=function(){return H.m_cursor};H.set_cursor=function(a){if(a==Ha.Lock){if(!H.m_application.OnPointerLockRequest(!0))return H.m_cursor=Ha.Show;H.m_application.OnPointerVisibilityRequest(!1);return H.m_cursor=Ha.Lock}H.m_application.OnPointerLockRequest(!1);return H.m_application.OnPointerVisibilityRequest(a==
Ha.Show)?H.m_cursor=Ha.Show:H.m_cursor=Ha.Hide};H.Initialize=function(a){H.m_application=a;H.m_width=0;H.m_height=0;H.m_fullscreen=!1;H.m_cursor=Ha.Show;H.m_application=null};var Ha={__ename__:!0,__constructs__:["Show","Hide","Lock"],Show:["Show",0]};Ha.Show.toString=A;Ha.Show.__enum__=Ha;Ha.Hide=["Hide",1];Ha.Hide.toString=A;Ha.Hide.__enum__=Ha;Ha.Lock=["Lock",2];Ha.Lock.toString=A;Ha.Lock.__enum__=Ha;var aa=function(a){null==a&&(a="");this.grab=!1;v.call(this,a);this.__cid=g.material.mid.get_id();
this.m_uniforms=[];this.queue=1E3;this.zfunc=515;this.zwrite=this.ztest=!0;this.blend=!1;this.blendSrc=1;this.blendDst=0;this.invert=!1;this.cull=2;this.grab=this.lighting=!1;g.material.InitializeMaterial(this)};k["haxor.graphics.material.Material"]=aa;aa.__name__=["haxor","graphics","material","Material"];aa.Opaque=function(a,b,c){null==c&&(c=!0);null==b&&(b=!0);var d=new aa("Opaque");d.set_shader(null==a?null==C.m_flat_shader?C.m_flat_shader=new C(ea.flat_source):C.m_flat_shader:null==C.m_flat_texture_shader?
C.m_flat_texture_shader=new C(ea.flat_texture_source):C.m_flat_texture_shader);d.queue=1E3;d.ztest=b;d.zwrite=c;null!=a&&d.SetTexture("DiffuseTexture",a);return d};aa.Transparent=function(a,b,c,d){null==d&&(d=!1);null==c&&(c=!0);null==b&&(b=!0);var f=new aa("Transparent");d&&(f.cull=0);f.SetBlending(770,771);f.set_shader(null==a?null==C.m_flat_shader?C.m_flat_shader=new C(ea.flat_source):C.m_flat_shader:null==C.m_flat_texture_shader?C.m_flat_texture_shader=new C(ea.flat_texture_source):C.m_flat_texture_shader);
f.queue=2E3;f.ztest=b;f.zwrite=c;f.blend=!0;null!=a&&f.SetTexture("DiffuseTexture",a);return f};aa.AdditiveAlpha=function(a,b,c,d){null==d&&(d=!1);null==c&&(c=!0);null==b&&(b=!0);a=aa.Transparent(null,b,c,d);a.set_name("AdditiveAlpha");a.SetBlending(770,1);return a};aa.Additive=function(a,b,c,d){null==d&&(d=!1);null==c&&(c=!0);null==b&&(b=!0);a=aa.Transparent(null,b,c,d);a.set_name("Additive");a.SetBlending(1,1);return a};aa.__super__=v;aa.prototype=s(v.prototype,{get_shader:function(){return this.m_shader},
set_shader:function(a){g.material.UpdateShader(this,this.m_shader,a);return this.m_shader=a},SetBlending:function(a,b){this.blendSrc=a;this.blendDst=b},SetTexture:function(a,b){if(null==b)this.RemoveUniform(a);else{var c=this.FetchUniform(a,!1,1,1,!0);c.exists&&c.SetTexture(b)}},SetMatrix4:function(a,b,c){null==c&&(c=!1);null==b?this.RemoveUniform(a):(a=this.FetchUniform(a,!0,16,16,!0),a.exists&&a.SetMatrix4(b,c))},SetVector2:function(a,b){this.SetFloat2(a,b.x,b.y)},SetVector3:function(a,b){this.SetFloat3(a,
b.x,b.y,b.z)},SetVector4:function(a,b){this.SetFloat4(a,b.x,b.y,b.z,b.w)},SetColor:function(a,b){this.SetFloat4(a,b.r,b.g,b.b,b.a)},SetFloat:function(a,b){var c=this.FetchUniform(a,!0,1,1,!0);c.exists&&c.SetFloat(b)},SetFloat2:function(a,b,c){a=this.FetchUniform(a,!0,2,2,!0);a.exists&&a.SetFloat2(b,c)},SetFloat3:function(a,b,c,d){a=this.FetchUniform(a,!0,3,3,!0);a.exists&&a.SetFloat3(b,c,d)},SetFloat4:function(a,b,c,d,f){a=this.FetchUniform(a,!0,4,4,!0);a.exists&&a.SetFloat4(b,c,d,f)},SetFloatArray:function(a,
b){var c=this.FetchUniform(a,!0,b.length,1,!0);c.exists&&c.SetFloatArray(b)},SetFloat2Array:function(a,b){var c=this.FetchUniform(a,!0,b.length,2,!0);c.exists&&c.SetFloat2Array(b)},SetFloat3Array:function(a,b){var c=this.FetchUniform(a,!0,b.length,3,!0);c.exists&&c.SetFloat3Array(b)},SetFloat4Array:function(a,b){var c=this.FetchUniform(a,!0,b.length,4,!0);c.exists&&c.SetFloat4Array(b)},SetInt:function(a,b){var c=this.FetchUniform(a,!1,1,1,!0);c.exists&&c.SetInt(b)},SetInt2:function(a,b,c){a=this.FetchUniform(a,
!1,2,2,!0);a.exists&&a.SetInt2(b,c)},SetInt3:function(a,b,c,d){a=this.FetchUniform(a,!1,3,3,!0);a.exists&&a.SetInt3(b,c,d)},SetInt4:function(a,b,c,d,f){a=this.FetchUniform(a,!1,4,4,!0);a.exists&&a.SetInt4(b,c,d,f)},SetIntArray:function(a,b){var c=this.FetchUniform(a,!1,b.length,1,!0);c.exists&&c.SetIntArray(b)},SetInt2Array:function(a,b){var c=this.FetchUniform(a,!1,b.length,2,!0);c.exists&&c.SetInt2Array(b)},SetInt3Array:function(a,b){var c=this.FetchUniform(a,!1,b.length,3,!0);c.exists&&c.SetInt3Array(b)},
SetInt4Array:function(a,b){var c=this.FetchUniform(a,!1,b.length,4,!0);c.exists&&c.SetInt4Array(b)},GetUniform:function(a){for(var b=0,c=this.m_uniforms.length;b<c;){var d=b++;if(this.m_uniforms[d].name==a)return this.m_uniforms[d]}return null},HasUniform:function(a,b){null==b&&(b=!1);for(var c=0,d=this.m_uniforms.length;c<d;){var f=c++;if(this.m_uniforms[f].name==a)return b?this.m_uniforms[f].exists:!0}return!1},RemoveUniform:function(a){for(var b=null,c=0,d=this.m_uniforms.length;c<d&&(b=c++,b=
this.m_uniforms[b],b.name!=a););null!=b&&(null!=b.texture&&(b.texture.__slot=-1),g.material.DestroyUniform(this,b),E.remove(this.m_uniforms,b))},FetchUniform:function(a,b,c,d,f){for(var e=null,h=0,k=this.m_uniforms.length;h<k;)if(e=h++,e=this.m_uniforms[e],e.name==a){if(e.isFloat==b&&e.offset==d&&e.data.m_length==c)return e;g.material.DestroyUniform(this,e);E.remove(this.m_uniforms,e);break}f&&(e=new md(a,b,c,d),g.material.CreateUniform(this,e),this.m_uniforms.push(e));return e},Clone:function(){var a=
new aa;a.set_name(this.get_name()+"Copy");a.set_shader(this.m_shader);a.queue=this.queue;a.zfunc=this.zfunc;a.ztest=this.ztest;a.zwrite=this.zwrite;a.blend=this.blend;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.invert=this.invert;a.cull=this.cull;a.lighting=this.lighting;a.grab=this.grab;for(var b=this.m_uniforms,c=0,d=b.length;c<d;){var f=c++,f=b[f];f.isFloat?this.SetUniformFloat(f):this.SetUniformInt(f)}return a},SetUniformFloat:function(a){var b=a.data,c=b.m_length>a.offset,d=null;if(c)for(var d=
[],f=0,e=b.m_length;f<e;){var h=f++;d.push(b.Get(h))}switch(a.offset){case 1:c?this.SetFloatArray(a.name,d):this.SetFloat(a.name,b.Get(0));break;case 2:c?this.SetFloat2Array(a.name,d):this.SetFloat2(a.name,b.Get(0),b.Get(1));break;case 3:c?this.SetFloat3Array(a.name,d):this.SetFloat3(a.name,b.Get(0),b.Get(1),b.Get(2));break;case 4:c?this.SetFloat4Array(a.name,d):this.SetFloat4(a.name,b.Get(0),b.Get(1),b.Get(2),b.Get(3));break;case 16:c=g.data.get_m4();for(d=0;16>d;)f=d++,c.SetIndex(f,b.Get(f));a.transposed&&
c.Transpose();this.SetMatrix4(a.name,c,a.transposed)}},SetUniformInt:function(a){var b=a.data,c=b.m_length>a.offset,d=null;if(c)for(var d=[],f=0,e=b.m_length;f<e;){var g=f++;d.push(b.Get(g))}switch(a.offset){case 1:null!=a.texture?this.SetTexture(a.name,a.texture):c?this.SetIntArray(a.name,d):this.SetInt(a.name,b.Get(0));break;case 2:c?this.SetInt2Array(a.name,d):this.SetInt2(a.name,b.Get(0),b.Get(1));break;case 3:c?this.SetInt3Array(a.name,d):this.SetInt3(a.name,b.Get(0),b.Get(1),b.Get(2));break;
case 4:c?this.SetInt4Array(a.name,d):this.SetInt4(a.name,b.Get(0),b.Get(1),b.Get(2),b.Get(3))}},OnDestroy:function(){g.material.DestroyMaterial(this)},__class__:aa,__properties__:s(v.prototype.__properties__,{set_shader:"set_shader",get_shader:"get_shader"})});var md=function(a,b,c,d){this.__cid=g.material.uid.get_id();this.__d=!0;this.name=a;this.isFloat=b;this.offset=d;this.transposed=this.exists=!1;this.data=b?new L(c):new wb(c)};k["haxor.graphics.material.MaterialUniform"]=md;md.__name__=["haxor",
"graphics","material","MaterialUniform"];md.prototype={SetFloat:function(a){this.exists&&(this.__d=!0,this.data.Set(0,a))},SetFloat2:function(a,b){if(this.exists){this.__d=!0;var c=this.data;c.Set(0,a);c.Set(1,b)}},SetFloat3:function(a,b,c){if(this.exists){this.__d=!0;var d=this.data;d.Set(0,a);d.Set(1,b);d.Set(2,c)}},SetFloat4:function(a,b,c,d){if(this.exists){this.__d=!0;var f=this.data;f.Set(0,a);f.Set(1,b);f.Set(2,c);f.Set(3,d)}},SetFloatArray:function(a){if(this.exists){this.__d=!0;for(var b=
this.data,c=0,d=a.length;c<d;){var f=c++;b.Set(f,a[f])}}},SetFloat2Array:function(a){if(this.exists){this.__d=!0;for(var b=this.data,c=0,d=a.length;c<d;){var f=c++;b.Set(f,a[f])}}},SetFloat3Array:function(a){if(this.exists){this.__d=!0;for(var b=this.data,c=0,d=a.length;c<d;){var f=c++;b.Set(f,a[f])}}},SetFloat4Array:function(a){if(this.exists){this.__d=!0;for(var b=this.data,c=0,d=a.length;c<d;){var f=c++;b.Set(f,a[f])}}},SetInt:function(a){this.exists&&(this.__d=!0,this.data.Set(0,a))},SetInt2:function(a,
b){if(this.exists){this.__d=!0;var c=this.data;c.Set(0,a);c.Set(1,b)}},SetInt3:function(a,b,c){if(this.exists){this.__d=!0;var d=this.data;d.Set(0,a);d.Set(1,b);d.Set(2,c)}},SetInt4:function(a,b,c,d){if(this.exists){this.__d=!0;var f=this.data;f.Set(0,a);f.Set(1,b);f.Set(2,c);f.Set(3,d)}},SetIntArray:function(a){if(this.exists){this.__d=!0;for(var b=this.data,c=0,d=a.length;c<d;){var f=c++;b.Set(f,a[f])}}},SetInt2Array:function(a){if(this.exists){this.__d=!0;for(var b=this.data,c=0,d=a.length;c<d;){var f=
c++;b.Set(f,a[f])}}},SetInt3Array:function(a){if(this.exists){this.__d=!0;for(var b=this.data,c=0,d=a.length;c<d;){var f=c++;b.Set(f,a[f])}}},SetInt4Array:function(a){if(this.exists){this.__d=!0;for(var b=this.data,c=0,d=a.length;c<d;){var f=c++;b.Set(f,a[f])}}},Refresh:function(){this.exists&&(this.__d=!0)},SetTexture:function(a){if(this.exists&&a!=this.texture){null==this.texture&&(this.__d=!0);var b=this.data,c;c=null==this.texture?-1:this.texture.__slot;null!=this.texture&&(this.texture.__slot=
-1);this.texture=a;null!=this.texture&&(this.texture.__slot=c);b.Set(0,c)}},SetMatrix4:function(a,b){null==b&&(b=!1);if(this.exists){this.__d=!0;this.transposed=b;var c=this.data;b?(c.Set(0,a.m00),c.Set(1,a.m10),c.Set(2,a.m20),c.Set(3,a.m30),c.Set(4,a.m01),c.Set(5,a.m11),c.Set(6,a.m21),c.Set(7,a.m31),c.Set(8,a.m02),c.Set(9,a.m12),c.Set(10,a.m22),c.Set(11,a.m32),c.Set(12,a.m03),c.Set(13,a.m13),c.Set(14,a.m23)):(c.Set(0,a.m00),c.Set(1,a.m01),c.Set(2,a.m02),c.Set(3,a.m03),c.Set(4,a.m10),c.Set(5,a.m11),
c.Set(6,a.m12),c.Set(7,a.m13),c.Set(8,a.m20),c.Set(9,a.m21),c.Set(10,a.m22),c.Set(11,a.m23),c.Set(12,a.m30),c.Set(13,a.m31),c.Set(14,a.m32));c.Set(15,a.m33)}},SetVector2:function(a){this.SetFloat2(a.x,a.y)},SetVector3:function(a){this.SetFloat3(a.x,a.y,a.z)},SetVector4:function(a){this.SetFloat4(a.x,a.y,a.z,a.w)},SetColor:function(a){this.SetFloat4(a.r,a.g,a.b,a.a)},__class__:md};var C=function(a,b){null==b&&(b=!0);v.call(this);this.__cid=g.material.sid.get_id();this.m_pp=new fb;this.Load(a,b)};k["haxor.graphics.material.Shader"]=
C;C.__name__=["haxor","graphics","material","Shader"];C.__properties__={get_FlatParticle:"get_FlatParticle",get_FlatTextureSkin:"get_FlatTextureSkin",get_FlatTexture:"get_FlatTexture",get_Flat:"get_Flat"};C.get_Flat=function(){return null==C.m_flat_shader?C.m_flat_shader=new C(ea.flat_source):C.m_flat_shader};C.get_FlatTexture=function(){return null==C.m_flat_texture_shader?C.m_flat_texture_shader=new C(ea.flat_texture_source):C.m_flat_texture_shader};C.get_FlatTextureSkin=function(){if(null!=C.m_flat_texture_skin_shader)return C.m_flat_texture_skin_shader;
var a=C.m_flat_texture_skin_shader=new C(ea.flat_texture_skin_source,!1);a.AddPreprocessor("#define","MAX_BONES",e.get_MAX_UNIFORM_BONES()+"");e.BONE_TEXTURE&&a.AddPreprocessor("#define","BONE_TEXTURE");a.Compile();return a};C.get_FlatParticle=function(){return null==C.m_flat_particle_shader?C.m_flat_particle_shader=new C(ea.flat_particle_source):C.m_flat_particle_shader};C.__super__=v;C.prototype=s(v.prototype,{get_vs:function(){return this.GetPreprocessorString()+this.m_vss},get_fs:function(){return this.GetPreprocessorString()+
this.m_fss},get_hasError:function(){return this.m_hasError},Load:function(a,b){null==b&&(b=!0);var c=a.indexOf("<vertex"),d=a.indexOf(">",c+1),c=a.substring(c,d+1),d=a.indexOf("<fragment"),f=a.indexOf(">",d+1),d=a.substring(d,f+1);a=B.replace(a,c,c+"<![CDATA[");a=B.replace(a,"</vertex>","]]\x3e</vertex>");a=B.replace(a,d,d+"<![CDATA[");a=B.replace(a,"</fragment>","]]\x3e</fragment>");d=G.parse(a);d=d.firstElement();this.set_name(d.get("id"));null!=this.get_name()&&""!=this.get_name()||this.set_name("Shader"+
this.__cid);c=d.elementsNamed("vertex").next();d=d.elementsNamed("fragment").next();this.m_vss=this.GetShaderSource(c,e.VS_FLOAT_HIGHP);this.m_fss=this.GetShaderSource(d,e.FS_FLOAT_HIGHP);this.m_hasError=!1;this.error="";b&&this.Compile()},Compile:function(){g.material.CompileShader(this)},AddPreprocessor:function(a,b,c){null==c&&(c="");this.m_pp.set(b,a+" "+b+" "+c)},RemovePreprocessor:function(a){this.m_pp.remove(a)},ClearPreprocessor:function(){for(var a=this.m_pp.keys();a.hasNext();){var b=a.next();
this.m_pp.remove(b)}},HasPreprocessor:function(a){return this.m_pp.exists(a)},GetPreprocessorString:function(){for(var a=this.m_pp.iterator(),b="";a.hasNext();)b+=a.next()+"\n";return b+"\n"},GetShaderSource:function(a,b){if(null==a)return"";var c=a.firstChild().get_nodeValue().toString(),d=(null==a.get("precision")?"low":a.get("precision")).toLowerCase();switch(d){case "low":d="lowp";break;case "medium":d="mediump";break;case "high":d=b?"highp":"mediump"}return"precision "+d+" float;"+c},OnDestroy:function(){g.material.DestroyShader(this)},
__class__:C,__properties__:s(v.prototype.__properties__,{get_hasError:"get_hasError",get_fs:"get_fs",get_vs:"get_vs"})});var Dc=function(a){C.call(this,a)};k["haxor.graphics.material.UberShader"]=Dc;Dc.__name__=["haxor","graphics","material","UberShader"];Dc.__super__=C;Dc.prototype=s(C.prototype,{__class__:Dc});var mb=function(a,b,c){null==c&&(c=!0);null==b&&(b=9);this.m_precision=b;this.set_name(a);r.Add(a,this);C.call(this,this.Generate(),c)};k["haxor.graphics.material.shader.TemplateShader"]=
mb;mb.__name__=["haxor","graphics","material","shader","TemplateShader"];mb.__super__=C;mb.prototype=s(C.prototype,{get_precision:function(){return this.m_precision},set_precision:function(a){return this.m_precision=a},Compile:function(){var a=this.Generate();this.Load(a,!1);C.prototype.Compile.call(this)},Generate:function(){var a="low",b="low";0!=(this.m_precision&2)?a="medium":0!=(this.m_precision&4)&&(a="high");0!=(this.m_precision&16)?b="medium":0!=(this.m_precision&32)&&(b="high");var c=mb.template,
c=B.replace(c,"@ID",this.get_name()),c=B.replace(c,"@VSP",a),c=B.replace(c,"@FSP",b),c=B.replace(c,"@VS",this.GetVS());return c=B.replace(c,"@FS",this.GetFS())},GetVS:function(){return""},GetFS:function(){return""},__class__:mb,__properties__:s(C.prototype.__properties__,{set_precision:"set_precision",get_precision:"get_precision"})});var ga=function(a,b,c,d){null==d&&(d=!0);null==c&&(c=9);null==b&&(b=0);mb.call(this,a,c,!1);this.set_features(b);d&&this.Compile()};k["haxor.graphics.material.shader.FlexShader"]=
ga;ga.__name__=["haxor","graphics","material","shader","FlexShader"];ga.__super__=mb;ga.prototype=s(mb.prototype,{get_features:function(){return this.m_features},set_features:function(a){this.m_features=a;this.ClearPreprocessor();0!=(a&1)&&this.AddPreprocessor("#define","TEXTURE");0!=(a&2)&&this.AddPreprocessor("#define","TINT");0!=(a&4)&&this.AddPreprocessor("#define","VERTEX_COLOR");0!=(a&8)&&(this.AddPreprocessor("#define","SKINNING"),this.AddPreprocessor("#define","MAX_BONES",e.get_MAX_UNIFORM_BONES()+
""),e.BONE_TEXTURE&&this.AddPreprocessor("#define","BONE_TEXTURE"));0!=(a&32)&&(this.AddPreprocessor("#define","REFLECTION_VERTEX"),this.AddPreprocessor("#define","REFLECTION"));0!=(a&64)&&(this.AddPreprocessor("#define","REFLECTION_PIXEL"),this.AddPreprocessor("#define","REFLECTION"));0!=(a&128)&&this.AddPreprocessor("#define","REFLECTION_TEXTURE");0!=(a&256)&&(this.AddPreprocessor("#define","FALLOFF_VERTEX"),this.AddPreprocessor("#define","FALLOFF"));0!=(a&512)&&(this.AddPreprocessor("#define",
"FALLOFF_PIXEL"),this.AddPreprocessor("#define","FALLOFF"));0!=(a&1024)&&this.AddPreprocessor("#define","BUMP");0!=(a&2048)&&(this.AddPreprocessor("#define","LIGHTING_VERTEX"),this.AddPreprocessor("#define","LIGHTING"));0!=(a&4096)&&(this.AddPreprocessor("#define","LIGHTING_PIXEL"),this.AddPreprocessor("#define","LIGHTING"));0!=(a&16384)&&this.AddPreprocessor("#define","SPECULAR");0!=(a&32768)&&this.AddPreprocessor("#define","SPECULAR_TEXTURE");0!=(a&65536)&&this.AddPreprocessor("#define","SPECULAR_ALPHA");
0!=(a&131072)&&this.AddPreprocessor("#define","LIGHTMAP");0!=(a&262144)&&(this.AddPreprocessor("#define","FOG_VERTEX"),this.AddPreprocessor("#define","FOG"));0!=(a&262144)&&(this.AddPreprocessor("#define","FOG_PIXEL"),this.AddPreprocessor("#define","FOG"));0!=(a&524288)&&this.AddPreprocessor("#define","TOON");0!=(a&1048576)&&this.AddPreprocessor("#define","CUTOFF");0!=(a&2097152)&&this.AddPreprocessor("#define","PARTICLE");0!=(a&4194304)&&this.AddPreprocessor("#define","UV_SCROLL");0!=(a&8388608)&&
this.AddPreprocessor("#define","RANDOM");0!=(a&16777216)&&this.AddPreprocessor("#define","ALPHA_TEXTURE");0!=(a&33554432)&&this.AddPreprocessor("#define","EMISSIVE");0!=(a&67108864)&&this.AddPreprocessor("#define","EMISSIVE_TEXTURE");0!=(a&6144)&&this.AddPreprocessor("#define","MAX_LIGHTS",P.max+"");return a},GetVS:function(){return"\r\n\t\t"+ga.g_preprocessors+"\r\n\t\t\r\n\t\t"+ga.g_uniforms+"\r\n\t\t\r\n\t\t"+ga.vs_uniforms+"\r\n\t\t\r\n\t\t"+ga.vs_attribs+"\r\n\t\t\r\n\t\t"+ga.g_varyings+"\r\n\t\t\r\n\t\t"+
ga.g_functions+"\r\n\t\t\r\n\t\t"+ga.vs_functions+"\r\n\t\t\r\n\t\tvec4 LPos;\r\n\t\tvec4 WPos;\r\n\t\tvec4 VPos;\r\n\t\tvec4 HPos;\r\n\t\t\r\n\t\tvec3 WorldViewDir;\r\n\t\tvec3 Normal;\r\n\t\t\r\n\t\tvec3 FalloffComponent;\r\n\t\tvec3 DiffuseComponent;\r\n\t\tvec3 SpecularComponent;\r\n\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\t\r\n\t\t\tmat4 wm;\r\n\t\t\t\r\n\t\t\tLPos = vec4(vertex, 1.0);\r\n\t\t\t\r\n\t\t\t#ifdef SKINNING\r\n\t\t\twm = SkinWorldMatrix();\r\n\t\t\t#else\r\n\t\t\twm = WorldMatrix;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tWPos = LPos * wm;\r\n\t\t\tVPos = WPos * ViewMatrix;\r\n\t\t\tHPos = VPos * ProjectionMatrix;\r\n\t\t\t\r\n\t\t\t#ifdef LIGHTING\r\n\t\t\tv_wpos = WPos.xyz;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tWorldViewDir = vec3(0.0);\r\n\t\t\t\r\n\t\t\t#ifdef USE_VIEW_DIR\r\n\t\t\tWorldViewDir = v_wview = -normalize(WPos.xyz - CameraPosition);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tNormal = vec3(0.0);\r\n\t\t\t\r\n\t\t\t#ifdef USE_NORMAL\r\n\t\t\tNormal = v_normal = normal;\r\n\t\t\t#ifdef SKINNING\r\n\t\t\tNormal = v_normal = v_normal * mat3(wm);\r\n\t\t\t#else\r\n\t\t\tNormal = v_normal = v_normal * mat3(wm);\r\n\t\t\t#endif\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tv_color = vec4(1, 1, 1, 1);\t\t\t\r\n\t\t\t\r\n\t\t\t#ifdef VERTEX_COLOR\r\n\t\t\tv_color *= color;\r\n\t\t\t#endif\t\t\t\r\n\t\t\t\r\n\t\t\t#ifdef TINT\r\n\t\t\tv_color *= Tint;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef TEXTURE\r\n\t\t\tv_uv0 = uv0;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef UV_SCROLL\r\n\t\t\tv_uv0 = (v_uv0 + (UVSpeed * Time)) + UVOffset;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef USE_UV1\r\n\t\t\tv_uv1 = uv1;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef LIGHTING_VERTEX\t\t\t\r\n\t\t\tProcessLights(Normal, WorldViewDir, Shininess, DiffuseComponent, SpecularComponent);\t\t\t\t\t\t\r\n\t\t\tv_diffuse_component = DiffuseComponent;\t\t\t\r\n\t\t\t#ifdef SPECULAR\r\n\t\t\tv_specular_component = SpecularComponent;\r\n\t\t\t#endif\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef FALLOFF_VERTEX\r\n\t\t\tFalloffComponent = v_falloff_component = Falloff(WorldViewDir, Normal, FalloffExp) * FalloffIntensity * FalloffColor.xyz;\t\t\t\t\t\t\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef REFLECTION_VERTEX\r\n\t\t\tv_wreflection = reflect(-WorldViewDir, Normal);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef FOG\r\n\t\t\tv_linear_depth = LinearNF(HPos.z/HPos.w,CameraNear,CameraFar);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef FOG_VERTEX\r\n\t\t\tv_fog_component = FogFactor(v_linear_depth, FogExp, FogDensity, FogStart, FogEnd);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tgl_Position = HPos;\r\n\t\t}\t\t\r\n\t\t"},
GetFS:function(){return"\r\n\t\t"+ga.g_preprocessors+"\r\n\t\t\r\n\t\t"+ga.g_uniforms+"\r\n\t\t\r\n\t\t"+ga.fs_uniforms+"\r\n\t\t\r\n\t\t"+ga.g_varyings+"\r\n\t\t\r\n\t\t"+ga.g_functions+"\r\n\t\t\r\n\t\tvec3 FalloffComponent;\r\n\t\t\r\n\t\tvec3 Normal;\t\t\r\n\t\tvec4 Fragment;\r\n\t\t\r\n\t\tvec3 DiffuseComponent;\r\n\t\tvec3 SpecularComponent;\r\n\t\t\r\n\t\tvec3 WorldViewDir;\r\n\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\r\n\t\t\t\r\n\t\t\t#ifdef USE_VIEW_DIR\r\n\t\t\tWorldViewDir = v_wview;\r\n\t\t\t#else\r\n\t\t\tWorldViewDir = vec3(0, 0, 0);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tFragment = v_color;\r\n\t\t\t\r\n\t\t\t#ifdef USE_NORMAL\r\n\t\t\tNormal = v_normal;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef BUMP\r\n\t\t\tvec3 tex_bump = (texture2D(NormalTexture, v_uv1).xyz * 2.0) - 1.0;\r\n\t\t\tNormal = tex_bump;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef USE_NORMAL\r\n\t\t\tNormal = normalize(Normal);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tvec4 tex_diffuse = vec4(0, 0, 0, 1);\r\n\t\t\t\r\n\t\t\t#ifdef TEXTURE\t\t\t\r\n\t\t\ttex_diffuse *= texture2D(DiffuseTexture, v_uv0.xy);\r\n\t\t\t#endif\r\n\t\t\t\t\t\t\r\n\t\t\t#ifdef ALPHA_TEXTURE\t\t\t\r\n\t\t\ttex_diffuse.a *= texture2D(AlphaTexture, v_uv0.xy).r;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef USE_DIFFUSE_TEXTURE\r\n\t\t\tFragment *= tex_diffuse;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef CUTOFF\r\n\t\t\tif (Fragment.w <= Cutoff) discard;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tvec3 reflect_dir = vec3(0.0);\r\n\t\t\t\r\n\t\t\t#ifdef REFLECTION_VERTEX\r\n\t\t\treflect_dir = v_wreflection;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef REFLECTION_PIXEL\r\n\t\t\treflect_dir = reflect(-v_wview,Normal);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef REFLECTION\r\n\t\t\tvec3 tex_reflection = textureCube(ReflectionTexture, reflect_dir).xyz;\r\n\t\t\tFragment.xyz += tex_reflection.xyz * ReflectionIntensity * ReflectionColor.xyz;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef LIGHTMAP\r\n\t\t\tvec4 tex_lightmap  = texture2D(Lightmap, v_uv1.xy);\r\n\t\t\tFragment.xyz\t  += Fragment.xyz * (tex_lightmap.w * LightmapFactor) * tex_lightmap.xyz;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef LIGHTING\r\n\t\t\tFragment.xyz += Fragment.xyz * Ambient.xyz;\t\t\t\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef LIGHTING_VERTEX\r\n\t\t\tDiffuseComponent  = v_diffuse_component;\t\t\t\r\n\t\t\t#ifdef SPECULAR\r\n\t\t\tSpecularComponent = v_specular_component;\r\n\t\t\t#endif\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef LIGHTING_PIXEL\t\t\t\r\n\t\t\tProcessLights(Normal,WorldViewDir,Shininess,DiffuseComponent,SpecularComponent);\t\t\t\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef LIGHTING\r\n\t\t\tFragment.xyz += Fragment.xyz * DiffuseComponent;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef SPECULAR\t\t\t\r\n\t\t\t\r\n\t\t\t#ifdef SPECULAR_ALPHA\r\n\t\t\tSpecularComponent *= tex_diffuse.a;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef SPECULAR_TEXTURE\r\n\t\t\t\r\n\t\t\tvec4 tex_specular = texture2D(SpecularTexture, v_uv0.xy);\r\n\t\t\tSpecularComponent *= tex_specular.xyz;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tFragment.xyz += SpecularComponent;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef FALLOFF_VERTEX\r\n\t\t\tFalloffComponent = v_falloff_component;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef FALLOFF_PIXEL\r\n\t\t\tFalloffComponent = Falloff(WorldViewDir, Normal, FalloffExp) * FalloffIntensity * FalloffColor.xyz;\t\t\t\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef FALLOFF\t\t\t\r\n\t\t\tFragment.xyz += FalloffComponent;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef EMISSIVE\r\n\t\t\tFragment.xyz += EmissiveColor.xyz;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tfloat FogComponent = 0.0;\r\n\t\t\t\r\n\t\t\t#ifdef FOG_VERTEX\r\n\t\t\tFogComponent = v_fog_component;\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef FOG_PIXEL\r\n\t\t\tFogComponent = FogFactor(v_linear_depth, FogExp, FogDensity, FogStart, FogEnd);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\t#ifdef FOG\r\n\t\t\tFragment = mix(Fragment, FogColor,FogComponent);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tgl_FragColor = Fragment;\r\n\t\t}\r\n\t\t"},
__class__:ga,__properties__:s(mb.prototype.__properties__,{set_features:"set_features",get_features:"get_features"})});var Fa=function(a){null==a&&(a="");v.call(this,a);this.m_attribs=[];this.m_indexed=!1;this.m_vcount=0;this.m_bounds=ba.get_empty();this.m_mode=35044;this.primitive=4;this.m_topology_attrib=new Hc;this.m_topology_attrib.m_name="$topology";this.m_topology_attrib.offset=1;g.mesh.Create(this)};k["haxor.graphics.mesh.Mesh"]=Fa;Fa.__name__=["haxor","graphics","mesh","Mesh"];Fa.__super__=
v;Fa.prototype=s(v.prototype,{get_topology:function(){return null==this.m_topology_attrib.data?new nb(0):this.m_topology_attrib.data},set_topology:function(a){null==a?(this.m_topology_attrib.data=null,this.m_indexed=!1,g.mesh.RemoveAttrib(this.m_topology_attrib,this)):(this.m_topology_attrib.data=a,this.m_indexed=!0,g.mesh.UpdateAttrib(this.m_topology_attrib,this.m_mode,!0,this));return a},get_indexed:function(){return this.m_indexed},get_mode:function(){return this.m_mode},set_mode:function(a){if(this.m_mode==
a)return a;this.m_mode=a;this.m_indexed&&g.mesh.UpdateAttrib(this.m_topology_attrib,this.m_mode,!0,this);for(var b=0,c=this.m_attribs.length;b<c;){var d=b++;g.mesh.UpdateAttrib(this.m_attribs[d],this.m_mode,!1,this)}return a},get_attribs:function(){for(var a=[],b=0,c=this.m_attribs.length;b<c;){var d=b++;a.push(this.m_attribs[d].m_name)}return a},get_vcount:function(){return this.m_vcount},get_bounds:function(){return this.m_bounds},set_bounds:function(a){return this.m_bounds.SetAABB3(a)},Clear:function(a){null==
a&&(a=!0);for(var b=0,c=this.m_attribs.length;b<c;){var d=b++;this.m_attribs[d].data=null;this.m_attribs[d].m_name="";a&&g.mesh.RemoveAttrib(this.m_attribs[d],this)}this.m_vcount=0;a?this.set_topology(null):this.m_topology_attrib.data=null},Exists:function(a){return null!=this.GetAttribute(a)},Get:function(a){a=this.GetAttribute(a);return null==a?null:a.data},GetAttribute:function(a){for(var b=0,c=this.m_attribs.length;b<c;){var d=b++;if(this.m_attribs[d].m_name==a)return this.m_attribs[d]}return null},
Remove:function(a){a=this.GetAttribute(a);null!=a&&(E.remove(this.m_attribs,a),g.mesh.RemoveAttrib(a,this))},Set:function(a,b,c){null==c&&(c=0);if(null==b)return u.Log("Mesh> ["+this.get_name()+"] tried to set null array.",1),null;var d=this.GetAttribute(a);null==d&&(d=new Hc,d.m_name=a,this.m_attribs.push(d));0<c&&(d.offset=c);d.data=b;this.m_vcount=this.m_attribs[0].get_count();a=1;for(b=this.m_attribs.length;a<b;)c=a++,c=this.m_attribs[c].get_count(),this.m_vcount=this.m_vcount<c?this.m_vcount:
c;g.mesh.UpdateAttrib(d,this.m_mode,!1,this);return d},GenerateAttribBounds:function(a,b){var c;c=null==b?ba.get_empty():b;var d=this.GetAttribute(a);if(null==d)return c.Set(0,0,0,0,0,0);var f=d.offset;if(0>=f)return c.Set(0,0,0,0,0,0);var e=f,d=d.data,g;g=0<f?d.Get(0):0;var h;h=1<f?d.Get(1):0;var k;k=2<f?d.Get(2):0;for(c.Set(g,g,h,h,k,k);e<d.m_length;)g=0<f?d.Get(e):0,h=1<f?d.Get(e+1):0,k=2<f?d.Get(e+2):0,c.Encapsulate3(g,h,k),e+=f;return c},OnDestroy:function(){g.mesh.Destroy(this)},__class__:Fa,
__properties__:s(v.prototype.__properties__,{set_bounds:"set_bounds",get_bounds:"get_bounds",get_vcount:"get_vcount",get_attribs:"get_attribs",set_mode:"set_mode",get_mode:"get_mode",get_indexed:"get_indexed",set_topology:"set_topology",get_topology:"get_topology"})});var Hc=function(){this.__cid=g.mesh.aid.get_id();this._loc_=-1;this.m_name="";this.data=null;this.offset=0};k["haxor.graphics.mesh.MeshAttrib"]=Hc;Hc.__name__=["haxor","graphics","mesh","MeshAttrib"];Hc.prototype={get_name:function(){return this.m_name},
get_count:function(){return null==this.data?0:this.data.m_length/this.offset|0},__class__:Hc,__properties__:{get_count:"get_count",get_name:"get_name"}};var ua=function(a){null==a&&(a="");Fa.call(this,a);this.m_vertex=[];this.m_normal=[];this.m_color=[];this.m_uv0=[];this.m_uv1=[];this.m_tangent=[];this.m_binormal=[]};k["haxor.graphics.mesh.MeshLayout"]=ua;ua.__name__=["haxor","graphics","mesh","MeshLayout"];ua.__super__=Fa;ua.prototype=s(Fa.prototype,{get_vertex:function(){return this.m_vertex},
set_vertex:function(a){return this.m_vertex=this.UpdateAttribute("vertex",a,!1)},get_normal:function(){return this.m_normal},set_normal:function(a){return this.m_normal=this.UpdateAttribute("normal",a,!1)},get_color:function(){return this.m_color},set_color:function(a){return this.m_color=this.UpdateAttribute("color",a,!0)},get_uv0:function(){return this.m_uv0},set_uv0:function(a){return this.m_uv0=this.UpdateAttribute("uv0",a,!1)},get_uv1:function(){return this.m_uv1},set_uv1:function(a){return this.m_uv1=
this.UpdateAttribute("uv1",a,!1)},get_tangent:function(){return this.m_tangent},set_tangent:function(a){return this.m_tangent=this.UpdateAttribute("tangent",a,!1)},get_binormal:function(){return this.m_binormal},set_binormal:function(a){return this.m_binormal=this.UpdateAttribute("binormal",a,!1)},GenerateBounds:function(){this.GenerateAttribBounds("vertex",this.m_bounds)},UpdateAttribute:function(a,b,c){null==c&&(c=!1);if(null==b||0>=b.length)return this.Remove(a),[];var d=this.GetAttribute(a),f=
1;J.__instanceof(b[0],K)&&(f=2);J.__instanceof(b[0],n)&&(f=3);J.__instanceof(b[0],Q)&&(f=4);J.__instanceof(b[0],t)&&(f=4);null==d&&(d=this.Set(a,new L(1),f));for(var e=0,d=d.data=new L(b.length*f),g=0,h=b.length;g<h;){var k=g++,k=b[k];switch(f){case 1:d.Set(e++,k);break;case 2:d.Set(e++,k.x);d.Set(e++,k.y);break;case 3:d.Set(e++,k.x);d.Set(e++,k.y);d.Set(e++,k.z);break;case 4:c?(d.Set(e++,k.r),d.Set(e++,k.g),d.Set(e++,k.b),d.Set(e++,k.a)):(d.Set(e++,k.x),d.Set(e++,k.y),d.Set(e++,k.z),d.Set(e++,k.w))}}this.Set(a,
d,f);return b},__class__:ua,__properties__:s(Fa.prototype.__properties__,{set_binormal:"set_binormal",get_binormal:"get_binormal",set_tangent:"set_tangent",get_tangent:"get_tangent",set_uv1:"set_uv1",get_uv1:"get_uv1",set_uv0:"set_uv0",get_uv0:"get_uv0",set_color:"set_color",get_color:"get_color",set_normal:"set_normal",get_normal:"get_normal",set_vertex:"set_vertex",get_vertex:"get_vertex"})});var Ka=function(a){ua.call(this,a)};k["haxor.graphics.mesh.Mesh3"]=Ka;Ka.__name__=["haxor","graphics","mesh",
"Mesh3"];Ka.__super__=ua;Ka.prototype=s(ua.prototype,{__class__:Ka});var Ic=function(a){ua.call(this,a)};k["haxor.graphics.mesh.SkinnedMesh3"]=Ic;Ic.__name__=["haxor","graphics","mesh","SkinnedMesh3"];Ic.__super__=Ka;Ic.prototype=s(Ka.prototype,{get_binds:function(){return this.m_binds},set_binds:function(a){this.m_binds=a.slice();return a},get_bone:function(){return this.m_bone},set_bone:function(a){return this.m_bone=this.UpdateAttribute("bone",a,!1)},get_weight:function(){return this.m_weight},
set_weight:function(a){return this.m_weight=this.UpdateAttribute("weight",a,!1)},__class__:Ic,__properties__:s(Ka.prototype.__properties__,{set_weight:"set_weight",get_weight:"get_weight",set_bone:"set_bone",get_bone:"get_bone",set_binds:"set_binds",get_binds:"get_binds"})});var nd=function(a){ua.call(this,a)};k["haxor.graphics.mesh.Mesh2D"]=nd;nd.__name__=["haxor","graphics","mesh","Mesh2D"];nd.__super__=ua;nd.prototype=s(ua.prototype,{__class__:nd});var od=function(a){ua.call(this,a)};k["haxor.graphics.mesh.Mesh23"]=
od;od.__name__=["haxor","graphics","mesh","Mesh23"];od.__super__=ua;od.prototype=s(ua.prototype,{__class__:od});var pd=function(a){ua.call(this,a)};k["haxor.graphics.mesh.Mesh2"]=pd;pd.__name__=["haxor","graphics","mesh","Mesh2"];pd.__super__=ua;pd.prototype=s(ua.prototype,{__class__:pd});var qd=function(a){ua.call(this,a)};k["haxor.graphics.mesh.Mesh4"]=qd;qd.__name__=["haxor","graphics","mesh","Mesh4"];qd.__super__=ua;qd.prototype=s(ua.prototype,{__class__:qd});var W=function(){};k["haxor.graphics.mesh.Model"]=
W;W.__name__=["haxor","graphics","mesh","Model"];W.__properties__={get_tetrahedron:"get_tetrahedron",get_cube:"get_cube",get_planeYZ:"get_planeYZ",get_planeXZ:"get_planeXZ",get_planeXY:"get_planeXY",get_point:"get_point",get_screen:"get_screen"};W.get_screen=function(){if(null!=W.m_screen)return W.m_screen;var a=new Fa("$ModelScreen"),b=L.Alloc([-1,1,0,-1,-1,0,1,-1,0,1,1,0]),c=L.Alloc([0,0,0,1,0,0,1,1,0,0,1,0]);a.Set("vertex",b,3);a.Set("uv0",c,3);a.set_bounds(a.GenerateAttribBounds("vertex",g.data.get_aabb3()));
a.set_topology(nb.Alloc([0,1,2,0,2,3]));return W.m_screen=a};W.get_point=function(){if(null!=W.m_point)return W.m_point;var a=new Fa("$ModelPoint"),b=L.Alloc([0,0,0]),c=L.Alloc([0,0,1]);a.Set("vertex",b,3);a.Set("normal",c,3);a.primitive=0;a.set_bounds(a.GenerateAttribBounds("vertex",g.data.get_aabb3()));return W.m_point=a};W.get_planeXY=function(){if(null!=W.m_planeXY)return W.m_planeXY;var a=new Fa("$ModelPlaneXY"),b=L.Alloc([-.5,.5,0,-.5,-.5,0,.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0]),c=L.Alloc([0,
1,0,0,0,0,1,0,0,0,1,0,1,0,0,1,1,0]),d=L.Alloc([0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]);a.Set("vertex",b,3);a.Set("uv0",c,3);a.Set("normal",d,3);a.set_bounds(a.GenerateAttribBounds("vertex",g.data.get_aabb3()));return W.m_planeXY=a};W.get_planeXZ=function(){if(null!=W.m_planeXZ)return W.m_planeXZ;var a=new Fa("$ModelPlaneXZ"),b=L.Alloc([-.5,0,.5,-.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5]),c=L.Alloc([0,1,0,0,0,0,1,0,0,0,1,0,1,0,0,1,1,0]),d=L.Alloc([0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]);a.Set("vertex",
b,3);a.Set("uv0",c,3);a.Set("normal",d,3);a.set_bounds(a.GenerateAttribBounds("vertex",g.data.get_aabb3()));return W.m_planeXZ=a};W.get_planeYZ=function(){if(null!=W.m_planeYZ)return W.m_planeYZ;var a=new Fa("$ModelPlaneYZ"),b=L.Alloc([0,-.5,.5,0,-.5,-.5,0,.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5]),c=L.Alloc([0,1,0,0,0,0,1,0,0,0,1,0,1,0,0,1,1,0]),d=L.Alloc([1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0]);a.Set("vertex",b,3);a.Set("uv0",c,3);a.Set("normal",d,3);a.set_bounds(a.GenerateAttribBounds("vertex",g.data.get_aabb3()));
return W.m_planeYZ=a};W.get_cube=function(){if(null!=W.m_cube)return W.m_cube;var a=new Fa("$ModelCube"),b=L.FromBase64("AAAAvwAAAL8AAAC/AAAAvwAAAD8AAAC/AAAAPwAAAD8AAAC/AAAAPwAAAD8AAAC/AAAAPwAAAL8AAAC/AAAAvwAAAL8AAAC/AAAAvwAAAL8AAAA/AAAAPwAAAL8AAAA/AAAAPwAAAD8AAAA/AAAAPwAAAD8AAAA/AAAAvwAAAD8AAAA/AAAAvwAAAL8AAAA/AAAAvwAAAL8AAAC/AAAAPwAAAL8AAAC/AAAAPwAAAL8AAAA/AAAAPwAAAL8AAAA/AAAAvwAAAL8AAAA/AAAAvwAAAL8AAAC/AAAAPwAAAL8AAAC/AAAAPwAAAD8AAAC/AAAAPwAAAD8AAAA/AAAAPwAAAD8AAAA/AAAAPwAAAL8AAAA/AAAAPwAAAL8AAAC/AAAAPwAAAD8AAAC/AAAAvwAAAD8AAAC/AAAAvwAAAD8AAAA/AAAAvwAAAD8AAAA/AAAAPwAAAD8AAAA/AAAAPwAAAD8AAAC/AAAAvwAAAD8AAAC/AAAAvwAAAL8AAAC/AAAAvwAAAL8AAAA/AAAAvwAAAL8AAAA/AAAAvwAAAD8AAAA/AAAAvwAAAD8AAAC/"),
c=L.FromBase64("AACAPwAAAAAAAAAAAACAPwAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAAAAAACAPwAAAAAAAAAAAAAAAAAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAgD8AAAAAAACAPwAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAgD8AAAAAAACAPwAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAgD8AAAAAAACAPwAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAgD8AAAAAAACAPwAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAgD8AAAAAAACAPwAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAAAA"),
d=L.FromBase64("AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIA/AAAAAAAAAAAAAIA/AAAAAAAAAAAAAIA/AAAAAAAAAAAAAIA/AAAAAAAAAAAAAIA/AAAAAAAAAAAAAIA/AAAAAAAAgL8AAAAAAAAAAAAAgL8AAAAAAAAAAAAAgL8AAAAAAAAAAAAAgL8AAAAAAAAAAAAAgL8AAAAAAAAAAAAAgL8AAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAAAAAAAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAgD8AAAAAAAAAAAAAgD8AAAAAAACAvwAAAAAAAAAAAACAvwAAAAAAAAAAAACAvwAAAAAAAAAAAACAvwAAAAAAAAAAAACAvwAAAAAAAAAAAACAvwAAAAAAAAAA");
a.Set("vertex",b,3);a.Set("uv0",c,3);a.Set("normal",d,3);a.set_bounds(a.GenerateAttribBounds("vertex",g.data.get_aabb3()));return W.m_cube=a};W.get_tetrahedron=function(){if(null!=W.m_tetrahedron)return W.m_tetrahedron;var a=new Fa("$ModelTetrahedron"),b=L.FromBase64("AAAAAAAAAAAAAAAAsb+cvpm/Bz8AAAAAsb8cPwAAAAAAAAAAAAAAAAAAAAAAAAAArr+cvpu/B78AAAAAsb+cvpm/Bz8AAAAAAAAAAAAAAAAAAAAAsb8cPwAAAAAAAAAArr+cvpu/B78AAAAAsb8cPwAAAAAAAAAAAAAAAAAAAACX/1A/AAAAAAAAAACX/1A/sb8cPwAAAAAAAAAAsb+cvpm/Bz8AAAAAAAAAAAAAAACX/1A/sb+cvpm/Bz8AAAAAAAAAAAAAAACX/1A/AAAAAAAAAACX/1A/sb+cvpm/Bz8AAAAArr+cvpu/B78AAAAAAAAAAAAAAACX/1A/rr+cvpu/B78AAAAAAAAAAAAAAACX/1A/AAAAAAAAAACX/1A/rr+cvpu/B78AAAAAsb8cPwAAAAAAAAAAAAAAAAAAAACX/1A/AAAAAAAAAACX/1A/AAAAAAAAAACX/1A/AAAAAAAAAACX/1A/AAAAAAAAAACX/1A/AAAAAAAAAACX/1A/AAAAAAAAAACX/1A/AAAAAAAAAACX/1A/AAAAAAAAAACX/1A/AAAAAAAAAACX/1A/"),
c=L.FromBase64("AAAAPwAAAAAAAAAAraqqPQAAAAAAAIA/AACAvgAAAAAAAIA/AAAAPwAAAAAAAAAAVlXVPgAAAAD+/38/raqqPQAAAAAAAIA/AAAAPwAAAAAAAAAAAABAPwAAAAAAAIA/VlXVPgAAAAD+/38/AABAPwAAAAAAAIA/AAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAAACAvgAAAAAAAIA/raqqPQAAAAAAAIA/AAAAPwAAgD8AAAAAraqqPQAAAAAAAIA/AAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAraqqPQAAAAAAAIA/VlXVPgAAAAD+/38/AAAAPwAAgD8AAAAAVlXVPgAAAAD+/38/AAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAVlXVPgAAAAD+/38/AABAPwAAAAAAAIA/AAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAAAAAAPwAAgD8AAAAA"),
d=L.FromBase64("AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AAAAAAAAAAAAAIC/AACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAQrPvPiWWTz9yxrM+QrPvPiWWTz9yxrM+QrPvPiWWTz9yxrM+AACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAARbNvv4aDqbNyxrM+RbNvv4aDqbN2xrM+RLNvv4aDqbNyxrM+AACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAARbPvPiWWT792xrM+SbPvPiWWT792xrM+RbPvPiWWT792xrM+AACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAAAACAPwAAAAAAAAAA");
a.Set("vertex",b,3);a.Set("uv0",c,3);a.Set("normal",d,3);a.set_bounds(a.GenerateAttribBounds("vertex",g.data.get_aabb3()));return W.m_tetrahedron=a};var fc=function(a,b,c){v.call(this);this.m_width=a;this.m_height=b;this.m_format=c;this.m_half=this.m_float=!1;this.m_channels=1;switch(c[1]){case 1:this.m_channels=1;break;case 0:this.m_channels=1;break;case 2:this.m_channels=3;break;case 3:this.m_channels=4;break;case 10:this.m_channels=1;this.m_float=!0;break;case 7:this.m_channels=1;this.m_float=
!0;break;case 4:this.m_channels=1;this.m_half=this.m_float=!0;break;case 8:this.m_channels=3;this.m_float=!0;break;case 5:this.m_channels=3;this.m_half=this.m_float=!0;break;case 9:this.m_channels=4;this.m_float=!0;break;case 6:this.m_channels=4;this.m_half=this.m_float=!0;break;case 11:this.m_channels=3;break;case 12:this.m_channels=4;break;case 13:this.m_channels=4}a=this.m_width*this.m_height*this.m_channels;this.m_buffer=this.m_float?new L(a):new qa(a)};k["haxor.graphics.texture.Bitmap"]=fc;fc.__name__=
["haxor","graphics","texture","Bitmap"];fc.__super__=v;fc.prototype=s(v.prototype,{get_buffer:function(){return this.m_buffer},get_float:function(){return this.m_float},get_half:function(){return this.m_half},get_width:function(){return this.m_width},get_height:function(){return this.m_height},get_channels:function(){return this.m_channels},get_format:function(){return this.m_format},GetPixel:function(a,b){if(0>a||0>b||a>=this.m_width||b>=this.m_height)return new t;b=this.m_height-1-b;var c=this.m_channels,
d=(a+b*this.m_width)*c;if(this.m_float){var f=new t,e=this.m_buffer;switch(c){case 1:f.r=e.Get(d);f.g=f.r;f.b=f.r;f.a=1;break;case 2:f.r=e.Get(d);f.g=e.Get(d+1);f.b=f.r;f.a=1;break;case 3:f.r=e.Get(d);f.g=e.Get(d+1);f.b=e.Get(d+2);f.a=1;break;case 4:f.r=e.Get(d),f.g=e.Get(d+1),f.b=e.Get(d+2),f.a=e.Get(d+3)}return f}var g=this.m_buffer,f=g.GetByte(d),e=2<=c?g.GetByte(d+1):f,h;h=3<=c?g.GetByte(d+2):f;c=4<=c?g.GetByte(d+3):f;return t.FromBytes(f,e,h,c)},SetPixel:function(a,b,c){if(!(0>a||0>b||a>=this.m_width||
b>=this.m_height)){b=this.m_height-1-b;var d=this.m_channels;a=(a+b*this.m_width)*d;this.m_float?(b=this.m_buffer,b.Set(a,c.r),2<=d&&b.Set(a+1,c.g),3<=d&&b.Set(a+2,c.b),4<=d&&b.Set(a+3,c.a)):(b=this.m_buffer,b.SetByte(a,255*c.r),2<=d&&b.SetByte(a+1,255*c.g),3<=d&&b.SetByte(a+2,255*c.b),4<=d&&b.SetByte(a+3,255*c.a))}},SetPixels:function(a,b,c,d,f){null==f&&(f=-1);null==d&&(d=-1);null==c&&(c=0);null==b&&(b=0);var e;e=0>d?this.m_width:d;f=0>f?this.m_height:f;d=0;var g=b;for(b+=e;g<b;){e=g++;for(var h=
c,k=c+f;h<k;){var l=h++;this.SetPixel(e,l,a[d++]);if(d>=a.length)break}if(d>=a.length)break}},Fill:function(a){for(var b=0,c=this.m_width;b<c;)for(var d=b++,f=0,e=this.m_height;f<e;){var g=f++;this.SetPixel(d,g,a)}},Set:function(a,b,c,d,f,e){null==e&&(e=0);null==f&&(f=0);null==d&&(d=0);null==c&&(c=0);var g=this.m_channels;b=this.m_height-1-b;a=(a+b*this.m_width)*g;this.m_float?(b=this.m_buffer,b.Set(a,c),2<=g&&b.Set(a+1,d),3<=g&&b.Set(a+2,f),4<=g&&b.Set(a+3,e)):(b=this.m_buffer,b.SetByte(a,255*c),
2<=g&&b.SetByte(a+1,255*d),3<=g&&b.SetByte(a+2,255*f),4<=g&&b.SetByte(a+3,255*e))},SetRange:function(a,b,c,d,f){null==f&&(f=-1);null==d&&(d=-1);null==c&&(c=0);null==b&&(b=0);c=this.m_height-1-c;var e=this.m_channels,g=a.length,h=0,k=b,l=c,n=0,p=0,q=0,r=0;d=0>d?this.m_width:d;f=0>f?this.m_height:f;for(var s=0;s<g;){s++;var t=(k+l*this.m_width)*e;k++;if(k>=b+d&&(k=b,l++,l>=c+f))break;n=a[h++];2<=e&&(p=a[h++]);3<=e&&(q=a[h++]);4<=e&&(r=a[h++]);if(this.m_float){var u=this.m_buffer;u.Set(t,n);2<=e&&u.Set(t+
1,p);3<=e&&u.Set(t+2,q);4<=e&&u.Set(t+3,r)}else u=this.m_buffer,u.SetByte(t,255*n),2<=e&&u.SetByte(t+1,255*p),3<=e&&u.SetByte(t+2,255*q),4<=e&&u.SetByte(t+3,255*r)}},__class__:fc,__properties__:s(v.prototype.__properties__,{get_format:"get_format",get_channels:"get_channels",get_height:"get_height",get_width:"get_width",get_half:"get_half",get_float:"get_float",get_buffer:"get_buffer"})});var Ia=function(){v.call(this);this.m_mipmaps=!1;this.m_format=y.RGBA8;this.m_magFilter=this.m_minFilter=V.Linear;
this.m_wrap=Da.ClampX|Da.ClampY|Da.ClampZ;this.m_aniso=this.m_height=this.m_width=0;this.__cid=g.texture.tid.get_id()};k["haxor.graphics.texture.Texture"]=Ia;Ia.__name__=["haxor","graphics","texture","Texture"];Ia.__super__=v;Ia.prototype=s(v.prototype,{get_width:function(){return this.m_width},get_height:function(){return this.m_height},get_format:function(){return this.m_format},get_wrap:function(){return this.m_wrap},set_wrap:function(a){if(this.m_wrap==a)return a;this.m_wrap=a;g.texture.UpdateParameters(this);
return a},get_aniso:function(){return this.m_aniso},set_aniso:function(a){if(this.m_aniso==a)return a;this.m_aniso=a;g.texture.UpdateParameters(this);return a},get_minFilter:function(){return this.m_minFilter},set_minFilter:function(a){if(this.m_minFilter==a)return a;this.m_minFilter=a;g.texture.UpdateParameters(this);return a},get_magFilter:function(){return this.m_magFilter},set_magFilter:function(a){if(this.m_magFilter==a)return a;this.m_magFilter=a;g.texture.UpdateParameters(this);return a},get_mipmaps:function(){return this.m_mipmaps},
get_type:function(){return N.None},Apply:function(){g.texture.Update(this)},GenerateMipmaps:function(){this.m_mipmaps||(this.m_mipmaps=!0,g.texture.UpdateMipmaps(this))},OnDestroy:function(){v.prototype.OnDestroy.call(this);g.texture.Destroy(this)},__class__:Ia,__properties__:s(v.prototype.__properties__,{get_type:"get_type",get_mipmaps:"get_mipmaps",set_magFilter:"set_magFilter",get_magFilter:"get_magFilter",set_minFilter:"set_minFilter",get_minFilter:"get_minFilter",set_aniso:"set_aniso",get_aniso:"get_aniso",
set_wrap:"set_wrap",get_wrap:"get_wrap",get_format:"get_format",get_height:"get_height",get_width:"get_width"})});var z=function(a,b,c){Ia.call(this);this.m_format=c;this.m_width=a;this.m_height=b;0>=a||0>=b||(this.m_data=new fc(a,b,c),g.texture.Create(this))};k["haxor.graphics.texture.Texture2D"]=z;z.__name__=["haxor","graphics","texture","Texture2D"];z.__properties__={get_green:"get_green",get_red:"get_red",get_gray25:"get_gray25",get_gray50:"get_gray50",get_black:"get_black",get_white:"get_white",
get_random:"get_random"};z.get_random=function(){if(null!=z.m_random)return z.m_random;z.m_random=new z(128,128,y.Float4);z.m_random.set_name("Random");z.m_random.set_wrap(Da.RepeatX|Da.RepeatY|Da.RepeatZ);for(var a=z.m_random.m_data.get_buffer(),b=0,c=a.m_length;b<c;){var d=b++;a.Set(d,Math.random())}z.m_random.Upload(10);return z.m_random};z.get_white=function(){if(null!=z.m_white)return z.m_white;z.m_white=new z(1,1,y.RGB8);z.m_white.set_name("White");z.m_white.m_data.Fill(new t(1,1,1,1));z.m_white.Apply();
return z.m_white};z.get_black=function(){if(null!=z.m_black)return z.m_black;z.m_black=new z(1,1,y.RGB8);z.m_black.set_name("Black");z.m_black.m_data.Fill(new t(0,0,0,1));z.m_black.Apply();return z.m_black};z.get_gray50=function(){if(null!=z.m_gray50)return z.m_gray50;z.m_gray50=new z(1,1,y.RGB8);z.m_gray50.set_name("Gray50");z.m_gray50.m_data.Fill(new t(.5,.5,.5,1));z.m_gray50.Apply();return z.m_gray50};z.get_gray25=function(){if(null!=z.m_gray25)return z.m_gray25;z.m_gray25=new z(1,1,y.RGB8);z.m_gray25.set_name("Gray25");
z.m_gray25.m_data.Fill(new t(.25,.25,.25,1));z.m_gray25.Apply();return z.m_gray25};z.get_red=function(){if(null!=z.m_red)return z.m_red;z.m_red=new z(1,1,y.RGB8);z.m_red.set_name("Red");z.m_red.m_data.Fill(new t(1,0,0,1));z.m_red.Apply();return z.m_red};z.get_green=function(){if(null!=z.m_green)return z.m_green;z.m_green=new z(1,1,y.RGB8);z.m_green.set_name("Green");z.m_green.m_data.Fill(new t(0,1,0,1));z.m_green.Apply();return z.m_green};z.FromBitmap=function(a,b){var c=new z(0,0,a.m_format);c.m_data=
a;c.m_width=a.m_width;c.m_height=a.m_height;g.texture.Create(c);c.Apply();return c};z.__super__=Ia;z.prototype=s(Ia.prototype,{get_data:function(){return this.m_data},get_type:function(){return N.Texture2D},Upload:function(a,b){null==a&&(a=200);g.texture.UploadTexture(this,0,0,this.m_width,this.m_height,a,b)},__class__:z,__properties__:s(Ia.prototype.__properties__,{get_data:"get_data"})});var Rb=function(a,b,c){z.call(this,a,b,c);this.set_minFilter(V.Nearest);this.set_magFilter(V.Nearest);this.m_dirty=
this.m_lock=!1};k["haxor.graphics.texture.ComputeTexture"]=Rb;Rb.__name__=["haxor","graphics","texture","ComputeTexture"];Rb.__super__=z;Rb.prototype=s(z.prototype,{get_type:function(){return N.Compute},Write:function(a,b,c,d,f,e){null==e&&(e=0);null==f&&(f=0);null==d&&(d=0);null==c&&(c=0);this.m_data.SetPixel(a,b,g.data.get_c().Set(c,d,f,e));this.m_dirty=!0;this.Invalidate()},WriteRange:function(a,b,c,d,f){null==f&&(f=-1);null==d&&(d=-1);null==c&&(c=0);null==b&&(b=0);this.m_data.SetRange(a,b,c,0>
d?this.m_width:d,0>f?this.m_height:f);this.Invalidate();this.m_dirty=!0},Invalidate:function(){this.Apply()},OnUploadComplete:function(){this.m_lock=!1;this.m_dirty&&this.Invalidate();this.m_dirty=!1},__class__:Rb});var Db=function(a,b,c,d){null==d&&(d=!1);Ia.call(this);this.m_format=c;this.m_width=a|0;this.m_height=b|0;d&&e.TEXTURE_DEPTH_ENABLED&&(this.m_depth=new z(this.m_width,this.m_height,y.Depth));g.texture.Create(this)};k["haxor.graphics.texture.RenderTexture"]=Db;Db.__name__=["haxor","graphics",
"texture","RenderTexture"];Db.__super__=Ia;Db.prototype=s(Ia.prototype,{get_depth:function(){return this.m_depth},get_type:function(){return N.RenderTexture},__class__:Db,__properties__:s(Ia.prototype.__properties__,{get_depth:"get_depth"})});var Jc=function(){this.m_faces=[null,null,null,null,null,null];Ia.call(this);g.texture.Create(this)};k["haxor.graphics.texture.TextureCube"]=Jc;Jc.__name__=["haxor","graphics","texture","TextureCube"];Jc.__super__=Ia;Jc.prototype=s(Ia.prototype,{get_px:function(){return this.m_faces[0]},
set_px:function(a){return this.m_faces[0]=a},get_nx:function(){return this.m_faces[1]},set_nx:function(a){return this.m_faces[1]=a},get_py:function(){return this.m_faces[2]},set_py:function(a){return this.m_faces[2]=a},get_ny:function(){return this.m_faces[3]},set_ny:function(a){return this.m_faces[3]=a},get_pz:function(){return this.m_faces[4]},set_pz:function(a){return this.m_faces[4]=a},get_nz:function(){return this.m_faces[5]},set_nz:function(a){return this.m_faces[5]=a},get_type:function(){return N.TextureCube},
LoadCrossTexture:function(a){g.texture.CrossToCubemap(this,a)},OnDestroy:function(){Ia.prototype.OnDestroy.call(this);for(var a=0,b=this.m_faces.length;a<b;){var c=a++;null!=this.m_faces[c]&&v.Destroy(this.m_faces[c])}},__class__:Jc,__properties__:s(Ia.prototype.__properties__,{set_nz:"set_nz",get_nz:"get_nz",set_pz:"set_pz",get_pz:"get_pz",set_ny:"set_ny",get_ny:"get_ny",set_py:"set_py",get_py:"get_py",set_nx:"set_nx",get_nx:"get_nx",set_px:"set_px",get_px:"get_px"})});var p=function(){};k["haxor.input.Input"]=
p;p.__name__=["haxor","input","Input"];p.__properties__={get_multitouch:"get_multitouch",get_joystick:"get_joystick",get_touches:"get_touches"};p.get_touches=function(){return p.m_touches};p.get_joystick=function(){return p.m_joysticks};p.get_multitouch=function(){return p.m_multitouch};p.GetInputState=function(a){return p.m_state.get(a)};p.Pressed=function(a){a=p.GetInputState(a);return a==R.Down||a==R.Hold};p.Down=function(a){return p.GetInputState(a)==R.Down};p.Hit=function(a){return p.GetInputState(a)==
R.Up};p.GetHoldTime=function(a){return p.m_hold.get(a)};p.Initialize=function(){p.m_state=new Pb;p.m_hold=new Pb;p.m_active=[];p.m_down=[];p.m_touches=[];p.m_api_touches=[];for(var a=0;10>a;)a++,p.m_api_touches.push(new rd);for(a=0;256>a;){var b=a++;p.m_state.set(b,R.None);p.m_hold.set(b,0);p.m_down.push(!1)}p.m_joysticks=[];p.m_api_joystick=[];for(a=0;10>a;)a++,p.m_api_joystick.push(new ab);p.mouse=new K;p.deltaMouse=new K;p.relativeMouse=new K;u.Log("Haxor> Input Initialize",4)};p.UpdateTouchFSM=
function(){for(var a=0,b=p.m_touches.length;a<b;){var c=a++;p.TouchFSM(p.m_touches[c])}};p.UpdateInput=function(){for(var a=0,b=p.m_active.length;a<b;){var c=a++;p.UpdateInputState(p.m_active[c],p.m_down[p.m_active[c]])}};p.TouchFSM=function(a){if(null!=a){var b=a.state,c=a.m_down;b==R.Up&&E.remove(p.m_touches,a);b==R.Hold&&(a.hold+=q.m_delta);a.state=p.InputStateFSM(b,c)}};p.UpdateInputState=function(a,b,c){null==c&&(c=!0);var d=p.m_state.get(a);null==d&&(d=R.None);var f=d,f=p.m_down[a];b=p.m_down[a]=
b;f||b&&p.m_active.push(a);!b&&f||!c||(d==R.Up&&(p.m_hold.set(a,0),E.remove(p.m_active,a)),d==R.Hold&&(c=p.m_hold.get(a),p.m_hold.set(a,c+q.m_delta)),f=p.InputStateFSM(d,b),d!=f&&p.m_state.set(a,f))};p.InputStateFSM=function(a,b){var c=a;switch(a[1]){case 0:b&&(c=R.Down);break;case 1:c=R.Hold;break;case 2:c=R.None;break;case 3:b||(c=R.Up)}return c};var Kc=function(){};k["haxor.input.InputHandler"]=Kc;Kc.__name__=["haxor","input","InputHandler"];Kc.prototype={Update:function(){p.UpdateInput();p.UpdateTouchFSM();
this.UpdateInput();p.emulateTouch&&(this.EmulateTouch(h.Mouse0,0),this.EmulateTouch(h.Mouse1,2),this.EmulateTouch(h.Mouse2,1))},UpdateInput:function(){},Clear:function(){p.wheel=0;p.deltaMouse.x=0;p.deltaMouse.y=0},OnMouseMove:function(a,b){p.deltaMouse.x=a-p.mouse.x;p.deltaMouse.y=b-p.mouse.y;p.mouse.x=a;p.mouse.y=b;p.relativeMouse.x=p.mouse.x/H.m_width;p.relativeMouse.y=p.mouse.y/H.m_height},OnMouseWheel:function(a){p.wheel=a},OnMouseButton:function(a,b){switch(a){case 0:p.UpdateInputState(h.Mouse0,
b,!1);break;case 1:p.UpdateInputState(h.Mouse1,b,!1);break;case 2:p.UpdateInputState(h.Mouse2,b,!1);break;case 3:p.UpdateInputState(h.Mouse3,b,!1);break;case 4:p.UpdateInputState(h.Mouse4,b,!1)}},OnKey:function(a,b){p.UpdateInputState(a,b,!1)},OnTouchStart:function(a,b,c,d,f,e,g){null==g&&(g=0);null==e&&(e=0);null==f&&(f=0);null==d&&(d=0);var h=p.m_api_touches[a];h.id=a;h.position.x=b;h.position.y=c;h.relativePosition.x=h.position.x/H.m_width;h.relativePosition.y=h.position.y/H.m_height;h.delta.x=
0;h.delta.y=0;h.pressure=e;h.radius.x=d;h.radius.y=f;h.angle=g;h.m_down=!0;0>p.m_touches.indexOf(h)&&p.m_touches.push(h)},OnTouchMove:function(a,b,c){a=p.m_api_touches[a];0<=a.id&&(a.delta.x=b-a.position.x,a.delta.y=c-a.position.y);a.position.x=b;a.position.y=c;a.relativePosition.x=a.position.x/H.m_width;a.relativePosition.y=a.position.y/H.m_height},OnTouchCancel:function(a){p.m_api_touches[a].m_down=!1},OnTouchEnd:function(a){p.m_api_touches[a].m_down=!1},OnJoystickStart:function(a,b){this.m_joystick=
null;var c=p.m_api_joystick[a];null!=c&&(this.m_joystick=c,0<=p.m_joysticks.indexOf(c)||(c.id=a,c.name=b,p.m_joysticks.push(c),ab.available=0<p.m_joysticks.length))},OnJoystickDataUpdate:function(a,b,c){null!=this.m_joystick&&(c?this.m_joystick.analog[a]=b:(this.m_joystick.button[a]=b,this.m_joystick.state[a]=p.InputStateFSM(this.m_joystick.state[a],this.m_joystick.button[a]>=ab.buttonBias),this.m_joystick.state[a]==R.Hold&&(this.m_joystick.hold[a]+=q.m_delta),this.m_joystick.state[a]==R.None&&(this.m_joystick.hold[a]=
0)))},OnJoystickAnalogUpdate:function(){if(null!=this.m_joystick){var a=ab.analogBias[0],b=ab.analogBias[1],c=1,d,f=this.m_joystick;d=f.analogLeft;d.x=f.analog[h.LeftAnalogueHor];c=0>d.x?-1:1;d.x=l.Clamp01((l.Abs(d.x)-a)/(b-a));d.x=c*(100*d.x|0)*.01;d.y=f.analog[h.LeftAnalogueVert];c=0>d.y?-1:1;d.y=l.Clamp01((l.Abs(d.y)-a)/(b-a));d.y=-c*(100*d.y|0)*.01;d.z=.5<f.button[h.LeftAnalogueStick]?1:0;d=f.analogRight;d.x=f.analog[h.RightAnalogueHor];c=0>d.x?-1:1;d.x=l.Clamp01((l.Abs(d.x)-a)/(b-a));d.x=c*(100*
d.x|0)*.01;d.y=f.analog[h.RightAnalogueVert];c=0>d.y?-1:1;d.y=l.Clamp01((l.Abs(d.y)-a)/(b-a));d.y=-c*(100*d.y|0)*.01;d.z=.5<f.button[h.RightAnalogueStick]?1:0;f.triggerLeft=f.button[h.LeftShoulderBottom];f.triggerLeft=l.Clamp01((f.triggerLeft-a)/(b-a));f.triggerRight=f.button[h.RightShoulderBottom];f.triggerRight=l.Clamp01((f.triggerRight-a)/(b-a))}},RequestJoystickVibration:function(a){},EmulateTouch:function(a,b){if(p.Down(a)){var c=g.data.get_v2();switch(b){case 0:c.Set2(p.mouse);break;case 1:c.Set(.5*
H.m_width,.5*H.m_height);break;case 2:c.Set(H.m_width*Math.random(),H.m_height*Math.random())}this.OnTouchStart(b,c.x,c.y)}0==b&&p.Pressed(a)&&0<p.deltaMouse.get_length()&&this.OnTouchMove(b,p.mouse.x,p.mouse.y);p.Hit(a)&&this.OnTouchEnd(b)},__class__:Kc};var ab=function(){var a=R.None;this.name="";this.id=-1;this.button=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.state=[a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a];this.hold=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.analog=[0,0,0,0,0,0,0,0];this.analogLeft=
new n;this.analogRight=new n;this.m_vibrationRight=this.m_vibrationLeft=this.triggerRight=this.triggerLeft=0};k["haxor.input.Joystick"]=ab;ab.__name__=["haxor","input","Joystick"];ab.prototype={get_vibrationLeft:function(){return this.m_vibrationLeft},set_vibrationLeft:function(a){if(0>=l.Abs(this.m_vibrationLeft-a))return a;this.m_vibrationLeft=a;p.m_handler.RequestJoystickVibration(this);return a},get_vibrationRight:function(){return this.m_vibrationRight},set_vibrationRight:function(a){if(0>=l.Abs(this.m_vibrationRight-
a))return a;this.m_vibrationRight=a;p.m_handler.RequestJoystickVibration(this);return a},Pressed:function(a){return this.state[a]==R.Hold||this.state[a]==R.Down},Down:function(a){return this.state[a]==R.Down},Hit:function(a){return this.state[a]==R.Up},ToString:function(a,b,c,d){null==d&&(d=!0);null==c&&(c=!0);null==b&&(b=!0);null==a&&(a=!0);var f;f="J"+this.id;a&&(f+=" AL"+this.analogLeft.ToString(1),f+=" AR"+this.analogRight.ToString(1));b&&(f+=" A["+(this.Pressed(h.ButtonA)?"1]":"0]"),f+=" B["+
(this.Pressed(h.ButtonB)?"1]":"0]"),f+=" X["+(this.Pressed(h.ButtonX)?"1]":"0]"),f+=" Y["+(this.Pressed(h.ButtonY)?"1]":"0]"),f+=" L["+(this.Pressed(h.LeftShoulder)?"1]":"0]"),f+=" R["+(this.Pressed(h.RightShoulder)?"1]":"0]"),f+=" LB["+(this.Pressed(h.LeftShoulderBottom)?"1]":"0]"),f+=" RB["+(this.Pressed(h.RightShoulderBottom)?"1]":"0]"),f+=" Start["+(this.Pressed(h.ButtonStart)?"1]":"0]"),f+=" Select["+(this.Pressed(h.ButtonSelect)?"1]":"0]"));d&&(f+=" PL["+(this.Pressed(h.PadLeft)?"1]":"0]"),
f+=" PR["+(this.Pressed(h.PadRight)?"1]":"0]"),f+=" PU["+(this.Pressed(h.PadTop)?"1]":"0]"),f+=" PD["+(this.Pressed(h.PadBottom)?"1]":"0]"));c&&(f+=" TL["+l.RoundPlaces(this.triggerLeft,1)+"]",f+=" TR["+l.RoundPlaces(this.triggerRight,1)+"]");return f},__class__:ab,__properties__:{set_vibrationRight:"set_vibrationRight",get_vibrationRight:"get_vibrationRight",set_vibrationLeft:"set_vibrationLeft",get_vibrationLeft:"get_vibrationLeft"}};var h=function(){};k["haxor.input.KeyCode"]=h;h.__name__=["haxor",
"input","KeyCode"];var rd=function(){this.state=R.None;this.id=-1;this.position=new K;this.delta=new K;this.relativePosition=new K;this.angle=this.hold=this.pressure=0;this.radius=new K;this.m_down=!1};k["haxor.input.Touch"]=rd;rd.__name__=["haxor","input","Touch"];rd.prototype={get_down:function(){return this.state==R.Down},get_pressed:function(){return this.get_down()||this.state==R.Hold},get_hit:function(){return this.state==R.Up},ToString:function(){return"id["+this.id+"] pos"+this.position.ToString(2)+
"["+w.string(this.state)+"]"},__class__:rd,__properties__:{get_hit:"get_hit",get_pressed:"get_pressed",get_down:"get_down"}};var qa=function(a){this.Resize(a)};k["haxor.io.Buffer"]=qa;qa.__name__=["haxor","io","Buffer"];qa.FromString=function(a){var b=new qa(a.length);b.SetString(a);return b};qa.prototype={get_buffer:function(){return this.m_buffer},get_byteLength:function(){return this.m_length*this.get_bytesPerElement()},get_bytesPerElement:function(){return 1},get_length:function(){return this.m_length},
Resize:function(a){this.m_length=a;a=this.m_length*this.get_bytesPerElement();this.m_offset=0;this.aux=this.m_buffer=new Uint8Array(a)},GetByte:function(a){return this.m_buffer[a]},SetByte:function(a,b){this.m_buffer[a]=b},SetBytes:function(a,b){null==b&&(b=0);for(var c=0,d=a.length;c<d;){var f=c++;this.SetByte(f+b,a[f])}},SetBuffer:function(a,b){null==b&&(b=0);for(var c=0,d=a.m_length*a.get_bytesPerElement();c<d;){var f=c++;this.SetByte(f+b,a.GetByte(f))}},EncodeBase64:function(){for(var a=bb.alloc(this.m_length*
this.get_bytesPerElement()),b=0,c=a.length;b<c;){var d=b++;a.set(d,this.GetByte(d))}a=kb.encode(a);b=w["int"](a.length/this.get_bytesPerElement());this.Resize(b);this.SetString(a);return a},DecodeBase64:function(){var a=this.GetString(),a=kb.decode(a),b=w["int"](a.length/this.get_bytesPerElement());this.Resize(b);for(var b=0,c=a.length;b<c;){var d=b++;this.SetByte(d,a.b[d])}},GetString:function(a,b){null==b&&(b=0);null==a&&(a=0);var c;c=0>=b?this.m_length*this.get_bytesPerElement():b;for(var d=new Ib,
f=0;f<c;){var e=f++;d.addChar(this.GetByte(e+a))}return d.b},SetString:function(a,b){null==b&&(b=0);for(var c=0,d=a.length;c<d;){var f=c++;this.SetByte(f+b,E.cca(a,f))}},SetViewSlice:function(a,b){var c=a*this.get_bytesPerElement(),d=c+b*this.get_bytesPerElement();this.orig=this.aux;1==this.get_bytesPerElement()&&(this.aux=this.aux.subarray(c,d))},ResetSlice:function(){this.aux=this.orig},__class__:qa,__properties__:{get_length:"get_length",get_bytesPerElement:"get_bytesPerElement",get_byteLength:"get_byteLength",
get_buffer:"get_buffer"}};var L=function(a){this.Resize(a)};k["haxor.io.FloatArray"]=L;L.__name__=["haxor","io","FloatArray"];L.Alloc=function(a){var b=new L(a.length);b.SetRange(a);return b};L.FromBase64=function(a){var b=new L(a.length/4|0);b.SetString(a);b.DecodeBase64();return b};L.Parse=function(a,b){null==b&&(b=" ");for(var c=a.split(b),d=new L(c.length),f=0,e=c.length;f<e;){var g=f++;d.Set(g,w.parseFloat(B.trim(c[g])))}return d};L.__super__=qa;L.prototype=s(qa.prototype,{get_bytesPerElement:function(){return 4},
Resize:function(a){qa.prototype.Resize.call(this,a);this.aux=new Float32Array(this.m_buffer.buffer)},Get:function(a){return this.aux[a]},Set:function(a,b){this.aux[a]=b},SetRange:function(a,b){null==b&&(b=0);for(var c=0,d=a.length;c<d;){var f=c++;this.Set(f+b,a[f])}},SetViewSlice:function(a,b){qa.prototype.SetViewSlice.call(this,a,b);this.aux=this.aux.subarray(a,a+b)},__class__:L});var wb=function(a){this.Resize(a)};k["haxor.io.Int32Array"]=wb;wb.__name__=["haxor","io","Int32Array"];wb.Alloc=function(a){var b=
new wb(a.length);b.SetRange(a);return b};wb.Parse=function(a,b){null==b&&(b=" ");for(var c=a.split(b),d=new wb(c.length),f=0,e=c.length;f<e;){var g=f++;d.Set(g,w.parseInt(B.trim(c[g])))}return d};wb.__super__=qa;wb.prototype=s(qa.prototype,{get_bytesPerElement:function(){return 4},Resize:function(a){qa.prototype.Resize.call(this,a);this.aux=new Int32Array(this.m_buffer.buffer)},Get:function(a){return this.aux[a]},Set:function(a,b){this.aux[a]=b},SetRange:function(a,b){null==b&&(b=0);for(var c=0,d=
a.length;c<d;){var f=c++;this.Set(f+b,a[f])}},SetViewSlice:function(a,b){qa.prototype.SetViewSlice.call(this,a,b);this.aux=this.aux.subarray(a,a+b)},__class__:wb});var nb=function(a){this.Resize(a)};k["haxor.io.UInt16Array"]=nb;nb.__name__=["haxor","io","UInt16Array"];nb.Alloc=function(a){var b=new nb(a.length);b.SetRange(a);return b};nb.Parse=function(a,b){null==b&&(b=" ");for(var c=a.split(b),d=new nb(c.length),f=0,e=c.length;f<e;){var g=f++;d.Set(g,w.parseInt(B.trim(c[g])))}return d};nb.__super__=
qa;nb.prototype=s(qa.prototype,{get_bytesPerElement:function(){return 2},Resize:function(a){qa.prototype.Resize.call(this,a);this.aux=new Uint16Array(this.m_buffer.buffer)},Get:function(a){return this.aux[a]},Set:function(a,b){this.aux[a]=b},SetRange:function(a,b){null==b&&(b=0);for(var c=0,d=a.length;c<d;){var f=c++;this.Set(f+b,a[f])}},SetViewSlice:function(a,b){qa.prototype.SetViewSlice.call(this,a,b);this.aux=this.aux.subarray(a,a+b)},__class__:nb});var gc=function(a){v.call(this,a)};k["haxor.io.file.AssetFile"]=
gc;gc.__name__=["haxor","io","file","AssetFile"];gc.__super__=v;gc.prototype=s(v.prototype,{get_asset:function(){return null},stof32a:function(a,b){null==b&&(b=" ");for(var c=B.trim(B.replace(a,"\n"," ")).split(b),d=[],f=0,e=c.length;f<e;){var g=f++;d.push(w.parseFloat(c[g]))}return d},stoi16a:function(a,b){null==b&&(b=" ");for(var c=B.trim(B.replace(a,"\n"," ")).split(b),d=[],f=0,e=c.length;f<e;){var g=f++;d.push(w.parseInt(c[g]))}return d},stoi16ta:function(a,b,c){null==c&&(c=" ");a=B.trim(B.replace(a,
"\n"," ")).split(c);c=[];for(var d,f=0;f<a.length;){d=[];for(var e=0;e<b;)e++,d.push(w.parseInt(a[f++]));c.push(d)}return c},__class__:gc,__properties__:s(v.prototype.__properties__,{get_asset:"get_asset"})});var ob=function(a,b){v.call(this,a);this.x=G.parse(b);this.TraverseStep(this.x.firstElement())};k["haxor.io.file.AssetXML"]=ob;ob.__name__=["haxor","io","file","AssetXML"];ob.__super__=gc;ob.prototype=s(gc.prototype,{Parse:function(a){},TraverseStep:function(a){this.Parse(a);for(a=a.elements();a.hasNext();)this.TraverseStep(a.next())},
_a:function(a,b,c){return a.exists(b)?a.get(b):c},_tla:function(a,b,c){return a.exists(b)?B.trim(a.get(b)).toLowerCase():c},_p:function(a,b,c,d,f){null==f&&(f=!1);null==d&&(d=!1);b=b.split(".");var e=a;a=0;for(var g=b.length;a<g;){var h=a++,k=b[h];switch(k){case "$text":if(null==e.firstChild())return c;c=e.firstChild().toString();d&&(c=B.trim(c));f&&(c=c.toLowerCase());return c;default:if("@"==k.charAt(0))return d&&f?this._tla(e,E.substr(k,1,null),c):this._a(e,E.substr(k,1,null),c);e=e.elementsNamed(k);
if(null==e)return c;if(h==b.length-1)return e;if(!e.hasNext())return c;e=e.next()}}return c},_f:function(a,b,c,d){a=this._p(a,b,"");a=""==a?null:a;if(null==a)return null;for(;a.hasNext();)if(b=a.next(),this._a(b,c,"")==d)return b;return null},__class__:ob});var pb=function(a,b){this.version=this.xmlns="";this.data=new sd;this.geometries=[];this.images=[];this.controllers=[];this.materials=[];this.animations=[];this.lights=[];this.scene=null;this.m_id=w["int"](16777215*Math.random());ob.call(this,
a,b)};k["haxor.io.file.ColladaFile"]=pb;pb.__name__=["haxor","io","file","ColladaFile"];pb.GenerateTriangles=function(a,b,c){var d=[];switch(a){case "triangles":d=0>=b.length?[]:b[0];break;case "polygons":c=0;for(a=b.length;c<a;)for(var f=c++,f=pb.TriangulatePolygon(b[f],b[f].length);0<f.length;)d.push(f.shift());break;case "polylist":for(var f=a=0,e=c.length;f<e;){for(var g=f++,g=c[g],h=pb.TriangulatePolygon(b[0],g,a);0<h.length;)d.push(h.shift());a+=g}}return d};pb.TriangulatePolygon=function(a,
b,c){null==c&&(c=0);for(var d=1,f=2,e=[];f<b;)e.push(a[0+c].slice()),e.push(a[d+c].slice()),e.push(a[f+c].slice()),d++,f++;return e};pb.__super__=ob;pb.prototype=s(ob.prototype,{get_asset:function(){var a=this,b=new wa;b.set_name("collada_asset");if(null==this.scene)return u.LogError("ColladaFile> Trying to get asset of NULL scene."),b;""!=this.scene.name?b.set_name(this.scene.name):""!=this.scene.id&&b.set_name(this.scene.id);for(var c=new lb,d=new lb,f=new lb,e=[],g=[],h=[],k=0,l=this.materials.length;k<
l;){for(var p=k++,p=this.materials[p],q=p.name,s=0;10>s;)var t=s++,q=B.replace(q,"_"+t,"");q=B.replace(q,"_","/");s=r.Get(q);null==s&&(s=new aa,s.set_name(q),s.set_shader(null==C.m_flat_texture_shader?C.m_flat_texture_shader=new C(ea.flat_texture_source):C.m_flat_texture_shader),r.Add(q,s));f.set(p,s)}this.scene.Traverse(function(k){var l;l=null==k.parent?b:null!=c.h.__keys__[k.parent.__id__]?c.h[k.parent.__id__]:b;var n=null;if("EnvironmentAmbientLight"!=k.name){n=new wa;n.set_name("node"+n.get_uid());
""!=k.sid?n.set_name(k.sid):""!=k.id?n.set_name(k.id):""!=k.name&&n.set_name(k.name);"joint"==k.type&&(e.push(n.m_transform),g.push(k));n.m_transform.set_parent(l.m_transform);n.m_transform.set_localPosition(k.position);n.m_transform.set_localRotation(k.rotation);n.m_transform.set_localScale(k.scale);if(""!=k.data){l=n.AddComponent(Yb);try{l.data=JSON.parse(k.data)}catch(p){}}c.set(k,n);l=0;for(var q=k.instances.length;l<q;){var s=l++,t=k.instances[s],u=null,v=null,w=s=null,x="";switch(t.type){case "light":s=
a.FindLightById(t.target);if(null==s)continue;switch(s.type){case "point":w=n.AddComponent(sb),w.color.SetColor(s.color),w.intensity=s.intensity,w.radius=2*s.radius,w.atten=s.atten}continue;case "geometry":x=t.target;break;case "controller":w=a.FindControllerById(t.target),null!=w&&(d.set(n.m_transform,w),x=w.source)}s=a.FindGeometryById(x);if(null!=s)for(var t=0,z=s.mesh.primitives.length;t<z;){var u=t++,y=s.mesh.primitives[u].material,v=a.FindMaterialById(y),u=a.CreateMeshRenderer(n,x,s.mesh.primitives[u],
null==w?ia:Ob,w);null!=w&&h.push(u);if(null!=v)u.set_material(null!=f.h.__keys__[v.__id__]?f.h[v.__id__]:u.m_material);else{for(v=0;10>v;)var A=v++,y=B.replace(y,"_"+A,"");y=B.replace(y,"_","/");y=r.Get(y);u.set_material(y)}}}}});k=0;for(l=h.length;k<l;)if(p=k++,p=h[p],q=null!=d.h.__keys__[p.m_entity.m_transform.__id__]?d.h[p.m_entity.m_transform.__id__]:null,null!=q)for(p.set_joints([]),s=0,t=q.joints.length;s<t;)for(var v=s++,w=0,z=e.length;w<z;){var x=w++;e[x].get_name()==q.joints[v]&&p.m_joints.push(e[x])}for(k=
c.keys();k.hasNext();)l=k.next(),p=c.h[l.__id__],p!=b&&p.set_name(l.name);this.AddAnimations(b);"z_up"==this.data.axis&&b.m_transform.set_rotation(F.FromAxisAngle(new n(1,0,0),-90));return b},AddAnimations:function(a,b){null==b&&(b=!1);if(!(0>=this.animations.length)){var c=a.get_animation();null==c&&(c=a.AddComponent(sa));for(var d=0,f=this.animations.length;d<f;){var e=d++,h=this.animations[e],k=new Zb;k.set_name(""==h.id?""==h.name?"clip"+e:h.name:h.id);for(var e=0,l=h.channels.length;e<l;){var n=
e++,n=h.channels[n],p=n.target.split("/")[0],p=B.replace(p,"node-",""),q=n.target.split("/")[1],p=a.m_transform.Search(p,b);if(null!=p)switch(p=p.m_entity,q){case "matrix":for(var q=k.Add(p.m_transform,"localPosition"),p=k.Add(p.m_transform,"localRotation"),r=0,s=n.keyframes.length;r<s;){var t=r++,t=n.keyframes[t],u=x.FromArray(t.values);q.Add(t.time,u.GetColumn(3,null).get_xyz());p.Add(t.time,F.FromMatrix4(g.data.get_m4().SetMatrix4(u).ToRotation()))}}}c.Add(k)}}},CreateMeshRenderer:function(a,b,
c,d,f){a=a.AddComponent(d);var e=b+"_"+this.m_id;b=r.Get(e);if(null!=b)return a.set_mesh(b),a;d=c.GetTriangulatedVectorArray("vertex");var g=c.GetTriangulatedVectorArray("normal"),h=c.GetTriangulatedVectorArray("color"),k=c.GetTriangulatedVectorArray("texcoord",0),l=c.GetTriangulatedVectorArray("texcoord",1),n=c.GetTriangulatedVectorArray("texbinormal"),p=c.GetTriangulatedVectorArray("textangent"),q=J.__instanceof(a,Ob);b=q?new Ic:new Ka;b.set_name(e);r.Add(e,b);0<h.length&&b.set_color(h);0<k.length&&
b.set_uv0(k);0<l.length&&b.set_uv1(l);if(q&&null!=f){f.GenerateBonesAndWeights();e=b;h=f.GetTriangulatedWeights(c);c=f.GetTriangulatedBones(c);k=f.GetBinds();e.set_binds(k);e.set_weight(h);e.set_bone(c);f=f.GetBSM();c=0;for(e=d.length;c<e;)h=c++,d[h]=f.Transform3x4(d[h].get_clone());c=0;for(e=g.length;c<e;)h=c++,g[h]=f.Transform3x3(g[h].get_clone());c=0;for(e=n.length;c<e;)h=c++,n[h]=f.Transform3x3(n[h].get_clone());c=0;for(e=p.length;c<e;)h=c++,p[h]=f.Transform3x3(p[h].get_clone())}0<d.length&&b.set_vertex(d);
0<g.length&&b.set_normal(g);0<n.length&&b.set_binormal(n);0<p.length&&b.set_tangent(p);b.GenerateBounds();a.set_mesh(b);return a},FindLightById:function(a){for(var b=0,c=this.lights.length;b<c;){var d=b++;if(this.lights[d].id==a)return this.lights[d]}return null},FindGeometryById:function(a){for(var b=0,c=this.geometries.length;b<c;){var d=b++;if(this.geometries[d].id==a)return this.geometries[d]}return null},FindControllerById:function(a){for(var b=0,c=this.controllers.length;b<c;){var d=b++;if(this.controllers[d].id==
a)return this.controllers[d]}return null},FindNodeById:function(a){var b=null;this.scene.Traverse(function(c){c.id==a&&(b=c)});return b},FindMaterialById:function(a){for(var b=0,c=this.materials.length;b<c;){var d=b++;if(this.materials[d].id==a||this.materials[d].name==a)return this.materials[d]}return null},Parse:function(a){switch(a.get_nodeName()){case "COLLADA":this.xmlns=this._a(a,"xmlns","");this.version=this._a(a,"version","0.0");break;case "asset":this.data.author=this._p(a,"contributor.author.$text",
"none");this.data.tool=this._p(a,"contributor.authoring_tool.$text","none");this.data.source=this._p(a,"contributor.source_data.$text","none");this.data.axis=this._p(a,"up_axis.$text","y_up").toLowerCase();this.data.creation=this._p(a,"created.$text","00/00/00");this.data.modification=this._p(a,"modified.$text","00/00/00");this.data.unitName=this._p(a,"unit.@name","none");this.data.unitValue=w.parseFloat(this._p(a,"unit.@meter","0.0"));break;case "library_materials":this.ParseMaterialLibrary(a);break;
case "library_geometries":this.ParseGeometryLibrary(a);break;case "library_controllers":this.ParseControllerLibrary(a);break;case "library_images":this.ParseImageLibrary(a);break;case "library_visual_scenes":this.ParseSceneLibrary(a);break;case "library_animations":this.ParseAnimationLibrary(a);break;case "library_lights":this.ParseLightLibrary(a)}},ParseLightLibrary:function(a){for(var b=a.elementsNamed("light"),c,d;b.hasNext();)if(a=b.next(),c=new td,c.id=this._p(a,"@id","light"+this.lights.length),
c.name=this._p(a,"@name",c.id),this.lights.push(c),d=a.elementsNamed("technique_common"),d.hasNext()&&(d=d.next().elements(),d.hasNext())){d=d.next();c.type=d.get_nodeName().toLowerCase();var f=[1,1,1,1];switch(c.type){case "point":f=this._f32a(this._p(d,"color.$text",""));break;case "ambient":f=this._f32a(this._p(d,"color.$text",""));break;case "directional":f=this._f32a(this._p(d,"color.$text",""))}c.color.Set(f[0],f[1],f[2],4<=f.length?f[3]:1);d=a.elementsNamed("extra");if(d.hasNext()&&(d=d.next().elementsNamed("technique"),
d.hasNext()&&(d=d.next().elementsNamed("max_light"),d.hasNext())))switch(d=d.next(),c.type){case "point":c.radius=w.parseFloat(this._p(d,"decay_radius.$text","1.0"));c.intensity=w.parseFloat(this._p(d,"multiplier.$text","1.0"));a=w.parseInt(this._p(d,"decay_type.$text","1.0"));c.atten=0==a?0:1==a?1:2;break;case "directional":c.intensity=w.parseFloat(this._p(d,"multiplier.$text","1.0"))}}},ParseAnimationLibrary:function(a){for(var b=a.elementsNamed("animation"),c=0;b.hasNext();){a=b.next();a.elementsNamed("animation").hasNext()&&
(a=a.elementsNamed("animation").next());var d=new ud;d.id=this._a(a,"id","");d.id=""==d.id?"Clip"+c++:d.id;d.name=this._a(a,"name",d.id);for(var f=a.elementsNamed("source"),e=a.elementsNamed("sampler"),g=[],h=[];f.hasNext();)g.push(f.next());for(;e.hasNext();)h.push(e.next());for(a=a.elementsNamed("channel");a.hasNext();){var e=a.next(),f=new vd,k=this._a(e,"source","");f.source=E.substr(k,1,null);f.target=this._a(e,"target","");e=0;for(k=h.length;e<k;){var l=e++;if(this._a(h[l],"id","")==f.source){for(var n=
h[l].elementsNamed("input"),p=l="";n.hasNext();){var q=n.next();switch(this._a(q,"semantic","").toLowerCase()){case "input":l=this._a(q,"source","");l=E.substr(l,1,null);break;case "output":p=this._a(q,"source",""),p=E.substr(p,1,null)}}if(""!=l&&""!=p){for(var n=q=null,r=0,s=g.length;r<s;){var t=r++,t=g[t];this._a(t,"id","")==l&&(q=t);this._a(t,"id","")==p&&(n=t)}if(null!=q&&null!=n)for(l=this._f32a(this._p(q,"float_array.$text","")),p=this._f32a(this._p(n,"float_array.$text","")),n=w.parseInt(this._p(n,
"technique_common.accessor.@stride","0")),q=0,r=l.length;q<r;){t=q++;s=new wd;s.time=l[t];for(t=0;t<n;)t++,s.values.push(p.shift());f.keyframes.push(s)}}}}d.channels.push(f)}this.animations.push(d)}},ParseMaterialLibrary:function(a){for(var b=a.elements();b.hasNext();)switch(a=b.next(),a.get_nodeName()){case "material":var c=new xd;c.id=this._a(a,"id","");c.name=this._a(a,"name","");""==c.id&&(c.id=c.name);this.materials.push(c)}},ParseSceneLibrary:function(a){for(var b=a.elements();b.hasNext();)switch(a=
b.next(),a.get_nodeName()){case "visual_scene":this.ParseVisualScene(a)}},ParseVisualScene:function(a){null==this.scene&&(this.scene=new yd,this.scene.id=this._a(a,"id","collada_scene"),this.scene.name=this._a(a,"name",this.scene.id),this.scene.type=a.get_nodeName(),this.TraverseVisualSceneNodes(this.scene,null,a))},TraverseVisualSceneNodes:function(a,b,c){var d=null;"node"==c.get_nodeName()&&(d=this.ParseVisualSceneNode(a,b,c));for(b=c.elementsNamed("node");b.hasNext();)this.TraverseVisualSceneNodes(a,
d,b.next())},ParseVisualSceneNode:function(a,b,c){var d=new zd;d.scene=a;d.sid=this._a(c,"sid","node"+w["int"](16777215*Math.random()));d.id=this._a(c,"id",d.sid);d.name=this._a(c,"name",d.sid);""==d.sid&&(d.sid=d.id);d.type=this._a(c,"type","NODE").toLowerCase();d.matrix=this._f32a(this._p(c,"matrix.$text","1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1"));d.parent=b;d.GenerateTranform();for(c=c.elements();c.hasNext();){var f=c.next(),e=null;switch(f.get_nodeName()){case "instance_geometry":e=new hc;e.type="geometry";
f=this._a(f,"url","");e.target=E.substr(f,1,null);break;case "instance_controller":e=new hc;e.type="controller";f=this._a(f,"url","");e.target=E.substr(f,1,null);break;case "instance_light":e=new hc;e.type="light";f=this._a(f,"url","");e.target=E.substr(f,1,null);break;case "extra":d.data=this._p(f,"technique.user_properties.$text",""),0>d.data.indexOf(";")&&(d.data="")}null!=e&&d.instances.push(e)}null==b?a.children.push(d):b.children.push(d);return d},ParseInstanceMaterials:function(a,b){},ParseControllerLibrary:function(a){for(var b=
a.elementsNamed("controller"),c=null;b.hasNext();)a=b.next(),c=new Ad,c.id=this._a(a,"id","none"),c.name=this._a(a,"name",c.id),this.ParseController(c,a),this.controllers.push(c)},ParseController:function(a,b){b=b.firstElement();if(null!=b)switch(null==b.get_nodeName()?a.type="none":a.type=b.get_nodeName().toLowerCase(),a.type){case "skin":this.ParseControllerSkin(a,b)}},ParseControllerSkin:function(a,b){var c=this._a(b,"source","");a.source=E.substr(c,1,null);a.matrix=this._f32a(this._p(b,"bind_shape_matrix.$text",
""));var d="",d=null,c=null==this._p(b,"joints")?null:this._p(b,"joints").next();if(null!=c)for(c=c.elementsNamed("input");c.hasNext();){var f=c.next(),d=this._a(f,"source",""),d=E.substr(d,1,null);if(""!=d&&(d=this._f(b,"source","id",d),null!=d))switch(this._a(f,"semantic","").toLowerCase()){case "joint":a.joints=B.trim(B.replace(this._p(d,"Name_array.$text",""),"\n"," ")).split(" ");break;case "inv_bind_matrix":for(f=this._f32a(this._p(d,"float_array.$text",""));0<f.length;){for(var d=[],e=0;16>
e;)e++,d.push(f.shift());a.binds.push(d)}}}c=null==this._p(b,"vertex_weights")?null:this._p(b,"vertex_weights").next();null!=c&&(a.inputs=this.ParseInputList(b,c),a.vcount=this._i16a(this._p(c,"vcount.$text","")),c=this._p(c,"v.$text",""),a.indexes=this._i16ta(c,a.get_offset()))},ParseImageLibrary:function(a){for(var b=a.elementsNamed("image"),c=null;b.hasNext();)a=b.next(),c=new Bd,c.id=this._a(a,"id","none"),c.name=this._a(a,"name",c.id),c.format=this._a(a,"format",""),c.width=w.parseInt(this._a(a,
"width","-1")),c.height=w.parseInt(this._a(a,"height","-1")),c.depth=w.parseInt(this._a(a,"depth","-1")),this.images.push(c)},ParseGeometryLibrary:function(a){for(var b=a.elementsNamed("geometry"),c=null;b.hasNext();)a=b.next(),c=new Cd,c.id=this._a(a,"id","none"),c.name=this._a(a,"name","none"),this.ParseGeometry(c,a),this.geometries.push(c)},ParseGeometry:function(a,b){b=b.firstElement();if(null!=b)switch(a.mesh=new Dd,null==b.get_nodeName()?a.mesh.type="none":a.mesh.type=b.get_nodeName().toLowerCase(),
a.mesh.type){case "mesh":this.ParseMesh(a.mesh,b)}},ParseMesh:function(a,b){for(var c=b.elements(),d=b;c.hasNext();)if(b=c.next(),"vertices"!=b.get_nodeName()&&"source"!=b.get_nodeName()){var f=new Ed;f.type=b.get_nodeName();f.material=this._a(b,"material","");this.ParsePrimitive(f,d,b);a.primitives.push(f)}},ParsePrimitive:function(a,b,c){a.inputs=this.ParseInputList(b,c);b=c.elementsNamed("p");c=c.elementsNamed("vcount");c.hasNext()&&(c=c.next().firstChild(),a.vcount=null==c?[]:this._i16a(c.toString()));
for(;b.hasNext();){c=b.next();c=null!=c.firstChild()?c.firstChild().toString():"0";var d=a.get_offset();c=this._i16ta(c,d);a.indexes.push(c)}},ParseInputList:function(a,b){for(var c=[],d=b.elementsNamed("input");d.hasNext();){var f=d.next(),e=new Fd,g=this._a(f,"source","");e.semantic=this._a(f,"semantic","").toLowerCase();e.offset=w.parseInt(this._a(f,"offset","-1"));e.set=w.parseInt(this._a(f,"set","-1"));"joint"==e.semantic?c.push(e):("vertex"==e.semantic&&(g=this._p(a,"vertices.input.@source",
"")),""!=g&&(g=E.substr(g,1,null),f=this._f(a,"source","id",g),null!=f&&(g=this._p(f,"technique_common.accessor.@stride","0"),e.stride=w.parseInt(g),e.values=this._f32a(this._p(f,"float_array.$text","")),c.push(e))))}return c},TraverseStep:function(a){this.Parse(a);for(a=a.elements();a.hasNext();)this.TraverseStep(a.next())},_f32a:function(a){a=B.trim(B.replace(a,"\n"," ")).split(" ");for(var b=[],c=0,d=a.length;c<d;){var f=c++;b.push(w.parseFloat(a[f]))}return b},_i16a:function(a){a=B.trim(B.replace(a,
"\n"," ")).split(" ");for(var b=[],c=0,d=a.length;c<d;){var f=c++;b.push(w.parseInt(a[f]))}return b},_i16ta:function(a,b){for(var c=B.trim(B.replace(a,"\n"," ")).split(" "),d=[],f,e=0;e<c.length;){f=[];for(var g=0;g<b;)g++,f.push(w.parseInt(c[e++]));d.push(f)}return d},__class__:pb});var sd=function(){this.axis="y_up";this.unitValue=0;this.author=this.tool=this.source=this.creation=this.modification=this.unitName=""};k["haxor.io.file.ColladaAssetData"]=sd;sd.__name__=["haxor","io","file","ColladaAssetData"];
sd.prototype={__class__:sd};var Cd=function(){this.mesh=null;this.id=this.name=""};k["haxor.io.file.ColladaGeometry"]=Cd;Cd.__name__=["haxor","io","file","ColladaGeometry"];Cd.prototype={__class__:Cd};var Dd=function(){this.primitives=null;this.type="";this.primitives=[]};k["haxor.io.file.ColladaMesh"]=Dd;Dd.__name__=["haxor","io","file","ColladaMesh"];Dd.prototype={__class__:Dd};var Ed=function(){this.inputs=this.vcount=this.indexes=null;this.type=this.material="";this.inputs=[];this.vcount=[];this.indexes=
[];this.m_triangles=null};k["haxor.io.file.ColladaPrimitive"]=Ed;Ed.__name__=["haxor","io","file","ColladaPrimitive"];Ed.prototype={get_triangles:function(){return null!=this.m_triangles?this.m_triangles:this.m_triangles=pb.GenerateTriangles(this.type,this.indexes,this.vcount)},get_offset:function(){for(var a=0,b=0,c=this.inputs.length;b<c;)var d=b++,a=Math.max(a,this.inputs[d].offset+1);return a},GetInput:function(a,b){null==b&&(b=-1);for(var c=0,d=this.inputs.length;c<d;){var f=c++;if(this.inputs[f].semantic==
a&&(0>b||b==this.inputs[f].set))return this.inputs[f]}return null},GetTriangulatedVectorArray:function(a,b,c){null==b&&(b=-1);b=this.GetInput(a,b);if(null==b)return[];a=b.GetVectorArray();b=b.offset;c=[];if(0>=a.length||0>b)return[];for(var d=0,f=this.get_triangles().length;d<f;){var e=d++,e=this.get_triangles()[e][b];c.push(a[e])}return c},GetVectorArray:function(a,b){null==b&&(b=-1);for(var c=[],d=0,f=this.inputs.length;d<f;){var e=d++;if(this.inputs[e].semantic==a)if(0>b){c=this.inputs[e].GetVectorArray();
break}else if(b==this.inputs[e].set){c=this.inputs[e].GetVectorArray();break}}if("color"==a&&0>b&&(d=this.GetVectorArray("color",0),0<d.length))for(f=Math.min(d.length,c.length),e=0;e<f;){var g=e++;c[g].a=d[g].r}return c},__class__:Ed,__properties__:{get_offset:"get_offset",get_triangles:"get_triangles"}};var Fd=function(){this.stride=0;this.values=null;this.set=-1;this.offset=0;this.semantic="";this.values=[]};k["haxor.io.file.ColladaInput"]=Fd;Fd.__name__=["haxor","io","file","ColladaInput"];Fd.prototype=
{GetVectorArray:function(){if(0>=this.stride)return[];for(var a=[],b=0;b<this.values.length;){var c=null;switch(this.stride){case 1:c=this.values[b];break;case 2:c=new K(this.values[b],this.values[b+1]);break;case 3:c="color"==this.semantic?new t(this.values[b],this.values[b+1],this.values[b+2]):new n(this.values[b],this.values[b+1],this.values[b+2]);break;case 4:c="color"==this.semantic?new t(this.values[b],this.values[b+1],this.values[b+2],this.values[b+3]):new Q(this.values[b],this.values[b+1],
this.values[b+2],this.values[b+3])}null!=c&&(a.push(c),b+=this.stride)}return a},__class__:Fd};var Bd=function(){this.data=null;this.width=this.height=this.depth=0;this.id=this.name=this.format=this.source=""};k["haxor.io.file.ColladaImage"]=Bd;Bd.__name__=["haxor","io","file","ColladaImage"];Bd.prototype={__class__:Bd};var Ad=function(){this.matrix=this.binds=this.joints=this.inputs=this.vcount=this.indexes=this.weights=this.bones=null;this.type=this.source=this.id=this.name="";this.matrix=[];this.binds=
[];this.inputs=[];this.joints=[];this.vcount=[];this.indexes=[]};k["haxor.io.file.ColladaController"]=Ad;Ad.__name__=["haxor","io","file","ColladaController"];Ad.prototype={get_offset:function(){for(var a=0,b=0,c=this.inputs.length;b<c;)var d=b++,a=Math.max(a,this.inputs[d].offset+1);return a},GetBSM:function(){for(var a=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),b=0,c=this.matrix.length;b<c;){var d=b++;a.SetIndex(d,this.matrix[d])}return a},GetJointIndex:function(a){for(var b=0,c=this.joints.length;b<
c;){var d=b++;if(a==this.joints[d])return d}return-1},GetBinds:function(){for(var a=[],b=0,c=this.binds.length;b<c;){for(var d=b++,e=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),g=0,h=this.binds[d].length;g<h;){var k=g++;e.SetIndex(k,this.binds[d][k])}a.push(e)}return a},GetTriangulatedWeights:function(a){for(var b=a.GetInput("vertex").offset,c=[],d=0,e=a.get_triangles().length;d<e;){var g=d++,g=a.get_triangles()[g][b];c.push(this.weights[g])}return c},GetTriangulatedBones:function(a){for(var b=a.GetInput("vertex").offset,
c=[],d=0,e=a.get_triangles().length;d<e;){var g=d++,g=a.get_triangles()[g][b];c.push(this.bones[g])}return c},GenerateBonesAndWeights:function(){this.weights=[];this.bones=[];this.get_offset();for(var a=null,b=0,c=0,d=0,e=this.inputs.length;d<e;){var g=d++;"weight"==this.inputs[g].semantic&&(a=this.inputs[g],b=a.offset);"joint"==this.inputs[g].semantic&&(c=this.inputs[g].offset)}e=d=0;for(g=this.vcount.length;e<g;){for(var h=e++,k=this.vcount[h],h=new Q,l=new Q,n=0;n<k;){var p=n++,q=this.indexes[d][c],
r=a.values[this.indexes[d][b]];0==p?(h.x=r,l.x=q):1==p?(h.y=r,l.y=q):2==p?(h.z=r,l.z=q):3==p&&(h.w=r,l.w=q);d++}k=h.x+h.y+h.z+h.w;k=0>=k?0:1/k;h.Scale(k);this.weights.push(h);this.bones.push(l)}},__class__:Ad,__properties__:{get_offset:"get_offset"}};var yd=function(){this.children=null;this.type=this.id=this.name="";this.children=[]};k["haxor.io.file.ColladaVisualScene"]=yd;yd.__name__=["haxor","io","file","ColladaVisualScene"];yd.prototype={Traverse:function(a){for(var b=0,c=this.children.length;b<
c;){var d=b++;this.TraverseStep(this.children[d],a)}},TraverseStep:function(a,b){null!=b&&b(a);for(var c=0,d=a.children.length;c<d;){var e=c++;this.TraverseStep(a.children[e],b)}},__class__:yd};var zd=function(){this.local=this.instances=null;this.data="";this.matrix=this.scene=this.parent=this.children=null;this.type=this.id=this.sid=this.name="";this.children=[];this.instances=[];this.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];this.position=new n(0,0,0);this.rotation=new F(0,0,0,1);this.scale=new n(1,
1,1)};k["haxor.io.file.ColladaNode"]=zd;zd.__name__=["haxor","io","file","ColladaNode"];zd.prototype={get_world:function(){if(null!=this.m_world)return this.m_world;this.m_world=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);for(var a=this,b=[];null!=a;)b.push(a),a=a.parent;b.reverse();for(var a=0,c=b.length;a<c;){var d=a++;this.m_world.MultiplyTransform(b[d].local)}return this.m_world},GenerateTranform:function(){var a=this.local=x.FromArray(this.matrix);this.position=(new x(1,0,0,a.m03,0,1,0,a.m13,0,0,
1,a.m23,0,0,0,1)).GetColumn(3,null).get_xyz();this.rotation=F.FromMatrix4(g.data.get_m4().SetMatrix4(a).ToRotation());this.scale=x.GetScale(a).get_diagonalLR().get_xyz()},__class__:zd,__properties__:{get_world:"get_world"}};var hc=function(){this.type=this.target="";this.materials=[]};k["haxor.io.file.ColladaInstance"]=hc;hc.__name__=["haxor","io","file","ColladaInstance"];hc.prototype={__class__:hc};var xd=function(){this.id=this.name=""};k["haxor.io.file.ColladaMaterial"]=xd;xd.__name__=["haxor",
"io","file","ColladaMaterial"];xd.prototype={__class__:xd};var ud=function(){this.id=this.name="";this.channels=[]};k["haxor.io.file.ColladaAnimation"]=ud;ud.__name__=["haxor","io","file","ColladaAnimation"];ud.prototype={__class__:ud};var vd=function(){this.source=this.target="";this.keyframes=[]};k["haxor.io.file.ColladaAnimationChannel"]=vd;vd.__name__=["haxor","io","file","ColladaAnimationChannel"];vd.prototype={__class__:vd};var wd=function(){this.time=0;this.values=[]};k["haxor.io.file.ColladaAnimationKeyFrame"]=
wd;wd.__name__=["haxor","io","file","ColladaAnimationKeyFrame"];wd.prototype={__class__:wd};var td=function(){this.type=this.name=this.id="";this.color=new t(1,1,1,1);this.atten=this.intensity=this.radius=0};k["haxor.io.file.ColladaLight"]=td;td.__name__=["haxor","io","file","ColladaLight"];td.prototype={__class__:td};var bc=function(a){this.mname=this.mguid="";this.queue="opaque";this.offset=0;this.shader="";this.ztest=!0;this.zfunc="lessequal";this.zwrite=!0;this.blend=!1;this.blendSrc="one";this.blendDst=
"zero";this.grab=this.lighting=this.invert=!1;this.cull="back";this.uniforms=[];ob.call(this,"",a)};k["haxor.io.file.MaterialFile"]=bc;bc.__name__=["haxor","io","file","MaterialFile"];bc.__super__=ob;bc.prototype=s(ob.prototype,{get_asset:function(){var a=new aa;a.set_name(this.mname);a.m_guid=this.mguid;switch(this.queue){case "geometry":a.queue=1E3;break;case "background":a.queue=0;break;case "opaque":a.queue=1E3;break;case "transparent":a.queue=2E3;break;case "overlay":a.queue=3E3;break;case "interface":a.queue=
4E3}a.queue+=this.offset;var b=r.Get(this.shader);null==b&&(u.LogWarning("MaterialFile> ["+this.m_name+"] shader["+this.shader+"] is null!"),b=null==C.m_flat_shader?C.m_flat_shader=new C(ea.flat_source):C.m_flat_shader);a.set_shader(b);a.ztest=this.ztest;a.zfunc=515;switch(this.zfunc){case "never":a.zfunc=512;break;case "always":a.zfunc=519;break;case "notequal":a.zfunc=517;break;case "equal":a.zfunc=514;break;case "less":a.zfunc=513;break;case "lessequal":a.zfunc=515;break;case "greater":a.zfunc=
516;break;case "greaterequal":a.zfunc=518}a.zwrite=this.zwrite;a.blend=this.blend;a.blendSrc=this.BlendModeNameToEnum(this.blendSrc);a.blendDst=this.BlendModeNameToEnum(this.blendDst);a.invert=this.invert;a.lighting=this.lighting;a.grab=this.grab;switch(this.cull){case "none":a.cull=0;break;case "front":a.cull=1;break;case "back":a.cull=2}for(var b=0,c=this.uniforms.length;b<c;){var d=b++,d=this.uniforms[d],e=this.stof32a(d.value);switch(d.type){case "int":a.SetInt(d.name,w.parseInt(d.value));break;
case "vec2":a.SetFloat2(d.name,e[0],e[1]);break;case "vec3":a.SetFloat3(d.name,e[0],e[1],e[2]);break;case "vec4":a.SetFloat4(d.name,e[0],e[1],e[2],e[3]);break;case "mat4":a.SetMatrix4(d.name,x.FromArray(e,g.data.get_m4()));break;case "color":a.SetFloat4(d.name,e[0],e[1],e[2],e[3]);break;case "texture":a.SetTexture(d.name,r.Get(d.value))}}return a},Parse:function(a){switch(a.get_nodeName()){case "material":this.mguid=this._a(a,"guid","");this.mname=this._a(a,"name","");break;case "queue":this.offset=
w.parseInt(this._a(a,"offset","0"));this.queue=this._p(a,"$text","geometry",!0,!0);break;case "shader":this.shader=this._p(a,"$text","");break;case "ztest":this.ztest="true"==this._p(a,"$text","true",!0,!0);break;case "zfunc":this.zfunc=this._p(a,"$text",this.zfunc);break;case "zwrite":this.zwrite="true"==this._p(a,"$text","true",!0,!0);break;case "blend":this.blend="true"==this._a(a,"enabled","false");this.blendSrc=this._p(a,"src.$text","one",!0,!0);this.blendDst=this._p(a,"dst.$text","zero",!0,
!0);break;case "invert":this.invert="true"==this._p(a,"$text","false",!0,!0);break;case "lighting":this.lighting="true"==this._p(a,"$text","false",!0,!0);break;case "grab":this.grab="true"==this._p(a,"$text","false",!0,!0);break;case "cull":this.cull=this._p(a,"$text",this.cull,!0,!0);break;case "uniforms":this.ParseUniforms(a)}},ParseUniforms:function(a){for(var b=a.elements();b.hasNext();){a=b.next();var c=new Gd;c.type=a.get_nodeName().toLowerCase();c.name=this._a(a,"name","");c.value=this._p(a,
"$text","",!0);this.uniforms.push(c)}},BlendModeNameToEnum:function(a){switch(a){case "one":return 1;case "srccolor":return 768;case "oneminussrccolor":return 769;case "srcalpha":return 770;case "oneminussrcalpha":return 771;case "dstalpha":return 772;case "oneminusdstalpha":return 773;case "dstcolor":return 774;case "oneminusdstcolor":return 775;case "srcalphasaturate":return 776}return 0},__class__:bc});var Gd=function(){this.value=this.name=this.type=""};k["haxor.io.file.MaterialFileUniform"]=
Gd;Gd.__name__=["haxor","io","file","MaterialFileUniform"];Gd.prototype={__class__:Gd};var ba=function(a,b,c,d,e,g){null==g&&(g=0);null==e&&(e=0);null==d&&(d=0);null==b&&(b=0);null==a&&(a=0);this.m_xMin=a;this.m_zMin=this.m_yMin=b;this.m_xMax=this.m_xMin+d;this.m_yMax=this.m_yMin+e;this.m_zMax=this.m_zMin+g};k["haxor.math.AABB3"]=ba;ba.__name__=["haxor","math","AABB3"];ba.__properties__={get_empty:"get_empty",get_temp:"get_temp"};ba.get_temp=function(){return g.data.get_aabb3()};ba.Center=function(a,
b){return(null==b?new n(0,0,0):b).Set(a.m_xMin+.5*(a.m_xMax-a.m_xMin),a.m_yMin+.5*(a.m_yMax-a.m_yMin),a.m_zMin+.5*(a.m_zMax-a.m_zMin))};ba.FromMinMax=function(a,b,c,d,e,g,h){return(null==h?new ba:h).Set(a,b,c,d,e,g)};ba.FromCenter=function(a,b,c,d,e,g,h){d*=.5;e*=.5;g*=.5;return ba.FromMinMax(a-d,a+d,b-e,b+e,c-g,c+g,h)};ba.get_empty=function(){return new ba};ba.prototype={get_clone:function(){return ba.FromMinMax(this.m_xMin,this.m_xMax,this.m_yMin,this.m_yMax,this.m_zMin,this.m_zMax)},get_min:function(){return new n(this.m_xMin,
this.m_yMin)},set_min:function(a){this.set_xMin(a.x);this.set_yMin(a.y);return a},get_max:function(){return new n(this.m_xMax,this.m_yMax)},set_max:function(a){this.set_xMax(a.x);this.set_yMax(a.y);return a},get_xMin:function(){return this.m_xMin},set_xMin:function(a){this.m_xMin=a;this.Validate();return a},get_yMin:function(){return this.m_yMin},set_yMin:function(a){this.m_yMin=a;this.Validate();return a},get_zMin:function(){return this.m_zMin},set_zMin:function(a){this.m_zMin=a;this.Validate();
return a},get_xMax:function(){return this.m_xMax},set_xMax:function(a){this.m_xMax=a;this.Validate();return a},get_yMax:function(){return this.m_yMax},set_yMax:function(a){this.m_yMax=a;this.Validate();return a},get_zMax:function(){return this.m_zMax},set_zMax:function(a){this.m_zMax=a;this.Validate();return a},get_center:function(){return ba.Center(this)},set_center:function(a){var b=.5*l.Abs(this.m_xMax-this.m_xMin),c=.5*l.Abs(this.m_yMax-this.m_yMin),d=.5*l.Abs(this.m_zMax-this.m_zMin);this.m_xMin=
a.x-b;this.m_xMax=a.x+b;this.m_yMin=a.y-c;this.m_yMax=a.y+c;this.m_zMin=a.z-d;this.m_zMax=a.z+d;this.Validate();return a},get_x:function(){return this.m_xMin},set_x:function(a){this.set_xMin(a);return a},get_y:function(){return this.m_yMin},set_y:function(a){this.set_yMin(a);return a},get_z:function(){return this.m_zMin},set_z:function(a){this.set_zMin(a);return a},get_width:function(){return l.Abs(this.m_xMax-this.m_xMin)},set_width:function(a){this.set_xMax(this.m_xMin+a);return a},get_height:function(){return l.Abs(this.m_yMax-
this.m_yMin)},set_height:function(a){this.set_yMax(this.m_yMin+a);return a},get_depth:function(){return l.Abs(this.m_zMax-this.m_zMin)},set_depth:function(a){this.set_zMax(this.m_zMin+a);return a},get_size:function(){return(new n(0,0,0)).Set(l.Abs(this.m_xMax-this.m_xMin),l.Abs(this.m_yMax-this.m_yMin),l.Abs(this.m_zMax-this.m_zMin))},set_size:function(a){this.set_width(a.x);this.set_height(a.y);this.set_depth(a.z);return a},Validate:function(){var a=this.m_xMin,b=this.m_xMax,c=this.m_yMin,d=this.m_yMax,
e=this.m_zMin,g=this.m_zMax;a<=b?(this.m_xMin=a,this.m_xMax=b):(this.m_xMin=b,this.m_xMax=a);c<=d?(this.m_yMin=c,this.m_yMax=d):(this.m_yMin=d,this.m_yMax=c);e<=g?(this.m_zMin=e,this.m_zMax=g):(this.m_zMin=g,this.m_zMax=e)},Add:function(a){this.m_xMax=Math.max(a.m_xMax,this.m_xMax);this.m_xMin=Math.min(a.m_xMin,this.m_xMin);this.m_yMax=Math.max(a.m_yMax,this.m_yMax);this.m_yMin=Math.min(a.m_yMin,this.m_yMin);this.m_zMax=Math.max(a.m_zMax,this.m_zMax);this.m_zMin=Math.min(a.m_zMin,this.m_zMin);return this},
Set:function(a,b,c,d,e,g){null==g&&(g=0);null==e&&(e=0);null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.m_xMin=a;this.m_yMin=c;this.m_zMin=e;this.m_xMax=b;this.m_yMax=d;this.m_zMax=g;this.Validate();return this},Set3:function(a,b){return this.Set(a.x,b.x,a.y,b.y,a.z,b.z)},SetAABB3:function(a){this.m_xMin=a.m_xMin;this.m_yMin=a.m_yMin;this.m_zMin=a.m_zMin;this.m_xMax=a.m_xMax;this.m_yMax=a.m_yMax;this.m_zMax=a.m_zMax;return this},SetXYZWHD:function(a,b,c,d,e,g){null==g&&(g=0);null==
e&&(e=0);null==d&&(d=0);null==b&&(b=0);null==a&&(a=0);this.m_xMin=a;this.m_zMin=this.m_yMin=b;this.m_xMax=this.m_xMin+d;this.m_yMax=this.m_yMin+e;this.m_zMax=this.m_zMin+g;return this},Encapsulate:function(a){return this.Encapsulate3(a.x,a.y,a.z)},Encapsulate3:function(a,b,c){null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.m_xMin=Math.min(a,this.m_xMin);this.m_xMax=Math.max(a,this.m_xMax);this.m_yMin=Math.min(b,this.m_yMin);this.m_yMax=Math.max(b,this.m_yMax);this.m_zMin=Math.min(c,this.m_zMin);
this.m_zMax=Math.max(c,this.m_zMax);this.Validate();return this},ToString:function(a){null==a&&(a=2);var b=l.RoundPlaces(this.m_xMin,a)+"",c=l.RoundPlaces(this.m_xMax,a)+"",d=l.RoundPlaces(this.m_yMin,a)+"",e=l.RoundPlaces(this.m_yMax,a)+"",g=l.RoundPlaces(this.m_zMin,a)+"";a=l.RoundPlaces(this.m_zMax,a)+"";return"["+b+","+c+"|"+d+","+e+"|"+g+","+a+"]"},__class__:ba,__properties__:{set_size:"set_size",get_size:"get_size",set_depth:"set_depth",get_depth:"get_depth",set_height:"set_height",get_height:"get_height",
set_width:"set_width",get_width:"get_width",set_z:"set_z",get_z:"get_z",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x",set_center:"set_center",get_center:"get_center",set_zMax:"set_zMax",get_zMax:"get_zMax",set_yMax:"set_yMax",get_yMax:"get_yMax",set_xMax:"set_xMax",get_xMax:"get_xMax",set_zMin:"set_zMin",get_zMin:"get_zMin",set_yMin:"set_yMin",get_yMin:"get_yMin",set_xMin:"set_xMin",get_xMin:"get_xMin",set_max:"set_max",get_max:"get_max",set_min:"set_min",get_min:"get_min",get_clone:"get_clone"}};
var Nd=function(){};k["haxor.math.Easing"]=Nd;Nd.__name__=["haxor","math","Easing"];var Tb=function(){};k["haxor.math.Trig"]=Tb;Tb.__name__=["haxor","math","Trig"];Tb.Acos=function(a){return.3183098861837907*Math.acos(-2*a+1)};Tb.AcosQuad=function(a){return l.Pow(Tb.Acos(a),2)};Tb.AcosRad=function(a){return l.Pow(Tb.Acos(a),.5)};Tb.Cos=function(a){return.5*(-Math.cos(3.141592653589793*a)+1)};var gb=function(){};k["haxor.math.Cubic"]=gb;gb.__name__=["haxor","math","Cubic"];gb.In=function(a){return a*
a*a};gb.Out=function(a){return a*(a*(a-3)+3)};gb.InOut=function(a){return-2*a*a*(a-1.5)};gb.OutIn=function(a){return a*(a*(4*a-6)+3)};gb.BackIn=function(a){return a*a*(4*a-3)};gb.OutBack=function(a){return a*(a*(4*a-9)+6)};var Lc=function(){};k["haxor.math.Elastic"]=Lc;Lc.__name__=["haxor","math","Elastic"];Lc.OutBig=function(a){return a*(a*(a*(a*(56*a+-175)+200)+-100)+20)};Lc.OutSmall=function(a){return a*(a*(a*(a*(33*a+-106)+126)+-67)+15)};Lc.InBig=function(a){return a*a*(a*(a*(33*a+-59)+32)+-5)};
Lc.InSmall=function(a){return a*a*(a*(a*(56*a+-105)+60)+-10)};var l=function(){};k["haxor.math.Mathf"]=l;l.__name__=["haxor","math","Mathf"];l.IsPOT=function(a){return 0<a&&0==(a&a-1)};l.NextPOT=function(a){--a;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;return++a};l.Sign=function(a){return 0>a?-1:1};l.SignInt=function(a){return 0>a?-1:1};l.Abs=function(a){return 0>a?-a:a};l.AbsInt=function(a){return 0>a?-a:a};l.Clamp=function(a,b,c){return a<=b?b:a>=c?c:a};l.Clamp01=function(a){return 0>=a?0:1<=a?1:
a};l.ClampInt=function(a,b,c){return(a<=b?b:a>=c?c:a)|0};l.Min=function(a,b){return Math.min(a,b)};l.MinRange=function(a){if(0>=a.length)return 0;for(var b=a[0],c=1,d=a.length;c<d;)var e=c++,b=Math.min(b,a[e]);return b};l.Max=function(a,b){return Math.max(a,b)};l.MaxRange=function(a){if(0>=a.length)return 0;for(var b=a[0],c=1,d=a.length;c<d;)var e=c++,b=Math.max(b,a[e]);return b};l.MinInt=function(a,b){return Math.min(a,b)};l.MaxInt=function(a,b){return Math.max(a,b)};l.Sin=function(a){return Math.sin(a)};
l.Cos=function(a){return Math.cos(a)};l.Asin=function(a){return Math.asin(a)};l.Acos=function(a){return Math.acos(a)};l.Tan=function(a){return Math.tan(a)};l.ATan=function(a){return Math.atan(a)};l.ATan2=function(a,b){return Math.atan2(a,b)};l.Sqrt=function(a){return Math.sqrt(a)};l.Pow=function(a,b){return Math.pow(a,b)};l.Floor=function(a){return a|0};l.Ceil=function(a){return a+(0>a?-.9999999:.9999999)|0};l.Inverse=function(a){return 0>=(0>a?-a:a)?0:1/a};l.Round=function(a){return a+(0>a?-.5:.5)|
0};l.RoundPlaces=function(a,b){null==b&&(b=2);var c=Math.pow(10,b);return l.Round(a*c)/c};l.Lerp=function(a,b,c){return a+(b-a)*c};l.LerpInt=function(a,b,c){return w["int"](l.Lerp(a,b,c))};l.Frac=function(a){return a-Math.floor(a)};l.Loop=function(a,b,c){var d=Math.min(b,c),e=Math.max(b,c)-d;if(0>=e)return d;d=(a-b)/e;a=0>a?1-l.Frac(0>d?-d:d):d-Math.floor(d);return b+(c-b)*a};l.Linear2Gamma=function(a){return Math.pow(a,2.2)};l.Oscilate=function(a,b,c){a=-l.Abs(l.Loop(a-1,-1,1))+1;return a+(b-a)*
c};l.WrapAngle=function(a){return-360>a?360+a:360<a?a-360:a};var pa=function(){};k["haxor.math.Random"]=pa;pa.__name__=["haxor","math","Random"];pa.__properties__={get_onCircle:"get_onCircle",get_circle:"get_circle",get_onSphere:"get_onSphere",get_sphere:"get_sphere",get_onSquare:"get_onSquare",get_square:"get_square",get_onBox:"get_onBox",get_box:"get_box",get_rotation:"get_rotation",get_interval:"get_interval",get_value:"get_value"};pa.get_value=function(){return Math.random()};pa.get_interval=
function(){return 2*(Math.random()-.499995)};pa.get_rotation=function(){return F.FromAxisAngle((new n(2*(Math.random()-.499995),2*(Math.random()-.499995),2*(Math.random()-.499995))).Normalize().Scale(Math.random()),360*(Math.random()-.499995))};pa.get_box=function(){return new n(1*(Math.random()-.499995),1*(Math.random()-.499995),1*(Math.random()-.499995))};pa.get_onBox=function(){var a=new n(1*(Math.random()-.499995),1*(Math.random()-.499995),1*(Math.random()-.499995));switch(3*Math.random()+.5){case 0:a.x=
0>a.x?-.5:.5;break;case 1:a.y=0>a.y?-.5:.5;break;case 2:a.z=0>a.z?-.5:.5}return a};pa.get_square=function(){return new K(1*(Math.random()-.499995),1*(Math.random()-.499995))};pa.get_onSquare=function(){var a=new K(1*(Math.random()-.499995),1*(Math.random()-.499995));switch(2*Math.random()+.5){case 0:a.x=0>a.x?-.5:.5;break;case 1:a.y=0>a.y?-.5:.5}return a};pa.get_sphere=function(){return(new n(2*(Math.random()-.499995),2*(Math.random()-.499995),2*(Math.random()-.499995))).Normalize().Scale(Math.random())};
pa.get_onSphere=function(){return(new n(2*(Math.random()-.499995),2*(Math.random()-.499995),2*(Math.random()-.499995))).Normalize()};pa.get_circle=function(){return(new K(2*(Math.random()-.499995),2*(Math.random()-.499995))).Normalize().Scale(Math.random())};pa.get_onCircle=function(){return(new K(2*(Math.random()-.499995),2*(Math.random()-.499995))).Normalize()};pa.Length=function(a){return(a+1)*Math.random()};pa.Range=function(a,b){return l.Lerp(a,b,Math.random())};pa.RangeInt=function(a,b){return l.LerpInt(a,
b+1,Math.random())};pa.Item=function(a){return a[a.length*Math.random()]};pa.Shuffle=function(a){for(var b=a.length,c,d;0<b;)d=Math.floor(Math.random()*b--),c=a[b],a[b]=a[d],a[d]=c};var K=function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b};k["haxor.math.Vector2"]=K;K.__name__=["haxor","math","Vector2"];K.__properties__={get_up:"get_up",get_right:"get_right",get_one:"get_one",get_zero:"get_zero",get_temp:"get_temp"};K.get_temp=function(){return g.data.get_v2()};K.get_zero=function(){return new K(0,
0)};K.get_one=function(){return new K(1,1)};K.get_right=function(){return new K(1,0)};K.get_up=function(){return new K(0,1)};K.Dot=function(a,b){return a.x*b.x+a.y*b.y};K.Lerp=function(a,b,c){return new K(a.x+(b.x-a.x)*c,a.y+(b.y-a.y)*c)};K.Parse=function(a,b){null==b&&(b=" ");var c=a.split(b);return(new K(0,0)).Set(w.parseFloat(B.trim(c[0])),w.parseFloat(B.trim(c[1])))};K.prototype={get_clone:function(){return new K(this.x,this.y)},get_xy:function(){return new K(this.x,this.y)},get_yx:function(){return new K(this.y,
this.x)},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},get_lengthSqr:function(){return this.x*this.x+this.y*this.y},get_normalized:function(){return(new K(this.x,this.y)).Normalize()},get_inverse:function(){return(new K(this.x,this.y)).Invert()},Set:function(a,b){null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;return this},Set2:function(a){this.x=a.x;this.y=a.y;return this},Set3:function(a){this.x=a.x;this.y=a.y;return this},Set4:function(a){this.x=a.x;this.y=a.y;return this},
Get:function(a){return 0==a?this.x:this.y},Add:function(a){this.x+=a.x;this.y+=a.y;return this},Sub:function(a){this.x-=a.x;this.y-=a.y;return this},Multiply:function(a){this.x*=a.x;this.y*=a.y;return this},Scale:function(a){this.x*=a;this.y*=a;return this},Step:function(a,b){var c=a.x-this.x,d=a.y-this.y,e=Math.sqrt(c*c+d*d);if(1E-4>=e)return!1;e=(b>e?e:b)/e;this.x+=c*e;this.y+=d*e;return!0},Reflect:function(a){var b=2*Math.min(0,a.x*this.x+a.y*this.y);this.x+=-a.x*b;this.y+=-a.y*b;return this},
Invert:function(){this.x=-this.x;this.y=-this.y;return this},Normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(0>=a)return this;this.x*=a=1/a;this.y*=a;return this},ToArray:function(){return[this.x,this.y]},ToString:function(a){null==a&&(a=2);return"["+l.RoundPlaces(this.x,a)+","+l.RoundPlaces(this.y,a)+"]"},__class__:K,__properties__:{get_inverse:"get_inverse",get_normalized:"get_normalized",get_lengthSqr:"get_lengthSqr",get_length:"get_length",get_yx:"get_yx",get_xy:"get_xy",
get_clone:"get_clone"}};var Q=function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d};k["haxor.math.Vector4"]=Q;Q.__name__=["haxor","math","Vector4"];Q.__properties__={get_W:"get_W",get_one:"get_one",get_zero:"get_zero",get_temp:"get_temp"};Q.get_temp=function(){return g.data.get_v4()};Q.get_zero=function(){return new Q(0,0,0,0)};Q.get_one=function(){return new Q(1,1,1,1)};Q.get_W=function(){return new Q(0,0,0,1)};Q.Lerp=function(a,b,c){return new Q(a.x+
(b.x-a.x)*c,a.y+(b.y-a.y)*c,a.z+(b.z-a.z)*c,a.w+(b.w-a.w)*c)};Q.Parse=function(a,b){null==b&&(b=" ");var c=a.split(b);return(new Q(0,0,0,0)).Set(w.parseFloat(B.trim(c[0])),w.parseFloat(B.trim(c[1])),w.parseFloat(B.trim(c[2])),w.parseFloat(B.trim(c[3])))};Q.prototype={get_clone:function(){return new Q(this.x,this.y,this.z,this.w)},get_rgba:function(){return new t(this.x,this.y,this.z,this.w)},get_rgb:function(){return new t(this.x,this.y,this.z)},get_xyz:function(){return new n(this.x,this.y,this.z)},
get_xy:function(){return new K(this.x,this.y)},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},get_lengthSqr:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},get_normalized:function(){return(new Q(this.x,this.y,this.z,this.w)).Normalize()},Get:function(a){return 0==a?this.x:1==a?this.y:2==a?this.z:this.w},Set:function(a,b,c,d){null==d&&(d=0);null==c&&(c=0);null==b&&(b=0);null==a&&(a=0);this.x=a;this.y=b;this.z=c;this.w=d;return this},
Set2:function(a){this.x=a.x;this.y=a.y;return this},Set3:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},Set4:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},SetColor:function(a){this.x=a.r;this.y=a.g;this.z=a.b;return this},Add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},Sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},Multiply:function(a){this.x*=a.x;this.y*=a.y;this.z*=a.z;this.w*=a.w;return this},Scale:function(a){this.x*=
a;this.y*=a;this.z*=a;this.w*=a;return this},Normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0>=a)return this;this.x*=a=1/a;this.y*=a;this.z*=a;this.w*=a;return this},IsCulled:function(){return this.x<-this.w||this.x>this.w||this.y<-this.w||this.y>this.w||this.z<-this.w||this.z>this.w?!0:!1},ToArray:function(){return[this.x,this.y,this.z,this.w]},ToString:function(a){null==a&&(a=2);return"["+l.RoundPlaces(this.x,a)+","+l.RoundPlaces(this.y,a)+","+l.RoundPlaces(this.z,
a)+","+l.RoundPlaces(this.w,a)+"]"},__class__:Q,__properties__:{get_normalized:"get_normalized",get_lengthSqr:"get_lengthSqr",get_length:"get_length",get_xy:"get_xy",get_xyz:"get_xyz",get_rgb:"get_rgb",get_rgba:"get_rgba",get_clone:"get_clone"}};var ja=function(a,b,c){null==c&&(c=!1);v.call(this);null!=a&&(this.m_time_start=q.m_elapsed,this.m_elapsed=0,this.m_callback=a,b=this.m_cancelled=!1,c&&(b=!1),b||(c?g.render.Add(this):g.update.Add(this)))};k["haxor.thread.Activity"]=ja;ja.__name__=["haxor",
"thread","Activity"];ja.__interfaces__=[Mb,$a];ja.Iterate=function(a,b,c,d,e,g){null==g&&(g=!1);null==e&&(e=!1);null==d&&(d=1);var h=a;return new ja(function(a){a=!1;for(var e=0;e<d;){e++;if(h>=b)return!1;if(!c(h)){a=!0;break}h++}return!a},e,g)};ja.Delay=function(a,b,c,d){null==d&&(d=!1);null==c&&(c=!1);return new ja(function(c){return c>=a?(b(),!1):!0},c,d)};ja.Run=function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);return new ja(a,b,c)};ja.RunOnce=function(a,b,c){null==c&&(c=!1);null==b&&(b=!1);return new ja(function(b){a();
return!1},b,c)};ja.__super__=v;ja.prototype=s(v.prototype,{get_elapsed:function(){return this.m_elapsed},Cancel:function(){this.m_cancelled=!0},OnUpdate:function(){this.OnRun()},OnRender:function(){this.OnRun()},OnRun:function(){this.m_cancelled?v.Destroy(this):(this.m_elapsed=q.m_elapsed-this.m_time_start,this.m_callback(this.m_elapsed)||v.Destroy(this))},__class__:ja,__properties__:s(v.prototype.__properties__,{get_elapsed:"get_elapsed"})});var Ub=function(a,b){null==a&&(a=!1);var c=b;null==c&&
(c=ha(this,this.OnExecute));ja.call(this,c,a);this.m_active=!1;this.m_progress=0;this.m_has_progress=!1};k["haxor.thread.Task"]=Ub;Ub.__name__=["haxor","thread","Task"];Ub.__super__=ja;Ub.prototype=s(ja.prototype,{get_progress:function(){return this.m_progress},set_progress:function(a){0<Math.abs(a-this.m_progress)&&(this.m_progress=a,this.m_has_progress=!0);return a},get_active:function(){return this.m_active},OnStart:function(){},OnStep:function(){},OnComplete:function(){},OnProgress:function(){},
OnExecute:function(a){this.m_active||(this.m_active=!0,this.OnStart());this.OnStep();this.m_has_progress&&(this.OnProgress(),this.m_has_progress=!1);return 1<=this.m_progress?(this.OnComplete(),!1):!0},__class__:Ub,__properties__:s(ja.prototype.__properties__,{get_active:"get_active",set_progress:"set_progress",get_progress:"get_progress"})});var Vb=function(a,b,c,d){Ub.call(this);0<=a.indexOf("./")&&(a=B.replace(a,"./",ya.root));this.url=a;this.binary=c;this.method=b;this.data=d;this.bytesTotal=
this.bytesLoaded=0;this.error="";u.Log("HTTPRequest> "+this.url,6)};k["haxor.net.HTTPRequestTask"]=Vb;Vb.__name__=["haxor","net","HTTPRequestTask"];Vb.__super__=Ub;Vb.prototype=s(Ub.prototype,{OnStart:function(){},OnError:function(){u.LogError("HTTPRequest> Error ["+this.error+"]")},__class__:Vb});var Fb=function(a,b,c,d){var e=this;Vb.call(this,a,b,c,d);this.request=new XMLHttpRequest;this.request.withCredentials&&(this.request.withCredentials=!1);null!=(Mc=this.request,ha(Mc,Mc.overrideMimeType))&&
this.request.overrideMimeType(c?"application/octet-stream":"text/plain");this.request.onprogress=function(a){e.bytesLoaded=a.loaded;e.bytesTotal=a.total;e.set_progress(.999*(0>=a.total?0:a.loaded/(a.total+5)))};this.request.onload=function(a){e.set_progress(1)};this.request.onerror=function(a){e.request=null;e.set_progress(1);e.error=a.message;e.OnError()};this.request.open(this.method,this.url,!0)};k["haxor.platform.html.net.HTTPRequest"]=Fb;Fb.__name__=["haxor","platform","html","net","HTTPRequest"];
Fb.__super__=Vb;Fb.prototype=s(Vb.prototype,{OnStart:function(){null==this.data?this.request.send():this.request.send(this.data)},__class__:Fb});var Gb=function(a,b,c){Fb.call(this,a,"get",b);this.callback=c};k["haxor.platform.html.net.HTTPLoader"]=Gb;Gb.__name__=["haxor","platform","html","net","HTTPLoader"];Gb.__super__=Fb;Gb.prototype=s(Fb.prototype,{OnStart:function(){Fb.prototype.OnStart.call(this);null!=this.callback&&this.callback(null,0)},OnComplete:function(){null!=this.callback&&(null==
this.request?this.callback(null,1):(this.response=this.request.response,this.binary?this.callback(this.request.response,1):this.callback(this.request.responseText,1)))},__class__:Gb});var xb=function(a,b){Gb.call(this,a,!0,ha(this,this.OnBufferCallback));this.m_bitmap_callback=b;this.request.responseType="blob"};k["haxor.platform.html.net.BitmapLoader"]=xb;xb.__name__=["haxor","platform","html","net","BitmapLoader"];xb.__super__=Gb;xb.prototype=s(Gb.prototype,{OnBufferCallback:function(a,b){var c=
this;if(1>b)null!=this.m_bitmap_callback&&this.m_bitmap_callback(null,this.m_progress);else if(null!=a){var d=new Image;d.onload=function(a){a=window.document.createElement("canvas").getContext("2d");a.canvas.width=d.width;a.canvas.height=d.height;a.scale(1,-1);a.drawImage(d,0,-d.height);a=a.getImageData(0,0,a.canvas.width,a.canvas.height);var b=a.width,e=a.height,g=y.RGBA8;switch(a.data.byteLength/(b*e)|0){case 1:g=y.Alpha8;break;case 3:g=y.RGB8}b=new fc(b,e,g);b.get_buffer().m_buffer.set(a.data);
null!=c.m_bitmap_callback&&c.m_bitmap_callback(b,1)};d.src=URL.createObjectURL(this.request.response)}},OnError:function(){null!=this.m_bitmap_callback&&this.m_bitmap_callback(null,1)},__class__:xb});var ic=function(a,b,c){xb.call(this,a,ha(this,this.OnBitmapCallback));this.m_t2d_callback=c;this.m_apply=b};k["haxor.net.Texture2DLoader"]=ic;ic.__name__=["haxor","net","Texture2DLoader"];ic.__super__=xb;ic.prototype=s(xb.prototype,{OnBitmapCallback:function(a,b){var c=this;1>this.m_progress?null!=this.m_t2d_callback&&
this.m_t2d_callback(null,this.m_progress):null!=a&&ja.RunOnce(function(){var b=z.FromBitmap(a,c.m_apply);c.m_t2d_callback(b,1)},!1,!0)},OnError:function(){xb.prototype.OnError.call(this);null!=this.m_t2d_callback&&this.m_bitmap_callback(null,1)},__class__:ic});var ya=function(){};k["haxor.net.Web"]=ya;ya.__name__=["haxor","net","Web"];ya.Load=function(a,b){new Gb(a,!1,b)};ya.LoadImg=function(a,b){new xb(a,b)};ya.LoadTexture2D=function(a,b,c){new ic(a,b,c)};ya.LoadTextureCubeCross=function(a,b,c){new ic(a,
!0,function(a,b){if(1>b)c(null,b);else if(null==a)c(null,1);else{var e=new Jc;e.LoadCrossTexture(a);v.Destroy(a);c(e,1)}})};ya.LoadCollada=function(a,b){ya.Load(a,function(c,d){1>d?b(null,d):b(null==c?null:new pb(a,c),1)})};ya.LoadShader=function(a,b){ya.Load(a,function(a,d){1>d?b(null,d):b(null==a?null:new C(a),1)})};ya.LoadMaterial=function(a,b){ya.Load(a,function(a,d){1>d?b(null,d):b(null==a?null:new bc(a),1)})};var ac=function(){this.normal=new n(0,0,0);this.point=new n(0,0,0);this.speed=this.depth=
0;this.usid=-1};k["haxor.physics.Collision"]=ac;ac.__name__=["haxor","physics","Collision"];ac.__interfaces__=[kd];ac.prototype={Invert:function(){var a=this.from;this.from=this.to;this.to=a;this.normal.Invert();return this},Reset:function(){this.normal.Set();this.point.Set();this.speed=this.depth=0},__class__:ac};var Hd=function(){this.iterations=3};k["haxor.physics.CollisionSolver"]=Hd;Hd.__name__=["haxor","physics","CollisionSolver"];Hd.prototype={Step:function(){for(var a=this.broadphase.pairs,
b,c=0,d=this.iterations;c<d;){c++;for(var e=0,g=a.get_length();e<g;)b=e++,b=a.Get(b),this.Solve(b),this.Apply(b)}},Solve:function(a){var b=a.from,c=a.to,d=b.get_type(),e=c.get_type();d==Y.Box&&e==Y.Box?this.SolveBoxBox(b,c,a):d==Y.Sphere&&e==Y.Box?this.SolveSphereBox(b,c,a):d==Y.Box&&e==Y.Sphere?this.SolveSphereBox(c,b,a):d==Y.Sphere&&e==Y.Sphere&&this.SolveSphereSphere(b,c,a)},Apply:function(a){var b=g.physics.crb[a.from.__cid],c=g.physics.crb[a.to.__cid],d;d=null==b?0:b.get_mass();var e;e=null==
c?0:c.get_mass();var h;h=0>=d+e?0:1/(d+e);e=null==c?0:e*h;null!=b&&this.Resolve(b,a,null==b?0:d*h);a.Invert();null!=c&&this.Resolve(c,a,e);a.Invert()},Resolve:function(a,b,c){c=n.Dot(b.normal,a.get_velocity());b.speed=c;var d=b.from,e=b.to,g=!(d.trigger||e.trigger);!a.kinematic&&g&&0>b.depth&&(d=d.material,null==d&&(d=Ta.get_empty()),e=e.material,null==e&&(e=Ta.get_empty()),e=.5*(d.bounce+e.bounce),0>c&&(c=-(1+e)*n.Dot(a.get_velocity(),b.normal),e=a.get_velocity(),e.x+=b.normal.x*c,e.y+=b.normal.y*
c,e.z+=b.normal.z*c,a.set_velocity(e),c=-.9*b.depth*q.get_fixedDelta(),e=a.m_entity.m_transform.get_localPosition(),e.x+=b.normal.x*c,e.y+=b.normal.y*c,e.z+=b.normal.z*c,a.m_entity.m_transform.set_localPosition(e)))},SolveBoxBox:function(a,b,c){},SolveSphereSphere:function(a,b,c){var d=a.m_entity.m_transform.get_WorldMatrix(),e=b.m_entity.m_transform.get_WorldMatrix(),h=g.data.get_v3().Set3(a.m_center);d.Transform3x4(h);a=g.data.get_v3().Set(0,0,a.get_radius());d.Transform3x3(a);d=Math.sqrt(a.x*a.x+
a.y*a.y+a.z*a.z);a=g.data.get_v3().Set3(b.m_center);e.Transform3x4(a);b=g.data.get_v3().Set(0,0,b.get_radius());e.Transform3x3(b);e=Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z);b=2*n.Distance(h,a);c.depth=b-(d+e);0>c.depth&&(c.normal.x=h.x-a.x,c.normal.y=h.y-a.y,c.normal.z=h.z-a.z,c.normal.Normalize(),c.point.Set3(h),h=g.data.get_v3().Set3(c.normal),h.Scale(.5*-(d+c.depth)),c.point.Add(h))},SolveSphereBox:function(a,b,c){var d=a.m_entity.m_transform.get_WorldMatrix(),e=b.m_entity.m_transform.get_WorldMatrix(),
h=b.m_entity.m_transform.get_WorldMatrixInverse(),k=g.data.get_v3().Set3(a.m_center);d.Transform3x4(k);h.Transform3x4(k);a=g.data.get_v3().Set(0,0,a.get_radius());d.Transform3x3(a);var d=g.data.get_v3().Set3(b.m_center),p=g.data.get_v3().Set3(b.get_size()),h=.5*p.x;b=d.x-h;var h=d.x+h,q=.5*p.y,r=d.y-q,q=d.y+q,s=.5*p.z,p=d.z-s,s=d.z+s,d=g.data.get_v3();d.x=l.Max(b,Math.min(h,k.x));d.y=l.Max(r,Math.min(q,k.y));d.z=l.Max(p,Math.min(s,k.z));e.Transform3x4(d);e.Transform3x4(k);e=.5*Math.sqrt(a.x*a.x+a.y*
a.y+a.z*a.z);a=n.Distance(d,k);c.depth=a-e;0>c.depth&&(c.point.Set3(d),c.normal.x=k.x-d.x,c.normal.y=k.y-d.y,c.normal.z=k.z-d.z,c.normal.Normalize())},__class__:Hd};var S=function(){};k["haxor.physics.Physics"]=S;S.__name__=["haxor","physics","Physics"];S.__properties__={get_solver:"get_solver",set_broadphase:"set_broadphase",get_broadphase:"get_broadphase"};S.get_broadphase=function(){return S.m_broadphase};S.set_broadphase=function(a){if(null==a)return S.m_broadphase;S.m_broadphase=a;S.m_broadphase.Initialize();
return S.m_broadphase};S.get_solver=function(){return S.m_solver};S.Initialize=function(){u.Log("Physics> Initialize",5);S.m_it=new Pb;for(var a=0;32>a;)for(var b=a++,c=0;32>c;){var d=c++;S.SetInteraction(1<<b,1<<d,!1)}S.SetInteraction(1,1,!0);S.gravity=new n(0,-9.81,0);S.set_broadphase(new Nc);S.m_solver=new Hd;u.Log("\tSAP Broadphase",5);u.Log("\tSolver iterations["+S.m_solver.iterations+"]",5)};S.SetInteraction=function(a,b,c){S.m_it.set(a|b,c)};S.CanInteract=function(a,b){var c=a|b;return S.m_it.exists(c)?
S.m_it.get(c):!1};var Ta=function(){v.call(this);this.friction=this.bounce=0};k["haxor.physics.PhysicsMaterial"]=Ta;Ta.__name__=["haxor","physics","PhysicsMaterial"];Ta.__properties__={get_empty:"get_empty"};Ta.get_empty=function(){if(null!=Ta.m_empty)return Ta.m_empty;Ta.m_empty=new Ta;Ta.m_empty.set_name("$DefaultPhysicsMaterial");return Ta.m_empty};Ta.__super__=v;Ta.prototype=s(v.prototype,{__class__:Ta});var jc=function(){this.pairs=new ld;this.m_table=new id(800,null,!0);this.m_table.Iterate(ha(this,
this.InitCollisions))};k["haxor.physics.broadphase.BroadPhase"]=jc;jc.__name__=["haxor","physics","broadphase","BroadPhase"];jc.prototype={Initialize:function(){},Step:function(){},Update:function(a){},Add:function(a){},Remove:function(a){},Query:function(a){},Clear:function(a){a=a.__cid;for(var b,c=0;c<a;)b=c++,b=this.m_table.Get(b,a),this.pairs.Remove(b);for(var c=a+1,d=this.m_table.get_rows();c<d;)b=c++,b=this.m_table.Get(a,b),this.pairs.Remove(b)},OnFetch:function(a,b){var c;c=a.__cid>b.__cid?
a.__cid:b.__cid;var d;d=a.__cid<b.__cid?a.__cid:b.__cid;if(c!=d){var e=g.physics.crb[c],h=g.physics.crb[d];null==e&&null==h||null!=e&&!e.get_enabled()||null!=h&&!h.get_enabled()||(e=c>d?a:b,e.get_enabled()&&(h=c<d?a:b,h.get_enabled()&&S.CanInteract(e.m_entity.m_layer,h.m_entity.m_layer)&&(c=this.m_table.Get(c,d),c.Reset(),c.from=e,c.to=h,this.pairs.Add(c))))}},InitCollisions:function(a,b,c){this.m_table.Set(a,b,new ac)},__class__:jc};var Nc=function(){jc.call(this)};k["haxor.physics.broadphase.SAPBroadPhase"]=
Nc;Nc.__name__=["haxor","physics","broadphase","SAPBroadPhase"];Nc.__super__=jc;Nc.prototype=s(jc.prototype,{Initialize:function(){this.sap=new Ec(0)},Update:function(a){a.m_aabb_dirty&&(a.GenerateAABB(),a.m_aabb_dirty=!1);var b=a.m_aabb,c=g.data.get_v3().Set(b.m_xMin,b.m_yMin,b.m_zMin),b=g.data.get_v3().Set(b.m_xMax,b.m_yMax,b.m_zMax);this.sap.Update(a.__cid,a,c,b)},Add:function(a){this.sap.Create(a.__cid)},Remove:function(a){this.sap.Remove(a.__cid)},Query:function(a){this.sap.Query(a.__cid,ha(this,
this.OnSAPFetch))},OnSAPFetch:function(a,b){this.OnFetch(a,b)},__class__:Nc});var I=function(){};k["haxor.platform.html.Entry"]=I;I.__name__=["haxor","platform","html","Entry"];I.Initialize=function(){window.onload=I.OnWindowLoad};I.OnWindowLoad=function(a){u.Initialize();var b=window.document.getElementsByTagName("SCRIPT"),c="";a="Main";for(var d="haxor",f="haxor",h=0,k=b.length;h<k;){var c=h++,l=b.item(c),c=l.getAttribute("verbose");null!=c&&(""==c&&(c="0"),u.verbose=w.parseInt(c));c=l.getAttribute("application");
null!=c&&(a=c);c=l.getAttribute("container");null!=c&&(d=c);c=l.getAttribute("input");null!=c&&(f=c)}u.Log("Haxor> HTML Platform Init verbose["+u.verbose+"] application["+a+"] container["+d+"]",1);b=window.document.getElementsByTagName("strings");if(null!=b&&0<b.length){k=h=0;for(c=b.length;k<c;){for(var l=k++,l=b.item(l),n=l.childNodes,q=0,s=n.length;q<s;){var t=q++,t=n.item(t);switch(t.nodeName.toLowerCase()){case "entry":var v=t.getAttribute("key");r.Add(v,t.textContent);h++}}l.remove()}u.Log("Haxor> Found "+
h+" Strings",2)}if(""==a)u.Log("Haxor> Error. You must define an Application class.");else if(b=ib.resolveClass(a),null==b)u.Log("Haxor> Error. Class ["+a+"] not found! Try adding 'import "+a+"' in your Main file.");else if(Ja.Initialize(),h=new wa("application"),I.m_application=h.AddComponent(b),J.__instanceof(I.m_application,Za)){u.Log("Haxor> Application ["+a+"] created successfully!",1);I.m_application.m_container=window.document.getElementById(d);null==I.m_application.m_container&&(u.Log("Graphics> DOM container not defined id["+
d+"] using 'body'."),I.m_application.m_container=window.document.body);var x=I.m_application.m_container.style.display;I.m_application.m_container.style.display="none";e.Initialize(I.m_application);e.m_gl.Initialize(d);e.m_gl.CheckExtensions();u.Log("Haxor> Creating Stage with ["+d+"]",1);(new T(I.m_application.m_container)).Parse(I.m_application.m_container);jb.delay(function(){I.m_application.m_container.style.display=x},100);g.Build();I.m_input=new Oc(f);p.m_handler=I.m_input;I.m_raf_enabled=null!=
(Mc=window,ha(Mc,Mc.requestAnimationFrame));I.m_has_pc=null!=window.performance;I.m_raf_id=-1;I.m_interval_id=-1;I.m_step_clock=-1;I.m_application.set_runOnBackground(!0);I.Run();I.m_application.Load()&&I.m_application.LoadComplete()}else u.Log("Haxor> Error. Class ["+a+"] does not extends Application!")};I.Run=function(){I.CancelInterval();I.m_raf_enabled&&(I.CancelRAF(),I.m_raf_offset_clock=I.m_has_pc?window.performance.now():0,I.m_raf_id=window.requestAnimationFrame(I.RAFLoop))};I.Step=function(a,
b){0>I.m_step_clock&&(I.m_step_clock=a);var c=a-I.m_step_clock;I.m_step_clock=a;for(var c=b?1:Math.max(1,c/16|0),d=0;d<c;)d++,q.m_system=I.m_has_pc?window.performance.now():a,I.m_application.Update(),b&&I.m_application.Render()};I.RAFLoop=function(a){a=I.m_has_pc?window.performance.now():a;I.Step(a-I.m_raf_offset_clock,!0);I.m_raf_id=window.requestAnimationFrame(I.RAFLoop);return!0};I.IntervalLoop=function(){var a="hidden"!=window.document.visibilityState;if(!a&&I.m_application.get_runOnBackground()){var b;
b=I.m_has_pc?window.performance.now():1E3*jb.stamp();I.Step(b-I.m_itv_offset_clock,a)}};I.CancelRAF=function(){0<I.m_raf_id&&window.cancelAnimationFrame(I.m_raf_id);I.m_raf_id=-1};I.CancelInterval=function(){0<I.m_interval_id&&window.clearInterval(I.m_interval_id);I.m_interval_id=-1};var Gc=function(a){ec.call(this,a);this.m_api=Ma.WebGL};k["haxor.platform.html.graphics.WebGL"]=Gc;Gc.__name__=["haxor","platform","html","graphics","WebGL"];Gc.__super__=ec;Gc.prototype=s(ec.prototype,{Initialize:function(a){this.m_application.m_container=
this.m_container=window.document.getElementById(a);if(null==this.m_container)return u.Log("Graphics> Canvas container not defined id["+a+"]."),!1;this.m_canvas=window.document.createElement("canvas");this.m_canvas.style.position="absolute";this.m_canvas.style.left="0px";this.m_canvas.style.top="0px";this.m_canvas.style.width="100%";this.m_canvas.style.height="100%";this.m_canvas.width=this.m_container.clientWidth;this.m_canvas.height=this.m_container.clientHeight;this.m_canvas.id="haxor-canvas";a=
this.m_container.firstElementChild;this.m_container.appendChild(this.m_canvas);null!=a&&this.m_container.insertBefore(this.m_canvas,a);a={};var b="alpha antialias depth stencil premultipliedAlpha preserveDrawingBuffer".split(" "),c=[!1,!1,!0,!1,!0,!1];u.Log("Graphics> Initialize WebGL",1);for(var d=0,e=b.length;d<e;){var g=d++,h=b[g],k=this.m_container.getAttribute(b[g]),k=null==k?c[g]:"true"==k;u.Log("\t"+b[g]+": "+(null==k?"null":""+k),1);a[h]=k}this.c=Ld.getContextWebGL(this.m_canvas,a);return null==
this.c?(u.Log("Graphics> Could not create RenderingContext3D."),!1):!0},CheckExtensions:function(){if(null!=this.c){u.Log("Graphics> Available Extensions.",1);for(var a=this.c.getSupportedExtensions(),b=0,c=a.length;b<c;){var d=b++;if(!(0<=a[d].indexOf("MOZ_")||0<=a[d].indexOf("WEBKIT_"))){var f=this.c.getExtension(a[d]);u.Log("\t"+a[d],1);switch(a[d]){case "EXT_sRGB":e.TEXTURE_SRGB=!0;break;case "OES_vertex_array_object":e.VAO_ENABLED=!1;this.vao=f;break;case "OES_texture_half_float":e.HALF_FLOAT=
36193;e.TEXTURE_HALF=!0;break;case "OES_texture_half_float_linear":e.TEXTURE_HALF_LINEAR=!0;break;case "EXT_texture_filter_anisotropic":case "WEBKIT_EXT_texture_filter_anisotropic":e.TEXTURE_ANISOTROPY=f.TEXTURE_MAX_ANISOTROPY_EXT;e.MAX_TEXTURE_ANISOTROPY=this.c.getParameter(f.MAX_TEXTURE_MAX_ANISOTROPY_EXT);e.TEXTURE_ANISOTROPY_ENABLED=!0;u.Log("\t\tMax Aniso: "+e.MAX_TEXTURE_ANISOTROPY,1);break;case "OES_texture_float":e.TEXTURE_FLOAT=!0;break;case "OES_texture_float_linear":e.TEXTURE_FLOAT_LINEAR=
!0;break;case "OES_depth_texture":e.TEXTURE_DEPTH_ENABLED=!0}}}u.Log("Graphics> API Limits.",1);e.MAX_ACTIVE_TEXTURE=this.c.getParameter(34930);e.MAX_COMBINED_TEXTURE=this.c.getParameter(35661);e.MAX_FRAGMENT_UNIFORM_LENGTH=this.c.getParameter(36349);e.MAX_VERTEX_UNIFORM_LENGTH=this.c.getParameter(36347);e.MAX_VERTEX_TEXTURES=this.c.getParameter(35660);e.BONE_TEXTURE=0<e.MAX_VERTEX_TEXTURES&&e.TEXTURE_FLOAT&&10<=e.get_MAX_UNIFORM_BONES();0<=window.navigator.platform.toLowerCase().indexOf("mac")&&
(e.BONE_TEXTURE=!1);a=this.c.getShaderPrecisionFormat(35633,36338);e.VS_FLOAT_HIGHP=0!=a.precision;a=this.c.getShaderPrecisionFormat(35632,36338);e.FS_FLOAT_HIGHP=0!=a.precision;a=this.c.getShaderPrecisionFormat(35633,36341);e.VS_INT_HIGHP=0!=a.precision;a=this.c.getShaderPrecisionFormat(35632,36341);e.FS_INT_HIGHP=0!=a.precision;u.Log("\tMax Active Textures: "+e.MAX_ACTIVE_TEXTURE,1);u.Log("\tMax Combined Textures: "+e.MAX_COMBINED_TEXTURE,1);u.Log("\tMax Fragment Uniform Length: "+e.MAX_FRAGMENT_UNIFORM_LENGTH,
1);u.Log("\tMax Vertex Uniform Length: "+e.MAX_VERTEX_UNIFORM_LENGTH,1);u.Log("\tMax Vertex Textures: "+e.MAX_VERTEX_TEXTURES,1);u.Log("\tMax Uniform Bones: "+e.get_MAX_UNIFORM_BONES(),1);u.Log("\tBone Texture: "+w.string(e.BONE_TEXTURE),1);u.Log("\tVertex Shader Float Highp: "+w.string(e.VS_FLOAT_HIGHP),1);u.Log("\tFragment Shader Float Highp: "+w.string(e.FS_FLOAT_HIGHP),1)}},Resize:function(){this.m_canvas.width=this.m_container.clientWidth;this.m_canvas.height=this.m_container.clientHeight},CreateBuffer:function(){return this.c.createBuffer()},
CreateVAO:function(){return this.vao.createVertexArrayOES()},BindBuffer:function(a,b){this.c.bindBuffer(a,b)},BindVAO:function(a){this.vao.bindVertexArrayOES(a)},BufferData:function(a,b,c){this.c.bufferData(a,b.m_buffer,c)},BufferSubData:function(a,b,c){this.c.bufferSubData(a,b,c.m_buffer)},DeleteBuffer:function(a){this.c.deleteBuffer(a)},DeleteVAO:function(a){this.vao.deleteVertexArrayOES(a)},DrawArrays:function(a,b,c){this.c.drawArrays(a,b,c)},DrawElements:function(a,b,c,d){this.c.drawElements(a,
b,c,d)},DisableVertexAttrib:function(a){this.c.disableVertexAttribArray(a)},EnableVertexAttrib:function(a){this.c.enableVertexAttribArray(a)},VertexAttrib1f:function(a,b){this.c.vertexAttrib1f(a,b)},VertexAttrib2f:function(a,b,c){this.c.vertexAttrib2f(a,b,c)},VertexAttrib3f:function(a,b,c,d){this.c.vertexAttrib3f(a,b,c,d)},VertexAttrib4f:function(a,b,c,d,e){this.c.vertexAttrib4f(a,b,c,d,e)},VertexAttribPointer:function(a,b,c,d,e,g){this.c.vertexAttribPointer(a,b,c,d,e,g)},CompileShader:function(a){this.c.compileShader(a)},
CreateShader:function(a){return this.c.createShader(a)},DetachShader:function(a,b){this.c.detachShader(a,b)},DeleteShader:function(a){this.c.deleteShader(a)},GetShaderInfoLog:function(a){return this.c.getShaderInfoLog(a)},GetShaderParameter:function(a,b){return this.c.getShaderParameter(a,b)},ShaderSource:function(a,b){this.c.shaderSource(a,b)},AttachShader:function(a,b){this.c.attachShader(a,b)},BindAttribLocation:function(a,b,c){this.c.bindAttribLocation(a,b,c)},CreateProgram:function(){return this.c.createProgram()},
DeleteProgram:function(a){this.c.deleteProgram(a)},GetAttribLocation:function(a,b){return this.c.getAttribLocation(a,b)},GetUniformLocation:function(a,b){return this.c.getUniformLocation(a,b)},GetProgramInfoLog:function(a){return this.c.getProgramInfoLog(a)},GetProgramParameter:function(a,b){return this.c.getProgramParameter(a,b)},LinkProgram:function(a){this.c.linkProgram(a)},UseProgram:function(a){this.c.useProgram(a)},ActiveTexture:function(a){this.c.activeTexture(a)},BindFramebuffer:function(a,
b){this.c.bindFramebuffer(a,b)},BindRenderbuffer:function(a,b){this.c.bindRenderbuffer(a,b)},BindTexture:function(a,b){this.c.bindTexture(a,b)},CreateFramebuffer:function(){return this.c.createFramebuffer()},CreateRenderbuffer:function(){return this.c.createRenderbuffer()},CreateTexture:function(){return this.c.createTexture()},DeleteFramebuffer:function(a){this.c.deleteFramebuffer(a)},DeleteRenderbuffer:function(a){this.c.deleteRenderbuffer(a)},DeleteTexture:function(a){this.c.deleteTexture(a)},
FramebufferRenderbuffer:function(a,b,c,d){this.c.framebufferRenderbuffer(a,b,c,d)},FramebufferTexture2D:function(a,b,c,d,e){this.c.framebufferTexture2D(a,b,c,d,e)},GenerateMipmap:function(a){this.c.generateMipmap(a)},PixelStorei:function(a,b){this.c.pixelStorei(a,b)},RenderbufferStorage:function(a,b,c,d){this.c.renderbufferStorage(a,b,c,d)},TexImage2D:function(a,b,c,d,e,g,h,k,l){this.c.texImage2D(a,b,c,d,e,g,h,k,l.aux)},TexImage2DAlloc:function(a,b,c,d,e,g,h,k){this.c.texImage2D(a,b,c,d,e,g,h,k,null)},
TexSubImage2D:function(a,b,c,d,e,g,h,k,l){this.c.texSubImage2D(a,b,c,d,e,g,h,k,l.aux)},TexParameterf:function(a,b,c){this.c.texParameterf(a,b,c)},TexParameteri:function(a,b,c){this.c.texParameteri(a,b,c)},BlendFunc:function(a,b){this.c.blendFunc(a,b)},Disable:function(a){this.c.disable(a)},Enable:function(a){this.c.enable(a)},DepthMask:function(a){this.c.depthMask(a)},DepthFunc:function(a){this.c.depthFunc(a)},CullFace:function(a){this.c.cullFace(a)},FrontFace:function(a){this.c.frontFace(a)},Uniform1f:function(a,
b){this.c.uniform1f(a,b)},Uniform2f:function(a,b,c){this.c.uniform2f(a,b,c)},Uniform3f:function(a,b,c,d){this.c.uniform3f(a,b,c,d)},Uniform4f:function(a,b,c,d,e){this.c.uniform4f(a,b,c,d,e)},Uniform1i:function(a,b){this.c.uniform1i(a,b)},Uniform2i:function(a,b,c){this.c.uniform2i(a,b,c)},Uniform3i:function(a,b,c,d){this.c.uniform3i(a,b,c,d)},Uniform4i:function(a,b,c,d,e){this.c.uniform4i(a,b,c,d,e)},Uniform1fv:function(a,b){this.c.uniform1fv(a,b.aux)},Uniform2fv:function(a,b){this.c.uniform2fv(a,
b.aux)},Uniform3fv:function(a,b){this.c.uniform3fv(a,b.aux)},Uniform4fv:function(a,b){this.c.uniform4fv(a,b.aux)},Uniform1iv:function(a,b){this.c.uniform1iv(a,b.aux)},Uniform2iv:function(a,b){this.c.uniform2iv(a,b.aux)},Uniform3iv:function(a,b){this.c.uniform3iv(a,b.aux)},Uniform4iv:function(a,b){this.c.uniform4iv(a,b.aux)},UniformMatrix2fv:function(a,b,c){this.c.uniformMatrix2fv(a,b,c.aux)},UniformMatrix3fv:function(a,b,c){this.c.uniformMatrix3fv(a,b,c.aux)},UniformMatrix4fv:function(a,b,c){this.c.uniformMatrix4fv(a,
b,c.aux)},Clear:function(a){this.c.clear(a)},ClearDepth:function(a){this.c.clearDepth(a)},ClearColor:function(a,b,c,d){this.c.clearColor(a,b,c,d)},Viewport:function(a,b,c,d){this.c.viewport(a,b,c,d)},Scissor:function(a,b,c,d){this.c.scissor(a,b,c,d)},ReadPixels:function(a,b,c,d,e,g,h){this.c.readPixels(a,b,c,d,e,g,h.m_buffer)},Flush:function(){},GetErrorCode:function(){return this.c.getError()},__class__:Gc});var Oc=function(a){this.m_navigator=window.navigator;this.m_target=window.document.getElementById(a);
null==this.m_target&&(u.LogWarning("Input> Target Element not found! Using [document] as target."),this.m_target=window.document.body);this.m_events=[];this.m_target.onmousedown=ha(this,this.OnInputEvent);this.m_target.onmouseover=ha(this,this.OnInputEvent);this.m_target.onmousewheel=ha(this,this.OnInputEvent);this.m_target.oncontextmenu=ha(this,this.OnInputEvent);window.document.onmousemove=ha(this,this.OnInputEvent);window.document.onmouseup=ha(this,this.OnInputEvent);window.document.onkeydown=
ha(this,this.OnInputEvent);window.document.onkeyup=ha(this,this.OnInputEvent);try{this.m_target.addEventListener("DOMMouseScroll",ha(this,this.OnInputEvent))}catch(b){}try{p.m_multitouch=null!=TouchEvent}catch(c){p.m_multitouch=!1}p.get_multitouch()&&(window.document.addEventListener("touchmove",function(a){a.preventDefault()},!1),this.m_target.ontouchstart=ha(this,this.OnTouchEvent),window.ontouchmove=ha(this,this.OnTouchEvent),window.ontouchcancel=ha(this,this.OnTouchEvent),window.ontouchend=ha(this,
this.OnTouchEvent));a=this.m_navigator;this.m_check_joystick=!!a.getGamepads||-1!=a.userAgent.indexOf("Firefox/")};k["haxor.platform.html.input.HTMLInputHandler"]=Oc;Oc.__name__=["haxor","platform","html","input","HTMLInputHandler"];Oc.__super__=Kc;Oc.prototype=s(Kc.prototype,{UpdateInput:function(){if(0<this.m_events.length)for(;0<this.m_events.length;)this.ProcessInputEvent(this.m_events.shift());this.UpdateJoystick()},OnInputEvent:function(a){a=null==a?window.event:a;this.m_events.push(a);var b=
"mousewheel"==a.type||"wheel"==a.type,b=(b="mousedown"==a.type||b)&&J.__instanceof(this.m_target,HTMLCanvasElement);p.scroll&&(b=!1);"contextmenu"==a.type&&(p.menu||(b=!0));b&&0<=p.relativeMouse.x&&1>=p.relativeMouse.x&&0<=p.relativeMouse.y&&1>=p.relativeMouse.y&&null!=ha(a,a.preventDefault)&&a.preventDefault()},ProcessInputEvent:function(a){switch(a.type){case "wheel":case "mousewheel":case "DOMMouseScroll":this.OnMouseWheel((null==a.wheelDeltaY?40*a.detail:a.wheelDeltaY)/100);break;case "mousemove":var b=
a.pageX,c=a.pageY;null==b&&(b=a.clientX);null==c&&(c=a.clientY);a=this.GetAbsolutePosition(this.m_target,b,c);this.OnMouseMove(a.x,a.y);break;case "mouseup":this.OnMouseButton(a.button,!1);break;case "mousedown":this.OnMouseButton(a.button,!0);break;case "keyup":this.OnKey(a.keyCode,!1);break;case "keydown":this.OnKey(a.keyCode,!0)}},OnTouchEvent:function(a){for(var b=0,c=a.changedTouches.length;b<c;){var d=b++,d=a.changedTouches.item(d),e=this.GetAbsolutePosition(this.m_target,d.pageX,d.pageY);switch(a.type){case "touchstart":this.OnTouchStart(d.identifier,
e.x,e.y,d.radiusX,d.radiusY,d.force,d.rotationAngle);break;case "touchmove":this.OnTouchMove(d.identifier,e.x,e.y);break;case "touchcancel":this.OnTouchCancel(d.identifier);break;case "touchend":this.OnTouchEnd(d.identifier)}}0<p.m_touches.length&&(p.scroll||a.preventDefault())},UpdateJoystick:function(){if(this.m_check_joystick){var a=this.m_navigator,b=null;null!=a.getGamepads&&(b=a.getGamepads());if(null!=b&&!(0>=b.length))for(var a=0,c=b.length;a<c;){var d=a++,d=b.item(d);if(null!=d){this.OnJoystickStart(d.index,
d.id);for(var e=0,g=d.buttons.length;e<g;){var h=e++;this.OnJoystickDataUpdate(h,d.buttons[h].value,!1)}e=0;for(g=d.axes.length;e<g;)h=e++,this.OnJoystickDataUpdate(h,d.axes[h],!0);this.OnJoystickAnalogUpdate()}}}},GetAbsolutePosition:function(a,b,c){var d=0,e=0;do d+=a.offsetLeft,e+=a.offsetTop,a=a.offsetParent;while(null!=a);d=b-d;e=c-e;return g.data.get_v2().Set(d,e)},__class__:Oc});var Hb=function(a,b,c,d){aa.call(this);this.enabled=!0;this.m_plane=new Ka;this.m_plane.set_vertex([new n(-1,1,1),
new n(-1,-1,1),new n(1,-1,1),new n(-1,1,1),new n(1,-1,1),new n(1,1,1)]);this.m_output=new Db(a,b,null==d?y.RGBA8:d);this.m_output.set_minFilter(this.m_output.set_magFilter(V.Nearest));this.m_output.set_name("Kernel"+this.get_uid()+"Output");c=a*b;switch(d[1]){case 0:this.m_result=new qa(c);break;case 2:this.m_result=new qa(3*c);break;case 3:this.m_result=new qa(4*c);break;case 7:this.m_result=new L(c);break;case 8:this.m_result=new L(3*c);break;case 9:this.m_result=new L(4*c)}this.SetFloat("width",
a);this.SetFloat("height",b);g.kernel.OnCreate(this)};k["haxor.thread.Kernel"]=Hb;Hb.__name__=["haxor","thread","Kernel"];Hb.__super__=aa;Hb.prototype=s(aa.prototype,{get_result:function(){return this.m_result},get_output:function(){return this.m_output},Resize:function(a,b){null==b&&(b=-1);null==a&&(a=-1);var c=this.m_output.m_width,d=this.m_output.m_height,c=-1+(0>a?c:a)/c*2,d=-1+(0>b?d:b)/d*2;this.m_plane.set_vertex([new n(-1,d,1),new n(-1,-1,1),new n(c,-1,1),new n(-1,d,1),new n(c,-1,1),new n(c,
d,1)])},Execute:function(){this.enabled&&null!=this.m_shader&&(g.texture.BindTarget(this.m_output),la.Viewport(g.data.get_aabb2().SetXYWH(0,0,this.m_output.m_width,this.m_output.m_height)),la.Render(this.m_plane,this,null,null),g.texture.BindTarget(null))},Update:function(a,b,c,d){null==d&&(d=-1);null==c&&(c=-1);null==b&&(b=0);null==a&&(a=0);this.enabled&&null!=this.m_shader&&null!=this.m_result&&(c=0>=c?this.m_output.m_width:c,d=0>=d?this.m_output.m_height:d,g.texture.BindTarget(this.m_output),la.ReadPixels(a,
b,c,d,this.m_result.m_buffer),g.texture.BindTarget(null))},OnDestroy:function(){aa.prototype.OnDestroy.call(this);v.Destroy(this.m_output);v.Destroy(this.m_plane);g.kernel.OnDestroy(this)},__class__:Hb,__properties__:s(aa.prototype.__properties__,{get_output:"get_output",get_result:"get_result"})});var Na=function(a){Hb.call(this,Na.DATA_SIZE,Na.DATA_SIZE,!1,y.Float4);this.set_name("ParticleKernel"+a.get_uid());null==Na.particle_kernel_shader&&(Na.particle_kernel_shader=new C(Na.particle_kernel_source));
this.m_back=new Db(Na.DATA_SIZE,Na.DATA_SIZE,y.Float4);this.m_back.set_minFilter(V.Nearest);this.m_back.set_magFilter(V.Nearest);this.m_back.set_name("ParticleKernelData0");this.m_output.set_name("ParticleKernelData1");this.m_renderer=a;this.m_time=q.m_elapsed;this.m_dt=0;this.m_resize=!1;this.set_shader(Na.particle_kernel_shader);this.m_system=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.SetTexture("Data",this.m_back);this.SetFloat4Array("System",this.m_system)};k["haxor.thread.ParticleKernel"]=Na;Na.__name__=["haxor","thread","ParticleKernel"];Na.__super__=Hb;Na.prototype=s(Hb.prototype,{Execute:function(){this.m_resize&&(this.m_resize=!1);var a=this.m_system,b=this.m_renderer,c,d=0;a[d++]=b.emitter.m_data[0];a[d++]=b.emitter.m_data[3];a[d++]=b.emitter.m_data[4];a[d++]=b.emitter.m_data[5];a[d++]=b.emitter.m_data[1];a[d++]=b.emitter.m_data[2];
b.local?a[d++]=1:a[d++]=0;b.loop?a[d++]=1:a[d++]=0;b.m_state==za.None?a[d++]=0:b.m_state==za.Reset?a[d++]=1:b.m_state==za.Update?a[d++]=2:a[d++]=0;a[d++]=l.Clamp01(0>=b.duration?0:b.elapsed/b.duration);a[d++]=0;a[d++]=q.m_delta;c=b.start.speed;a[d++]=c.start;a[d++]=c.end;a[d++]=c.curve;c.random?a[d++]=1:a[d++]=0;c=b.start.size;a[d++]=c.start.x;a[d++]=c.start.y;a[d++]=c.start.z;a[d++]=c.curve;a[d++]=c.end.x;a[d++]=c.end.y;a[d++]=c.end.z;c.random?a[d++]=1:a[d++]=0;c=b.start.life;a[d++]=c.start;a[d++]=
c.end;a[d++]=c.curve;c.random?a[d++]=1:a[d++]=0;c=b.start.rotation;a[d++]=c.start.x;a[d++]=c.start.y;a[d++]=c.start.z;a[d++]=c.curve;a[d++]=c.end.x;a[d++]=c.end.y;a[d++]=c.end.z;c.random?a[d++]=1:a[d++]=0;c=b.life.speed;a[d++]=c.start;a[d++]=c.end;a[d++]=c.curve;c.random?a[d++]=1:a[d++]=0;c=b.life.motion;a[d++]=c.start.x;a[d++]=c.start.y;a[d++]=c.start.z;a[d++]=c.curve;a[d++]=c.end.x;a[d++]=c.end.y;a[d++]=c.end.z;c.random?a[d++]=1:a[d++]=0;c=b.life.size;a[d++]=c.start.x;a[d++]=c.start.y;a[d++]=c.start.z;
a[d++]=c.curve;a[d++]=c.end.x;a[d++]=c.end.y;a[d++]=c.end.z;c.random?a[d++]=1:a[d++]=0;c=b.life.rotation;a[d++]=c.start.x;a[d++]=c.start.y;a[d++]=c.start.z;a[d++]=c.curve;a[d++]=c.end.x;a[d++]=c.end.y;a[d++]=c.end.z;c.random?a[d++]=1:a[d++]=0;a[d++]=b.force.x;a[d++]=b.force.y;a[d++]=b.force.z;a[d++]=0;c=this.m_renderer.m_entity.m_transform.get_WorldMatrix();a[d++]=c.m00;a[d++]=c.m01;a[d++]=c.m02;a[d++]=c.m03;a[d++]=c.m10;a[d++]=c.m11;a[d++]=c.m12;a[d++]=c.m13;a[d++]=c.m20;a[d++]=c.m21;a[d++]=c.m22;
a[d++]=c.m23;c=b.sheet.frame;a[d++]=c.start;a[d++]=c.end;a[d++]=c.curve;c.random?a[d++]=1:a[d++]=0;a[d++]=b.sheet.width;a[d++]=b.sheet.height;b.sheet.reverse?a[d++]=-this.m_renderer.sheet.fps:a[d++]=this.m_renderer.sheet.fps;b.sheet.wrap==ra.Clamp?a[d++]=0:this.m_renderer.sheet.wrap==ra.Loop?a[d++]=1:a[d++]=2;a[d++]=b.sheet.length;a[d++]=b.emitter.ranges[0];a[d++]=b.emitter.ranges[1];a[d++]=0;a[d++]=b.emitter.ranges[2];a[d++]=b.emitter.ranges[3];a[d++]=b.emitter.ranges[4];a[d++]=b.emitter.ranges[5];
a[d++]=b.m_emitted_start;a[d++]=b.m_emitted_count;a[d++]=0;a[d++]=0;this.SetFloat4Array("System",this.m_system);this.SetTexture("StartColor",null==b.start.color?z.get_white():b.start.color);this.SetTexture("Color",null==b.life.color?z.get_white():b.life.color);null!=b.m_material&&(b.m_material.SetFloat4Array("System",this.m_system),b.m_material.SetTexture("Data",this.m_back),b.m_material.SetFloat("DataWidth",this.m_back.m_width),b.m_material.SetFloat("DataHeight",this.m_back.m_height),a=b.m_material.HasUniform("Texture")?
b.m_material.GetUniform("Texture").texture:null,null!=a&&(b.m_material.SetFloat("TextureWidth",a.m_width),b.m_material.SetFloat("TextureHeight",a.m_height)));Hb.prototype.Execute.call(this);b=this.m_back;this.m_back=this.m_output;this.m_output=b;this.SetTexture("Data",this.m_back)},__class__:Na});var J=function(){};k["js.Boot"]=J;J.__name__=["js","Boot"];J.getClass=function(a){return a instanceof Array&&null==a.__enum__?Array:a.__class__};J.__string_rec=function(a,b){if(null==a)return"null";if(5<=
b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];c=a[0]+"(";b+="\t";for(var d=2,e=a.length;d<e;)var g=d++,c=2!=g?c+(","+J.__string_rec(a[g],b)):c+J.__string_rec(a[g],b);return c+")"}c=a.length;d="[";b+="\t";for(e=0;e<c;)g=e++,d+=(0<g?",":"")+J.__string_rec(a[g],b);return d+"]"}try{d=a.toString}catch(h){return"???"}if(null!=d&&d!=Object.toString&&(c=a.toString(),"[object Object]"!=
c))return c;c=null;d="{\n";b+="\t";e=null!=a.hasOwnProperty;for(c in a)e&&!a.hasOwnProperty(c)||"prototype"==c||"__class__"==c||"__super__"==c||"__interfaces__"==c||"__properties__"==c||(2!=d.length&&(d+=", \n"),d+=b+c+" : "+J.__string_rec(a[c],b));b=b.substring(1);return d+("\n"+b+"}");case "function":return"<function>";case "string":return a;default:return String(a)}};J.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;d<e;){var g=
d++,g=c[g];if(g==b||J.__interfLoop(g,b))return!0}return J.__interfLoop(a.__super__,b)};J.__instanceof=function(a,b){if(null==b)return!1;switch(b){case Md:return(a|0)===a;case Od:return"number"==typeof a;case Pd:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case Rd:return!0;default:if(null!=a){if("function"==typeof b&&(a instanceof b||J.__interfLoop(J.getClass(a),b)))return!0}else return!1;return b==Sd&&null!=a.__name__||b==Td&&
null!=a.__ename__?!0:a.__enum__==b}};J.__cast=function(a,b){if(J.__instanceof(a,b))return a;throw"Cannot cast "+w.string(a)+" to "+w.string(b);};var Ld=function(){};k["js.html._CanvasElement.CanvasUtil"]=Ld;Ld.__name__=["js","html","_CanvasElement","CanvasUtil"];Ld.getContextWebGL=function(a,b){for(var c=0,d=["webgl","experimental-webgl"];c<d.length;){var e=d[c];++c;e=a.getContext(e,b);if(null!=e)return e}return null};var Mc,Qd=0;Math.NaN=Number.NaN;Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;
Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;k.Math=Math;Math.isFinite=function(a){return isFinite(a)};Math.isNaN=function(a){return isNaN(a)};String.prototype.__class__=k.String=String;String.__name__=["String"];k.Array=Array;Array.__name__=["Array"];Date.prototype.__class__=k.Date=Date;Date.__name__=["Date"];var Md=k.Int={__name__:["Int"]},Rd=k.Dynamic={__name__:["Dynamic"]},Od=k.Float=Number;Od.__name__=["Float"];var Pd=Boolean;Pd.__ename__=["Bool"];var Sd=k.Class={__name__:["Class"]},Td={};
G.Element="element";G.PCData="pcdata";G.CData="cdata";G.Comment="comment";G.DocType="doctype";G.ProcessingInstruction="processingInstruction";G.Document="document";fa.Default=1;fa.Player=2;fa.CameraArea=4;fa.Hole=8;fa.Door=16;Sa.TOP_SPEED=150;kb.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";kb.BYTES=bb.ofString(kb.CHARS);lb.count=0;qb.escapes=function(a){a=new fb;a.set("lt","<");a.set("gt",">");a.set("amp","&");a.set("quot",'"');a.set("apos","'");a.set("nbsp",String.fromCharCode(160));
return a}(this);U.SAPCulling=!0;Ab.m_temp=new Ab;Bb.m_temp=new Bb;Cb.m_temp=new Cb;P.ambient=new t(0,0,0,1);P.max=8;P.m_buffer=[-1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0,-1,0,0,0,0,0,0,0,0,0,0,0];P.m_list=[];$b.MAX_TEMP=128;g.uid=0;g.maxNodes=5E3;g.collectRate=10;O.POINT=0;O.LINE=1;O.AXIS=2;O.WIRE_CUBE=3;O.WIRE_SPHERE=4;O.CANVAS=10;O.DATA_OFFSET=24;O.MAX_GIZMOS=500;
O.IDM=new x(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);tb.m_cid=0;ea.flat_source='\r\n\t<shader id="haxor/unlit/Flat">\t\r\n\t\t<vertex>\t\t\r\n\t\tuniform mat4  WorldMatrix;\r\n\t\tuniform mat4  ViewMatrix;\r\n\t\tuniform mat4  ProjectionMatrix;\t\t\r\n\t\tuniform vec4  Tint;\t\t\t\t\r\n\t\tattribute vec3 vertex;\t\t\r\n\t\tattribute vec4 color;\t\t\r\n\t\tvarying vec4 v_color;\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\t\r\n\t\t\tgl_Position = ((vec4(vertex, 1.0) * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\t\t\t\t\r\n\t\t\tv_color = color * Tint;\r\n\t\t}\t\t\r\n\t\t</vertex>\t\t\r\n\t\t<fragment>\t\t\t\r\n\t\t\tvarying vec4 v_color;\t\t\t\r\n\t\t\tvoid main(void) { gl_FragColor = v_color; }\t\t\t\r\n\t\t</fragment>\t\r\n\t</shader>\t\r\n\t';
ea.flat_texture_source='\r\n\t<shader id="haxor/unlit/FlatTexture">\t\r\n\t\t<vertex>\r\n\t\tuniform mat4  WorldMatrix;\r\n\t\tuniform mat4  ViewMatrix;\r\n\t\tuniform mat4  ProjectionMatrix;\t\t\r\n\t\tattribute vec3 vertex;\t\t\t\t\t\r\n\t\tattribute vec4 color;\r\n\t\tattribute vec3 uv0;\t\t\r\n\t\tvarying vec3 v_uv0;\r\n\t\tvarying vec4 v_color;\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\t\r\n\t\t\tgl_Position = ((vec4(vertex, 1.0) * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\r\n\t\t\tv_uv0   = uv0;\r\n\t\t\tv_color = color;\r\n\t\t}\t\t\r\n\t\t</vertex>\t\t\r\n\t\t<fragment>\r\n\t\t\tvarying vec3 v_uv0;\r\n\t\t\tvarying vec4 v_color;\t\t\t\r\n\t\t\tuniform sampler2D DiffuseTexture;\r\n\t\t\tvoid main(void) \r\n\t\t\t{\t\r\n\t\t\t\tvec4 tex_diffuse = texture2D(DiffuseTexture, v_uv0.xy);\t\r\n\t\t\t\tgl_FragColor.xyz = (tex_diffuse.xyz * v_color.xyz);\r\n\t\t\t\tgl_FragColor.a \t = tex_diffuse.a * v_color.a;\r\n\t\t\t}\r\n\t\t</fragment>\t\r\n\t</shader>\r\n\t';
ea.flat_texture_skin_source='\r\n\t<shader id="haxor/unlit/FlatTextureSkin">\t\r\n\t\t<vertex precision="low">\r\n\t\t\r\n\t\tuniform mat4  WorldMatrix;\r\n\t\tuniform mat4  WorldMatrixIT;\r\n\t\tuniform mat4  ViewMatrix;\r\n\t\tuniform mat4  ProjectionMatrix;\r\n\t\tuniform vec3  WSCameraPosition;\t\t\r\n\t\t\r\n\t\t#ifdef BONE_TEXTURE\r\n\t\tuniform sampler2D Joints;\r\n\t\tuniform sampler2D Binds;\r\n\t\tuniform int\t\t  SkinId;\r\n\t\tuniform vec4      SkinTexSize;\r\n\t\t#else\t\t\r\n\t\tuniform vec4  Joints[MAX_BONES*3];\t\t\r\n\t\tuniform vec4   Binds[MAX_BONES*3];\r\n\t\t#endif\r\n\t\t\r\n\t\tuniform int SkinQuality;\r\n\t\t\r\n\t\tattribute vec3 vertex;\t\t\t\t\t\r\n\t\tattribute vec4 color;\r\n\t\tattribute vec3 normal;\r\n\t\tattribute vec3 uv0;\r\n\t\tattribute vec4 bone;\r\n\t\tattribute vec4 weight;\r\n\t\t\r\n\t\tvarying vec3 v_uv0;\r\n\t\tvarying vec3 v_normal;\r\n\t\tvarying vec4 v_color;\r\n\t\tvarying vec4 v_wsVertex;\r\n\t\tvarying vec3 v_wsView;\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tmat4 GetJointMatrix(const int b0, const int b1, const int b2) \r\n\t\t{ \r\n\t\t\t#ifdef BONE_TEXTURE\t\t\t\r\n\t\t\tfloat itw = SkinTexSize.z;\r\n\t\t\tfloat ith = SkinTexSize.w;\r\n\t\t\tfloat fb0x = mod(float(b0), SkinTexSize.x);\r\n\t\t\tfloat fb1x = mod(float(b1), SkinTexSize.x);\r\n\t\t\tfloat fb2x = mod(float(b2), SkinTexSize.x);\r\n\t\t\tfloat fb0y = floor(float(b0) * itw);\r\n\t\t\tfloat fb1y = floor(float(b1) * itw);\r\n\t\t\tfloat fb2y = floor(float(b2) * itw);\t\t\t\r\n\t\t\tvec4 l0 = texture2D(Joints, vec2(fb0x*itw,fb0y*ith));\r\n\t\t\tvec4 l1 = texture2D(Joints, vec2(fb1x*itw,fb1y*ith));\r\n\t\t\tvec4 l2 = texture2D(Joints, vec2(fb2x*itw,fb2y*ith));\r\n\t\t\treturn mat4(l0,l1,l2,vec4(0,0,0,1));\r\n\t\t\t#else\r\n\t\t\treturn mat4(Joints[b0], Joints[b1], Joints[b2], vec4(0, 0, 0, 1)); \r\n\t\t\t#endif\r\n\t\t}\r\n\t\t\r\n\t\tmat4 GetBindMatrix (const int b0, const int b1, const int b2) \r\n\t\t{ \r\n\t\t\t#ifdef BONE_TEXTURE\t\t\t\r\n\t\t\tfloat itw = SkinTexSize.z;\r\n\t\t\tfloat ith = SkinTexSize.w;\t\t\t\t\t\r\n\t\t\tfloat fb0x = mod(float(b0), SkinTexSize.x);\r\n\t\t\tfloat fb1x = mod(float(b1), SkinTexSize.x);\r\n\t\t\tfloat fb2x = mod(float(b2), SkinTexSize.x);\r\n\t\t\tfloat fb0y = floor(float(b0) * itw);\r\n\t\t\tfloat fb1y = floor(float(b1) * itw);\r\n\t\t\tfloat fb2y = floor(float(b2) * itw);\t\t\t\r\n\t\t\tvec4 l0 = texture2D(Binds, vec2(fb0x*itw,fb0y*ith));\r\n\t\t\tvec4 l1 = texture2D(Binds, vec2(fb1x*itw,fb1y*ith));\r\n\t\t\tvec4 l2 = texture2D(Binds, vec2(fb2x*itw,fb2y*ith));\r\n\t\t\treturn mat4(l0,l1,l2,vec4(0,0,0,1));\r\n\t\t\t#else\r\n\t\t\treturn mat4(Binds[b0] , Binds[b1] , Binds[b2] , vec4(0, 0, 0, 1)); \r\n\t\t\t#endif\r\n\t\t}\r\n\t\t\r\n\t\tmat4 SkinWorldMatrix()\r\n\t\t{\r\n\t\t\tvec4 b = bone * 3.0;\t\t\t\r\n\t\t\tvec4 w = weight;\t\t\t\r\n\t\t\tfloat ivs = 0.0;\r\n\t\t\tif (SkinQuality >= 0) ivs += weight.x;\r\n\t\t\tif (SkinQuality >= 2) ivs += weight.y;\r\n\t\t\tif (SkinQuality >= 3) ivs += weight.z;\r\n\t\t\tif (SkinQuality >= 4) ivs += weight.w;\t\t\t\r\n\t\t\tw *= 1.0 / ivs;\t\t\t\r\n\t\t\tivec4 bi0 = ivec4(b.x, b.y, b.z, b.w);\t\t\t\r\n\t\t\tivec4 bi1 = ivec4(b.x + 1.0, b.y + 1.0, b.z + 1.0, b.w + 1.0);\t\t\t\r\n\t\t\tivec4 bi2 = ivec4(b.x + 2.0, b.y + 2.0, b.z + 2.0, b.w + 2.0);\t\t\t\r\n\t\t\tmat4 res = mat4(0.0),jm,bm;\t\t\t\r\n\t\t\tif (SkinQuality >= 0) { jm = GetJointMatrix(bi0.x, bi1.x, bi2.x); bm = GetBindMatrix(bi0.x, bi1.x, bi2.x); res += ((bm * jm) * w.x); }\r\n\t\t\tif (SkinQuality >= 2) { jm = GetJointMatrix(bi0.y, bi1.y, bi2.y); bm = GetBindMatrix(bi0.y, bi1.y, bi2.y); res += ((bm * jm) * w.y); }\r\n\t\t\tif (SkinQuality >= 3) { jm = GetJointMatrix(bi0.z, bi1.z, bi2.z); bm = GetBindMatrix(bi0.z, bi1.z, bi2.z); res += ((bm * jm) * w.z); }\r\n\t\t\tif (SkinQuality >= 4) { jm = GetJointMatrix(bi0.w, bi1.w, bi2.w); bm = GetBindMatrix(bi0.w, bi1.w, bi2.w); res += ((bm * jm) * w.w); }\r\n\t\t\t\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\t\t\t\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\r\n\t\t\tvec4 lv = vec4(vertex,1.0);\r\n\t\t\tvec3 ln = vec3(normal);\r\n\t\t\tmat4 swm = SkinWorldMatrix();\r\n\t\t\tmat4 wm;\t\t\t\t\t\r\n\t\t\twm = swm;\r\n\t\t\t//wm = WorldMatrix;\r\n\t\t\t\r\n\t\t\tv_uv0   = uv0;\r\n\t\t\tv_color = color;\t\t\t\r\n\t\t\tv_normal = ln * mat3(WorldMatrixIT);\t\t\t\r\n\t\t\tgl_Position = ((lv * wm) * ViewMatrix) * ProjectionMatrix;\r\n\t\t}\t\t\r\n\t\t</vertex>\r\n\t\t\r\n\t\t<fragment precision="medium">\r\n\t\t\t\t\t\r\n\t\t\tuniform sampler2D DiffuseTexture;\t\t\t\t\t\t\r\n\t\t\tvarying vec3 v_uv0;\r\n\t\t\tvarying vec4 v_color;\r\n\t\t\tvarying vec3 v_normal;\r\n\t\t\t\r\n\t\t\tvoid main(void) \r\n\t\t\t{\t\r\n\t\t\t\tvec4 tex_diffuse = texture2D(DiffuseTexture, v_uv0.xy);\r\n\t\t\t\tgl_FragColor.xyz = tex_diffuse.xyz * v_color.xyz;\r\n\t\t\t\tgl_FragColor.a \t = tex_diffuse.a * v_color.a;\r\n\t\t\t}\r\n\t\t</fragment>\t\r\n\t</shader>\r\n\t';
ea.grid_source='\r\n\t<shader id="haxor/gizmo/Grid">\t\r\n\t\t<vertex>\t\t\r\n\t\tuniform mat4  WorldMatrix;\r\n\t\tuniform mat4  ViewMatrix;\r\n\t\tuniform mat4  ProjectionMatrix;\t\t\r\n\t\tuniform vec4  Tint;\t\t\r\n\t\tuniform float Area;\r\n\t\tattribute vec3 vertex;\t\t\r\n\t\tattribute vec4 color;\t\t\r\n\t\tvarying vec4 v_color;\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\t\r\n\t\tgl_Position = ((vec4(vertex*Area, 1.0) * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\t\t\t\t\r\n\t\tv_color = color * Tint;\t\t\r\n\t\t}\t\t\r\n\t\t</vertex>\t\t\r\n\t\t<fragment>\t\t\t\r\n\t\t\tvarying vec4 v_color;\t\t\t\r\n\t\t\tvoid main(void) \r\n\t\t\t{\r\n\t\t\t\tgl_FragColor = v_color;\r\n\t\t\t}\t\t\t\r\n\t\t</fragment>\t\r\n\t</shader>\t\r\n\t';
ea.texture_source='\r\n\t<shader id="haxor/gizmo/Texture">\t\r\n\t\t<vertex>\t\t\r\n\t\tuniform vec2  Screen;\r\n\t\tuniform vec4  Rect;\r\n\t\tuniform vec4  Tint;\t\t\r\n\t\tattribute vec3 vertex;\t\t\t\t\r\n\t\tvarying vec4 v_color;\r\n\t\tvarying vec2 v_uv0;\r\n\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\t\r\n\t\t\tvec4 p = vec4(vertex, 1);\r\n\t\t\tfloat sw = Screen.x * 0.5;\r\n\t\t\tfloat sh = Screen.y * 0.5;\r\n\t\t\tp.x *= Rect.z / sw;\r\n\t\t\tp.y *= Rect.w / sh;\r\n\t\t\tp.x += Rect.x / sw;\r\n\t\t\tp.y -= Rect.y / sh;\t\t\t\r\n\t\t\tp.x -= 1.0;\r\n\t\t\tp.y += 1.0;\t\t\t\r\n\t\t\tp.z = 0.001;\r\n\t\t\tgl_Position = p;\r\n\t\t\tv_color = Tint;\t\t\r\n\t\t\tv_uv0   = vec2(vertex.x,1.0+vertex.y);\r\n\t\t}\t\t\r\n\t\t</vertex>\t\t\r\n\t\t<fragment>\t\t\t\r\n\t\t\tvarying vec4 v_color;\t\r\n\t\t\tvarying vec2 v_uv0;\r\n\t\t\tuniform sampler2D Texture;\t\t\t\r\n\t\t\tvoid main(void) \r\n\t\t\t{\r\n\t\t\t\tgl_FragColor = texture2D(Texture, v_uv0) * v_color;\r\n\t\t\t}\t\t\t\r\n\t\t</fragment>\t\r\n\t</shader>\t\r\n\t';
ea.gizmo_source='\r\n\t<shader id="haxor/gizmo/Gizmo">\t\r\n\t\t<vertex>\t\r\n\t\t\r\n\t\t#define GIZMO_POINT       0\r\n\t\t#define GIZMO_LINE        1\r\n\t\t#define GIZMO_AXIS        2\r\n\t\t#define GIZMO_WIRE_CUBE   3\r\n\t\t#define GIZMO_WIRE_SPHERE 4\r\n\t\t#define GIZMO_CANVAS\t  10\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\t\tmat4         WorldMatrix;\r\n\t\tuniform mat4  \t\t ViewMatrix;\r\n\t\tuniform mat4  \t\t ProjectionMatrix;\t\t\t\t\r\n\t\tuniform int   \t\t Count;\r\n\t\tuniform int   \t\t Type;\t\t\r\n\t\tuniform sampler2D \t Data;\r\n\t\tuniform int  \t\t DataSize;\t\t\r\n\t\t\t    vec4\t\t DataColor;\r\n\t\t\t\tvec4\t\t DataA;\r\n\t\t\t\tvec4\t\t DataB;\r\n\t\t\r\n\t\tattribute float id;\r\n\t\tattribute vec3 vertex;\t\t\r\n\t\tattribute vec4 color;\r\n\t\t\r\n\t\tvarying vec4 v_color;\r\n\t\t\r\n\t\tvec4 GetPixel(float p_pix,float p_ds,float p_ids)\r\n\t\t{\t\t\t\r\n\t\t\tfloat px = mod(p_pix, p_ds) * p_ids;\r\n\t\t\tfloat py = (p_pix * p_ids) * p_ids;\r\n\t\t\treturn texture2D(Data, vec2(px,py));\r\n\t\t}\r\n\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\t\t\t\r\n\t\t\tif (id >= float(Count)) \r\n\t\t\t{\r\n\t\t\t\tgl_Position = vec4( -2.0, 0.0, 0.0, 0.0);\r\n\t\t\t\treturn; \r\n\t\t\t}\t\t\t\r\n\t\t\tfloat p  \t= id * 6.0;\r\n\t\t\tfloat ds\t= float(DataSize);\r\n\t\t\tfloat ids\t= 1.0 / ds;\t\t\t\r\n\t\t\tDataColor \t= GetPixel(p,ds,ids);\r\n\t\t\tDataA \t\t= GetPixel(p + 1.0,ds,ids);\r\n\t\t\tDataB \t\t= GetPixel(p + 2.0,ds,ids);\t\t\t\r\n\t\t\tvec4 l0 \t= GetPixel(p + 3.0,ds,ids);\r\n\t\t\tvec4 l1 \t= GetPixel(p + 4.0,ds,ids);\r\n\t\t\tvec4 l2 \t= GetPixel(p + 5.0,ds,ids);\t\r\n\t\t\tvec4 v\t\t= vec4(vertex, 1.0);\r\n\t\t\tWorldMatrix = mat4(l0.x, l0.y, l0.z, l0.w, l1.x, l1.y, l1.z, l1.w, l2.x, l2.y, l2.z, l2.w, 0, 0, 0, 1);\r\n\t\t\t\r\n\t\t\tif (Type == GIZMO_POINT)\r\n\t\t\t{\t\r\n\t\t\t\tvec4 ncp = ((vec4(DataB.xyz, 1.0) * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\t\t\t\t\r\n\t\t\t\tv.xyz += DataB.xyz;\r\n\t\t\t\tfloat pf = (ncp.z / ncp.w);\r\n\t\t\t\tgl_PointSize = pf <= 0.0 ? DataA.x : (DataA.x * pf);\r\n\t\t\t\tgl_Position = ((v * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\tif (Type == GIZMO_LINE)\r\n\t\t\t{\r\n\t\t\t\tfloat r = v.x;\r\n\t\t\t\tv.xyz = DataA.xyz + (DataB.xyz - DataA.xyz) * r;\r\n\t\t\t\tgl_Position = ((v * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\tif (Type == GIZMO_AXIS)\r\n\t\t\t{\t\t\r\n\t\t\t\tfloat sx   = length(vec3(WorldMatrix[0][0],WorldMatrix[1][0],WorldMatrix[2][0]));\r\n\t\t\t\tfloat sy   = length(vec3(WorldMatrix[0][1],WorldMatrix[1][1],WorldMatrix[2][1]));\r\n\t\t\t\tfloat sz   = length(vec3(WorldMatrix[0][2],WorldMatrix[1][2],WorldMatrix[2][2]));\t\t\t\t\r\n\t\t\t\tvec3 scale = vec3(sx, sy, sz);\t\t\t\t\r\n\t\t\t\tvec4 ncp = ((vec4(DataB.xyz, 1.0) * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\t\t\t\t\r\n\t\t\t\tv.xyz *= (DataA.xyz / scale.xyz) * ncp.w * 0.025;\r\n\t\t\t\tv.xyz += DataB.xyz;\r\n\t\t\t\tgl_Position  = ((v * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\tif (Type == GIZMO_WIRE_CUBE)\r\n\t\t\t{\r\n\t\t\t\tv.xyz *= DataA.xyz;\r\n\t\t\t\tv.xyz += DataB.xyz;\r\n\t\t\t\tgl_Position = ((v * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\tif (Type == GIZMO_WIRE_SPHERE)\r\n\t\t\t{\r\n\t\t\t\tv.xyz *= DataA.x;\r\n\t\t\t\tv.xyz += DataB.xyz;\r\n\t\t\t\tgl_Position = ((v * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\tif (Type == GIZMO_CANVAS)\r\n\t\t\t{\t\t\t\t\r\n\t\t\t\tv.xyz += DataB.xyz;\r\n\t\t\t\tgl_Position = ((v * WorldMatrix) * ViewMatrix) * ProjectionMatrix;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\tv_color = DataColor * color;\r\n\t\t}\t\t\r\n\t\t</vertex>\t\t\r\n\t\t<fragment>\t\t\t\r\n\t\t\tvarying vec4 v_color;\t\t\t\r\n\t\t\tvoid main(void) { gl_FragColor = v_color; }\r\n\t\t</fragment>\t\r\n\t</shader>\t\r\n\t';
ea.flat_particle_source='\r\n\t<shader id="haxor/unlit/Particle">\t\r\n\r\n\t\t<vertex precision="low">\r\n\t\t\r\n\t\t#define IsLocal\t\t\t\t (System[1].z > 0.0)\r\n\t\t#define SheetFrameWidth\t \t System[21].x\r\n\t\t#define SheetFrameHeight \t System[21].y\r\n\t\t#define SheetLength\t\t \t System[22].x\r\n\t\t#define SystemEmissionStart\t System[24].x\r\n\t\t#define SystemEmissionCount\t System[24].y\r\n\t\t\r\n\t\t#define PARTICLE_LENGTH\t\t 8.0\r\n\t\t\r\n\t\t#define PARTICLE_STATUS\t\t 0.0\r\n\t\t#define PARTICLE_POSITION\t 1.0\r\n\t\t#define PARTICLE_ROTATION\t 2.0\r\n\t\t#define PARTICLE_SIZE\t\t 3.0\r\n\t\t#define PARTICLE_VELOCITY\t 4.0\r\n\t\t#define PARTICLE_COLOR\t\t 5.0\r\n\t\t#define PARTICLE_START\t\t 6.0\r\n\t\t#define PARTICLE_NULL\t\t 7.0\r\n\t\t\r\n\t\t#define PARTICLE_DISABLED\t 0\r\n\t\t#define PARTICLE_INIT\t\t 1\r\n\t\t#define PARTICLE_ENABLED\t 2\r\n\t\t#define PARTICLE_DEAD\t\t 3\r\n\t\t\r\n\t\tattribute vec3 vertex;\r\n\t\t\t\t\r\n\t\t\r\n\t\tuniform mat4  WorldMatrix;\r\n\t\tuniform mat4  ViewMatrix;\r\n\t\tuniform mat4  ViewMatrixInverse;\r\n\t\tuniform mat4  ProjectionMatrix;\t\t\r\n\t\t\r\n\t\tuniform float Time;\r\n\t\t\r\n\t\tuniform sampler2D Data;\r\n\t\t\r\n\t\tuniform float DataWidth;\r\n\t\tuniform float DataHeight;\r\n\t\t\r\n\t\t\r\n\t\tuniform float TextureWidth;\r\n\t\tuniform float TextureHeight;\r\n\t\t\r\n\t\tuniform vec4  System[25];\r\n\t\t\t\t\r\n\t\t\r\n\t\tvarying vec2 v_uv0;\r\n\t\tvarying vec4 v_color;\r\n\t\t\r\n\t\t\r\n\t\tuniform float RandomSeed;\t\t\r\n\t\tuniform sampler2D RandomTexture;\r\n\t\t\r\n\t\tvec4 Random()\r\n\t\t\t{\r\n\t\t\t\tfloat tw   = 0.001953125;\r\n\t\t\t\tfloat seed = RandomSeed * 262144.0;\r\n\t\t\t\tfloat idx  = mod(seed,512.0) * tw;\r\n\t\t\t\tfloat idy  = floor(seed * tw)  * tw;\r\n\t\t\t\tseed      += tw;\r\n\t\t\t\treturn texture2D(RandomTexture, vec2(idx,idy));\r\n\t\t\t}\r\n\t\t//*/\r\n\t\tvec4 ParticleData(float p_id,float p_field)\r\n\t\t{\r\n\t\t\tfloat w   = floor(DataWidth);\r\n\t\t\tfloat h   = floor(DataHeight);\r\n\t\t\tfloat pid = mod(floor(SystemEmissionStart)+p_id,floor(w*h)/PARTICLE_LENGTH);\r\n\t\t\tfloat pix = floor(pid) * PARTICLE_LENGTH;\t\t\t\r\n\t\t\tfloat px  = mod(pix+p_field,w) / (w-1.0);\r\n\t\t\tfloat py  = floor((pix+p_field)/w) / (h-1.0);\r\n\t\t\treturn texture2D(Data,vec2(px,py));\r\n\t\t}\r\n\t\t\r\n\t\tvec4 ParticleStatus()   { return ParticleData(vertex.z,PARTICLE_STATUS); \t}\r\n\t\tvec4 ParticlePosition() { return ParticleData(vertex.z,PARTICLE_POSITION); \t}\r\n\t\tvec4 ParticleRotation() { return ParticleData(vertex.z,PARTICLE_ROTATION); \t}\r\n\t\tvec4 ParticleSize() \t{ return ParticleData(vertex.z,PARTICLE_SIZE); \t\t}\r\n\t\tvec4 ParticleColor() \t{ return ParticleData(vertex.z,PARTICLE_COLOR); \t\t}\r\n\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\t\r\n\t\t\t\r\n\t\t\tvec4  status   = ParticleStatus();\r\n\t\t\t\r\n\t\t\tfloat enabled  = int(status.x) == PARTICLE_DEAD ? 0.0 : 1.0;\r\n\t\t\t\r\n\t\t\tvec4  v   = vec4(vertex.xy,0.0,1.0);\r\n\t\t\tv.xyz\t *= enabled;\r\n\t\t\t\r\n\t\t\tif(enabled <= 0.0) { gl_Position = vec4(0,0,0,-1.0); return; }\r\n\t\t\t\r\n\t\t\tvec3 size\t   = ParticleSize().xyz;\t\t\t\r\n\t\t\tvec3 center    = vec3(0,0,0);\r\n\t\t\tvec3 position  = ParticlePosition().xyz;\r\n\t\t\t\t\t\t\r\n\t\t\tv.xyz  *= size;\r\n\t\t\tv.xyz   = v.xyz * mat3(ViewMatrixInverse); //billboard\r\n\t\t\t\r\n\t\t\tv.xyz  += center + position;\r\n\t\t\t\r\n\t\t\tmat4 wm     = IsLocal ? WorldMatrix : mat4(1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1); \r\n\t\t\t\r\n\t\t\tgl_Position = ((v * wm) * ViewMatrix) * ProjectionMatrix;\r\n\t\t\t\r\n\t\t\tfloat frame   = floor(status.w);\t\t\r\n\t\t\t\r\n\t\t\tv_uv0 = (vertex.xy+0.5);\r\n\t\t\t\r\n\t\t\tif(SheetLength > 0.0)\r\n\t\t\t{\t\t\t\r\n\t\t\t\tfloat sw\t  = (SheetFrameWidth);\r\n\t\t\t\tfloat sh\t  = (SheetFrameHeight);\t\t\t\r\n\t\t\t\tfloat tw\t  = floor(TextureWidth);\r\n\t\t\t\tfloat th\t  = floor(TextureHeight);\r\n\t\t\t\tfloat sheet_uvw = sw/tw;\r\n\t\t\t\tfloat sheet_uvh = sh/th;\r\n\t\t\t\tv_uv0   \t*= vec2(sheet_uvw,sheet_uvh);\t\t\t\t\t\r\n\t\t\t\tfloat cx     = floor(TextureWidth/SheetFrameWidth);\r\n\t\t\t\tv_uv0.x\t\t += (mod(frame,cx) * (sheet_uvw));\r\n\t\t\t\tv_uv0.y\t\t += 1.0 - (sheet_uvh) - (floor(frame/cx) * (sheet_uvh));\r\n\t\t\t}\t\t\t\r\n\t\t\t\r\n\t\t\tv_color = ParticleColor();\r\n\t\t}\t\t\r\n\t\t</vertex>\r\n\t\t\r\n\t\t<fragment precision="low">\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tvarying vec2 v_uv0;\r\n\t\t\tvarying vec4 v_color;\r\n\t\t\t\r\n\t\t\tuniform sampler2D Color;\r\n\t\t\t\r\n\t\t\tuniform sampler2D Texture;\r\n\t\t\t\r\n\t\t\tvoid main(void) \r\n\t\t\t{\t\r\n\t\t\t\tvec4 tex\t\t = texture2D(Texture, v_uv0.xy);\r\n\t\t\t\tgl_FragColor.xyz = tex.xyz * v_color.xyz;\r\n\t\t\t\tgl_FragColor.a \t = tex.a * v_color.a;\r\n\t\t\t}\r\n\t\t</fragment>\t\r\n\t</shader>\t\r\n\t';
ea.clear_skybox_source='\r\n\t<shader id="haxor/clear/Skybox">\r\n\t\t<vertex precision="low">\t\t\r\n\t\t\tuniform mat4 ViewMatrixInverse;\r\n\t\t\tuniform mat4 SkyboxProjectionMatrixInverse;\r\n\t\t\tuniform vec3 CameraPosition;\t\t\t\r\n\t\t\tvarying vec3 v_view_dir;\r\n\t\t\tattribute vec3 vertex;\t\t\t\r\n\t\t\tvoid main()\r\n\t\t\t{\r\n\t\t\t\tvec4 wpos = vec4(vertex,1.0) * SkyboxProjectionMatrixInverse;\r\n\t\t\t\twpos /= wpos.w;\r\n\t\t\t\twpos = wpos * ViewMatrixInverse;\r\n\t\t\t\tv_view_dir = wpos.xyz - CameraPosition;      \t\t\r\n\t\t\t\tgl_Position = vec4(vertex,1.0);\r\n\t\t\t}\r\n\t\t</vertex>\r\n\t\t<fragment precision="low">\t\t\t\r\n\t\t\tuniform samplerCube  SkyboxTexture;\r\n\t\t\tvarying vec3 v_view_dir;\r\n\t\t\tvoid main() \r\n\t\t\t{ \r\n\t\t\tgl_FragColor = textureCube(SkyboxTexture, normalize(v_view_dir));\r\n\t\t\t}\r\n\t\t</fragment>\r\n\t</shader>\r\n\t';
r.m_database=new fb;r.m_load_progress=new fb;u.m_style="";u.verbose=0;D.color_white=new t(1,1,1,1);D.color_collider=new t(.5,.9,.5,1);D.color_trigger=new t(.9,.5,.5,1);D.color_bounding=new t(.3,.3,.9,1);D.color_renderer=new t(.5,.5,.9,1);D.color_light=new t(.9,.9,.5,1);cc.Background=0;cc.Opaque=1E3;cc.Transparent=2E3;cc.Overlay=3E3;cc.Interface=4E3;db.Zero=0;db.One=1;db.SrcColor=768;db.OneMinusSrcColor=769;db.SrcAlpha=770;db.OneMinusSrcAlpha=771;db.DstAlpha=772;db.OneMinusDstAlpha=773;db.DstColor=
774;db.OneMinusDstColor=775;db.SrcAlphaSaturate=776;ed.StaticDraw=35044;ed.StreamDraw=35040;ed.DynamicDraw=35048;Eb.Points=0;Eb.Triangles=4;Eb.TriangleStrip=5;Eb.TriangleFan=6;Eb.Lines=1;Eb.LineLoop=2;Eb.LineStrip=3;fd.None=0;fd.Front=1;fd.Back=2;vb.Never=512;vb.Less=513;vb.Equal=514;vb.LessEqual=515;vb.Greater=516;vb.NotEqual=517;vb.GreaterEqual=518;vb.Always=519;Da.ClampX=1;Da.RepeatX=2;Da.ClampY=4;Da.RepeatY=8;Da.ClampZ=16;Da.RepeatZ=32;Xa.None=0;Xa.Color=1;Xa.Depth=2;Xa.Skybox=4;Xa.ColorDepth=
3;Xa.SkyboxDepth=6;$.Empty=0;$.Texture=1;$.Tint=2;$.VertexColor=4;$.Skinning=8;$.ReflectionVertex=32;$.ReflectionPixel=64;$.ReflectionTexture=128;$.FalloffVertex=256;$.FalloffPixel=512;$.Bump=1024;$.LightingVertex=2048;$.LightingPixel=4096;$.Specular=16384;$.SpecularTexture=32768;$.SpecularAlpha=65536;$.Lightmap=131072;$.FogVertex=262144;$.FogPixel=262144;$.Toon=524288;$.Cutoff=1048576;$.Particle=2097152;$.UVScroll=4194304;$.Random=8388608;$.AlphaTexture=16777216;$.Emissive=33554432;$.EmissiveTexture=
67108864;Sb.VertexLow=1;Sb.VertexMed=2;Sb.VertexHigh=4;Sb.FragmentLow=8;Sb.FragmentMed=16;Sb.FragmentHigh=32;Z.PivotX=1;Z.PivotY=2;Z.PivotXY=3;Z.PositionX=4;Z.PositionY=8;Z.PositionXY=12;Z.SizeX=16;Z.SizeY=32;Z.SizeXY=48;da.color=new t(.5,.5,.5,1);da.density=1;da.exp=1;da.start=0;da.end=1;e.ACTIVE_ATTRIBUTES=35721;e.ACTIVE_TEXTURE=34016;e.ACTIVE_UNIFORMS=35718;e.ALIASED_LINE_WIDTH_RANGE=33902;e.ALIASED_POINT_SIZE_RANGE=33901;e.ALPHA=6406;e.ALPHA_BITS=3413;e.ALWAYS=519;e.ARRAY_BUFFER=34962;e.ARRAY_BUFFER_BINDING=
34964;e.ATTACHED_SHADERS=35717;e.BACK=1029;e.BLEND=3042;e.BLEND_COLOR=32773;e.BLEND_DST_ALPHA=32970;e.BLEND_DST_RGB=32968;e.BLEND_EQUATION=32777;e.BLEND_EQUATION_ALPHA=34877;e.BLEND_EQUATION_RGB=32777;e.BLEND_SRC_ALPHA=32971;e.BLEND_SRC_RGB=32969;e.BLUE_BITS=3412;e.BOOL=35670;e.BOOL_VEC2=35671;e.BOOL_VEC3=35672;e.BOOL_VEC4=35673;e.BROWSER_DEFAULT_WEBGL=37444;e.BUFFER_SIZE=34660;e.BUFFER_USAGE=34661;e.BYTE=5120;e.CCW=2305;e.CLAMP_TO_EDGE=33071;e.COLOR_ATTACHMENT0=36064;e.COLOR_BUFFER_BIT=16384;e.COLOR_CLEAR_VALUE=
3106;e.COLOR_WRITEMASK=3107;e.COMPILE_STATUS=35713;e.COMPRESSED_TEXTURE_FORMATS=34467;e.CONSTANT_ALPHA=32771;e.CONSTANT_COLOR=32769;e.CONTEXT_LOST_WEBGL=37442;e.CULL_FACE=2884;e.CULL_FACE_MODE=2885;e.CURRENT_PROGRAM=35725;e.CURRENT_VERTEX_ATTRIB=34342;e.CW=2304;e.DECR=7683;e.DECR_WRAP=34056;e.DELETE_STATUS=35712;e.DEPTH_ATTACHMENT=36096;e.DEPTH_BITS=3414;e.DEPTH_BUFFER_BIT=256;e.DEPTH_CLEAR_VALUE=2931;e.DEPTH_COMPONENT=6402;e.DEPTH_COMPONENT16=33189;e.DEPTH_FUNC=2932;e.DEPTH_RANGE=2928;e.DEPTH_STENCIL=
34041;e.DEPTH_STENCIL_ATTACHMENT=33306;e.DEPTH_TEST=2929;e.DEPTH_WRITEMASK=2930;e.DITHER=3024;e.DONT_CARE=4352;e.DST_ALPHA=772;e.DST_COLOR=774;e.DYNAMIC_DRAW=35048;e.ELEMENT_ARRAY_BUFFER=34963;e.ELEMENT_ARRAY_BUFFER_BINDING=34965;e.EQUAL=514;e.FASTEST=4353;e.FLOAT=5126;e.FLOAT_MAT2=35674;e.FLOAT_MAT3=35675;e.FLOAT_MAT4=35676;e.FLOAT_VEC2=35664;e.FLOAT_VEC3=35665;e.FLOAT_VEC4=35666;e.FRAGMENT_SHADER=35632;e.FRAMEBUFFER=36160;e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049;e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=
36048;e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051;e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050;e.FRAMEBUFFER_BINDING=36006;e.FRAMEBUFFER_COMPLETE=36053;e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054;e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057;e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055;e.FRAMEBUFFER_UNSUPPORTED=36061;e.FRONT=1028;e.FRONT_AND_BACK=1032;e.FRONT_FACE=2886;e.FUNC_ADD=32774;e.FUNC_REVERSE_SUBTRACT=32779;e.FUNC_SUBTRACT=32778;e.GENERATE_MIPMAP_HINT=33170;e.GEQUAL=518;e.GREATER=
516;e.GREEN_BITS=3411;e.HIGH_FLOAT=36338;e.HIGH_INT=36341;e.INCR=7682;e.INCR_WRAP=34055;e.INT=5124;e.INT_VEC2=35667;e.INT_VEC3=35668;e.INT_VEC4=35669;e.INVALID_ENUM=1280;e.INVALID_FRAMEBUFFER_OPERATION=1286;e.INVALID_OPERATION=1282;e.INVALID_VALUE=1281;e.INVERT=5386;e.KEEP=7680;e.LEQUAL=515;e.LESS=513;e.LINEAR=9729;e.LINEAR_MIPMAP_LINEAR=9987;e.LINEAR_MIPMAP_NEAREST=9985;e.LINES=1;e.LINE_LOOP=2;e.LINE_STRIP=3;e.LINE_WIDTH=2849;e.LINK_STATUS=35714;e.LOW_FLOAT=36336;e.LOW_INT=36339;e.LUMINANCE=6409;
e.LUMINANCE_ALPHA=6410;e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661;e.MAX_CUBE_MAP_TEXTURE_SIZE=34076;e.MAX_FRAGMENT_UNIFORM_VECTORS=36349;e.MAX_RENDERBUFFER_SIZE=34024;e.MAX_TEXTURE_IMAGE_UNITS=34930;e.MAX_TEXTURE_SIZE=3379;e.MAX_VARYING_VECTORS=36348;e.MAX_VERTEX_ATTRIBS=34921;e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660;e.MAX_VERTEX_UNIFORM_VECTORS=36347;e.MAX_VIEWPORT_DIMS=3386;e.MEDIUM_FLOAT=36337;e.MEDIUM_INT=36340;e.MIRRORED_REPEAT=33648;e.NEAREST=9728;e.NEAREST_MIPMAP_LINEAR=9986;e.NEAREST_MIPMAP_NEAREST=
9984;e.NEVER=512;e.NICEST=4354;e.NONE=0;e.NOTEQUAL=517;e.NO_ERROR_GL=0;e.ONE=1;e.ONE_MINUS_CONSTANT_ALPHA=32772;e.ONE_MINUS_CONSTANT_COLOR=32770;e.ONE_MINUS_DST_ALPHA=773;e.ONE_MINUS_DST_COLOR=775;e.ONE_MINUS_SRC_ALPHA=771;e.ONE_MINUS_SRC_COLOR=769;e.OUT_OF_MEMORY=1285;e.PACK_ALIGNMENT=3333;e.POINTS=0;e.POLYGON_OFFSET_FACTOR=32824;e.POLYGON_OFFSET_FILL=32823;e.POLYGON_OFFSET_UNITS=10752;e.RED_BITS=3410;e.RENDERBUFFER=36161;e.RENDERBUFFER_ALPHA_SIZE=36179;e.RENDERBUFFER_BINDING=36007;e.RENDERBUFFER_BLUE_SIZE=
36178;e.RENDERBUFFER_DEPTH_SIZE=36180;e.RENDERBUFFER_GREEN_SIZE=36177;e.RENDERBUFFER_HEIGHT=36163;e.RENDERBUFFER_INTERNAL_FORMAT=36164;e.RENDERBUFFER_RED_SIZE=36176;e.RENDERBUFFER_STENCIL_SIZE=36181;e.RENDERBUFFER_WIDTH=36162;e.RENDERER=7937;e.REPEAT=10497;e.REPLACE=7681;e.RGB=6407;e.RGB565=36194;e.RGB5_A1=32855;e.RGBA=6408;e.RGBA4=32854;e.SAMPLER_2D=35678;e.SAMPLER_CUBE=35680;e.SAMPLES=32937;e.SAMPLE_ALPHA_TO_COVERAGE=32926;e.SAMPLE_BUFFERS=32936;e.SAMPLE_COVERAGE=32928;e.SAMPLE_COVERAGE_INVERT=
32939;e.SAMPLE_COVERAGE_VALUE=32938;e.SCISSOR_BOX=3088;e.SCISSOR_TEST=3089;e.SHADER_TYPE=35663;e.SHADING_LANGUAGE_VERSION=35724;e.SHORT=5122;e.SRC_ALPHA=770;e.SRC_ALPHA_SATURATE=776;e.SRC_COLOR=768;e.STATIC_DRAW=35044;e.STENCIL_ATTACHMENT=36128;e.STENCIL_BACK_FAIL=34817;e.STENCIL_BACK_FUNC=34816;e.STENCIL_BACK_PASS_DEPTH_FAIL=34818;e.STENCIL_BACK_PASS_DEPTH_PASS=34819;e.STENCIL_BACK_REF=36003;e.STENCIL_BACK_VALUE_MASK=36004;e.STENCIL_BACK_WRITEMASK=36005;e.STENCIL_BITS=3415;e.STENCIL_BUFFER_BIT=1024;
e.STENCIL_CLEAR_VALUE=2961;e.STENCIL_FAIL=2964;e.STENCIL_FUNC=2962;e.STENCIL_INDEX=6401;e.STENCIL_INDEX8=36168;e.STENCIL_PASS_DEPTH_FAIL=2965;e.STENCIL_PASS_DEPTH_PASS=2966;e.STENCIL_REF=2967;e.STENCIL_TEST=2960;e.STENCIL_VALUE_MASK=2963;e.STENCIL_WRITEMASK=2968;e.STREAM_DRAW=35040;e.SUBPIXEL_BITS=3408;e.TEXTURE=5890;e.TEXTURE0=33984;e.TEXTURE1=33985;e.TEXTURE10=33994;e.TEXTURE11=33995;e.TEXTURE12=33996;e.TEXTURE13=33997;e.TEXTURE14=33998;e.TEXTURE15=33999;e.TEXTURE16=34E3;e.TEXTURE17=34001;e.TEXTURE18=
34002;e.TEXTURE19=34003;e.TEXTURE2=33986;e.TEXTURE20=34004;e.TEXTURE21=34005;e.TEXTURE22=34006;e.TEXTURE23=34007;e.TEXTURE24=34008;e.TEXTURE25=34009;e.TEXTURE26=34010;e.TEXTURE27=34011;e.TEXTURE28=34012;e.TEXTURE29=34013;e.TEXTURE3=33987;e.TEXTURE30=34014;e.TEXTURE31=34015;e.TEXTURE4=33988;e.TEXTURE5=33989;e.TEXTURE6=33990;e.TEXTURE7=33991;e.TEXTURE8=33992;e.TEXTURE9=33993;e.TEXTURE_2D=3553;e.TEXTURE_BINDING_2D=32873;e.TEXTURE_BINDING_CUBE_MAP=34068;e.TEXTURE_CUBE_MAP=34067;e.TEXTURE_CUBE_MAP_NEGATIVE_X=
34070;e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072;e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074;e.TEXTURE_CUBE_MAP_POSITIVE_X=34069;e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071;e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073;e.TEXTURE_MAG_FILTER=10240;e.TEXTURE_MIN_FILTER=10241;e.TEXTURE_WRAP_S=10242;e.TEXTURE_WRAP_T=10243;e.TRIANGLES=4;e.TRIANGLE_FAN=6;e.TRIANGLE_STRIP=5;e.UNPACK_ALIGNMENT=3317;e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443;e.UNPACK_FLIP_Y_WEBGL=37440;e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441;e.UNSIGNED_BYTE=5121;e.UNSIGNED_INT=
5125;e.UNSIGNED_SHORT=5123;e.UNSIGNED_SHORT_4_4_4_4=32819;e.UNSIGNED_SHORT_5_5_5_1=32820;e.UNSIGNED_SHORT_5_6_5=33635;e.VALIDATE_STATUS=35715;e.VENDOR=7936;e.VERSION=7938;e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975;e.VERTEX_ATTRIB_ARRAY_ENABLED=34338;e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922;e.VERTEX_ATTRIB_ARRAY_POINTER=34373;e.VERTEX_ATTRIB_ARRAY_SIZE=34339;e.VERTEX_ATTRIB_ARRAY_STRIDE=34340;e.VERTEX_ATTRIB_ARRAY_TYPE=34341;e.VERTEX_SHADER=35633;e.VIEWPORT=2978;e.ZERO=0;e.VAO_ENABLED=!1;e.TEXTURE_SRGB=
!1;e.SRGB=35904;e.SRGB_ALPHA=35906;e.SRGB8_ALPHA8=35907;e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296;e.HALF_FLOAT=5126;e.TEXTURE_HALF=!1;e.TEXTURE_HALF_LINEAR=!1;e.TEXTURE_ANISOTROPY=-1;e.TEXTURE_ANISOTROPY_ENABLED=!1;e.MAX_TEXTURE_ANISOTROPY=1;e.TEXTURE_FLOAT=!1;e.TEXTURE_FLOAT_LINEAR=!1;e.TEXTURE_DEPTH_ENABLED=!1;e.MAX_ACTIVE_TEXTURE=8;e.MAX_COMBINED_TEXTURE=8;e.MAX_FRAGMENT_UNIFORM_LENGTH=128;e.MAX_VERTEX_UNIFORM_LENGTH=128;e.MAX_VERTEX_TEXTURES=0;e.BONE_TEXTURE=!1;e.VS_FLOAT_HIGHP=!0;e.VS_INT_HIGHP=
!0;e.FS_FLOAT_HIGHP=!0;e.FS_INT_HIGHP=!0;la.m_last_viewport=Ca.get_empty();mb.template='\r\n\t<shader id="@ID">\t\r\n\t\t<vertex precision="@VSP">\t\t\r\n\t\t\t@VS\r\n\t\t</vertex>\t\t\r\n\t\t<fragment precision="@FSP">\t\t\t\r\n\t\t\t@FS\r\n\t\t</fragment>\t\r\n\t</shader>\t\r\n\t';ga.vs_uniforms="\r\n\tuniform mat4  WorldMatrix;\r\n\tuniform mat4  WorldMatrixIT;\r\n\tuniform mat4  WorldMatrixInverse;\r\n\tuniform mat4  ViewMatrix;\r\n\tuniform mat4  ViewMatrixInverse;\r\n\tuniform mat4  ProjectionMatrix;\r\n\tuniform mat4  ProjectionMatrixInverse;\r\n\t\r\n\t\r\n\t#ifdef SKINNING\t\r\n\tuniform int SkinQuality;\t\r\n\t\r\n\t#ifdef BONE_TEXTURE\r\n\tuniform sampler2D Joints;\r\n\tuniform sampler2D Binds;\t\r\n\tuniform vec4      SkinTexSize;\r\n\t#else\t\t\r\n\tuniform vec4  Joints[MAX_BONES*3];\r\n\tuniform vec4   Binds[MAX_BONES*3];\r\n\t#endif\r\n\t\r\n\t#endif\r\n\t\r\n\t#ifdef UV_SCROLL\r\n\tuniform vec3 UVOffset;\r\n\tuniform vec3 UVSpeed;\t\r\n\t#endif\r\n\t\r\n\t#ifdef UV_SCROLL\r\n\tuniform float Time;\r\n\t#endif\t\r\n\t\r\n\t#ifdef FOG\r\n\t#define CameraNear CameraProjection.x\r\n\t#define CameraFar  CameraProjection.y\r\n\tuniform vec3 CameraProjection;\t\r\n\t#endif\t\r\n\t";
ga.vs_attribs="\r\n\tattribute vec3 vertex;\r\n\t\r\n\t#ifdef VERTEX_COLOR\r\n\tattribute vec4 color;\r\n\t#endif\r\n\t\r\n\t#ifdef USE_NORMAL\r\n\tattribute vec3 normal;\r\n\t#endif\r\n\t\r\n\t#ifdef SKINNING\r\n\tattribute vec4 bone;\r\n\tattribute vec4 weight;\t\t\r\n\t#endif\r\n\t\r\n\t#ifdef TEXTURE\r\n\tattribute vec3 uv0;\r\n\t#endif\r\n\t\r\n\t#ifdef USE_UV1\r\n\tattribute vec3 uv1;\r\n\t#endif\t\r\n\t";ga.vs_functions="\r\n\t#ifdef SKINNING\t\r\n\tmat4 GetJointMatrix(const int b0, const int b1, const int b2) \r\n\t{ \r\n\t\t#ifdef BONE_TEXTURE\t\t\r\n\t\t/*\r\n\t\tfloat itw = SkinTexSize.z;\r\n\t\tfloat ith = SkinTexSize.w;\r\n\t\tfloat fb0x = mod(float(b0), SkinTexSize.x);\r\n\t\tfloat fb1x = mod(float(b1), SkinTexSize.x);\r\n\t\tfloat fb2x = mod(float(b2), SkinTexSize.x);\r\n\t\tfloat fb0y = floor(float(b0) * itw);\r\n\t\tfloat fb1y = floor(float(b1) * itw);\r\n\t\tfloat fb2y = floor(float(b2) * itw);\t\t\t\r\n\t\tvec4 l0 = texture2D(Joints, vec2(fb0x*itw,fb0y*ith));\r\n\t\tvec4 l1 = texture2D(Joints, vec2(fb1x*itw,fb1y*ith));\r\n\t\tvec4 l2 = texture2D(Joints, vec2(fb2x*itw,fb2y*ith));\r\n\t\t//*/\r\n\t\tvec2 fb0 = vec2(mod(float(b0), SkinTexSize.x)*SkinTexSize.z, floor(float(b0) * SkinTexSize.z)*SkinTexSize.w);\r\n\t\tvec2 fb1 = vec2(mod(float(b1), SkinTexSize.x)*SkinTexSize.z, floor(float(b1) * SkinTexSize.z)*SkinTexSize.w);\r\n\t\tvec2 fb2 = vec2(mod(float(b2), SkinTexSize.x)*SkinTexSize.z, floor(float(b2) * SkinTexSize.z)*SkinTexSize.w);\r\n\t\tvec4 l0 = texture2D(Joints, fb0);\r\n\t\tvec4 l1 = texture2D(Joints, fb1);\r\n\t\tvec4 l2 = texture2D(Joints, fb2);\r\n\t\treturn mat4(l0,l1,l2,vec4(0,0,0,1));\r\n\t\t#else\r\n\t\treturn mat4(Joints[b0], Joints[b1], Joints[b2], vec4(0, 0, 0, 1)); \r\n\t\t#endif\r\n\t}\r\n\t\r\n\tmat4 GetBindMatrix (const int b0, const int b1, const int b2) \r\n\t{ \r\n\t\t#ifdef BONE_TEXTURE\t\t\t\r\n\t\t//float itw = SkinTexSize.z;\r\n\t\t//float ith = SkinTexSize.w;\r\n\t\tvec2 fb0 = vec2(mod(float(b0), SkinTexSize.x)*SkinTexSize.z, floor(float(b0) * SkinTexSize.z)*SkinTexSize.w);\r\n\t\tvec2 fb1 = vec2(mod(float(b1), SkinTexSize.x)*SkinTexSize.z, floor(float(b1) * SkinTexSize.z)*SkinTexSize.w);\r\n\t\tvec2 fb2 = vec2(mod(float(b2), SkinTexSize.x)*SkinTexSize.z, floor(float(b2) * SkinTexSize.z)*SkinTexSize.w);\r\n\t\tvec4 l0 = texture2D(Binds, fb0);\r\n\t\tvec4 l1 = texture2D(Binds, fb1);\r\n\t\tvec4 l2 = texture2D(Binds, fb2);\r\n\t\t/*\r\n\t\tfloat fb0x = mod(float(b0), SkinTexSize.x);\r\n\t\tfloat fb1x = mod(float(b1), SkinTexSize.x);\r\n\t\tfloat fb2x = mod(float(b2), SkinTexSize.x);\r\n\t\tfloat fb0y = floor(float(b0) * itw);\r\n\t\tfloat fb1y = floor(float(b1) * itw);\r\n\t\tfloat fb2y = floor(float(b2) * itw);\t\t\t\r\n\t\tvec4 l0 = texture2D(Binds, vec2(fb0x*itw,fb0y*ith));\r\n\t\tvec4 l1 = texture2D(Binds, vec2(fb1x*itw,fb1y*ith));\r\n\t\tvec4 l2 = texture2D(Binds, vec2(fb2x*itw,fb2y*ith));\r\n\t\t//*/\r\n\t\treturn mat4(l0,l1,l2,vec4(0,0,0,1));\r\n\t\t#else\r\n\t\treturn mat4(Binds[b0] , Binds[b1] , Binds[b2] , vec4(0, 0, 0, 1)); \r\n\t\t#endif\r\n\t}\r\n\t\r\n\tmat4 SkinWorldMatrix()\r\n\t{\r\n\t\tvec4 b = bone * 3.0;\t\t\t\r\n\t\tvec4 w = weight;\t\t\t\r\n\t\tfloat ivs = 0.0;\r\n\t\tif (SkinQuality >= 0) ivs += weight.x;\r\n\t\tif (SkinQuality >= 2) ivs += weight.y;\r\n\t\tif (SkinQuality >= 3) ivs += weight.z;\r\n\t\tif (SkinQuality >= 4) ivs += weight.w;\t\t\t\r\n\t\tw *= 1.0 / ivs;\t\t\t\r\n\t\tivec4 bi0 = ivec4(b.x, b.y, b.z, b.w);\t\t\t\r\n\t\tivec4 bi1 = ivec4(b.x + 1.0, b.y + 1.0, b.z + 1.0, b.w + 1.0);\t\t\t\r\n\t\tivec4 bi2 = ivec4(b.x + 2.0, b.y + 2.0, b.z + 2.0, b.w + 2.0);\t\t\t\r\n\t\tmat4 res = mat4(0.0),jm,bm;\t\t\t\r\n\t\tif (SkinQuality >= 0) { jm = GetJointMatrix(bi0.x, bi1.x, bi2.x); bm = GetBindMatrix(bi0.x, bi1.x, bi2.x); res += ((bm * jm) * w.x); }\r\n\t\tif (SkinQuality >= 2) { jm = GetJointMatrix(bi0.y, bi1.y, bi2.y); bm = GetBindMatrix(bi0.y, bi1.y, bi2.y); res += ((bm * jm) * w.y); }\r\n\t\tif (SkinQuality >= 3) { jm = GetJointMatrix(bi0.z, bi1.z, bi2.z); bm = GetBindMatrix(bi0.z, bi1.z, bi2.z); res += ((bm * jm) * w.z); }\r\n\t\tif (SkinQuality >= 4) { jm = GetJointMatrix(bi0.w, bi1.w, bi2.w); bm = GetBindMatrix(bi0.w, bi1.w, bi2.w); res += ((bm * jm) * w.w); }\t\t\r\n\t\treturn res;\r\n\t}\t\r\n\t#endif\r\n\t";
ga.fs_uniforms="\r\n\t#ifdef TEXTURE\t\r\n\tuniform sampler2D DiffuseTexture;\r\n\t#endif\t\r\n\t\r\n\t#ifdef SPECULAR_TEXTURE\r\n\tuniform sampler2D SpecularTexture;\r\n\t#endif\r\n\t\r\n\t#ifdef ALPHA_TEXTURE\r\n\tuniform sampler2D AlphaTexture;\r\n\t#endif\r\n\t\r\n\t#ifdef BUMP\r\n\tuniform sampler2D NormalTexture;\r\n\t#endif\r\n\t\r\n\t#ifdef LIGHTMAP\r\n\tuniform sampler2D Lightmap;\r\n\tuniform float LightmapFactor;\r\n\t#endif\r\n\t\r\n\t#ifdef CUTOFF\r\n\tuniform float Cutoff;\r\n\t#endif\t\r\n\t\r\n\t";
ga.g_varyings="\r\n\tvarying vec4 v_color;\r\n\t\r\n\t#ifdef USE_NORMAL\r\n\tvarying vec3 v_normal;\r\n\t#endif\r\n\t\r\n\t#ifdef LIGHTING\r\n\tvarying vec3 v_wpos;\r\n\t#endif\r\n\t\r\n\t#ifdef LIGHTING_VERTEX\r\n\tvarying vec3 v_diffuse_component;\t\r\n\t#ifdef SPECULAR\r\n\tvarying vec3 v_specular_component;\r\n\t#endif\t\t\r\n\t#endif\r\n\t\r\n\t#ifdef USE_VIEW_DIR\r\n\tvarying vec3 v_wview;\r\n\t#endif\r\n\t\r\n\t#ifdef REFLECTION_VERTEX\r\n\tvarying vec3 v_wreflection;\r\n\t#endif\r\n\t\r\n\t#ifdef FALLOFF\r\n\tvarying vec3 v_falloff_component;\r\n\t#endif\r\n\t\r\n\t#ifdef TEXTURE\t\r\n\tvarying vec3 v_uv0;\t\t\r\n\t#endif\t\r\n\t\r\n\t#ifdef USE_UV1\r\n\tvarying vec3 v_uv1;\t\r\n\t#endif\r\n\t\r\n\t#ifdef FOG\r\n\tvarying float v_linear_depth;\r\n\t#endif\r\n\t\r\n\t#ifdef FOG_VERTEX\r\n\tvarying float v_fog_component;\r\n\t#endif\r\n\t\r\n\t";
ga.g_uniforms="\r\n\t\r\n\tuniform vec3 CameraPosition;\r\n\t\r\n\t#ifdef RANDOM\t\r\n\tuniform float RandomSeed;\t\t\r\n\tuniform sampler2D RandomTexture;\r\n\t#endif\t\r\n\t\r\n\t#ifdef TINT\r\n\tuniform vec4  Tint;\r\n\t#endif\t\r\n\t\r\n\t#ifdef FOG\r\n\t#define FogColor    Fog[0]\r\n\t#define FogDensity  Fog[1].x\r\n\t#define FogExp      Fog[1].y\r\n\t#define FogStart    Fog[1].z\r\n\t#define FogEnd      Fog[1].w\r\n\tuniform vec4 Fog[2];\r\n\t#endif\t\r\n\t\r\n\t#ifdef LIGHTING\t\r\n\tuniform vec4  Ambient;\r\n\tuniform vec4 Lights[MAX_LIGHTS * 3];\t\r\n\tuniform float Shininess;\r\n\t#endif\r\n\t\r\n\t#ifdef FALLOFF\r\n\tuniform float FalloffExp;\t\t\t\r\n\tuniform float FalloffIntensity;\r\n\tuniform vec4  FalloffColor;\r\n\t#endif\r\n\t\r\n\t#ifdef USE_RAMP_TEXTURE\r\n\tuniform sampler2D RampTexture;\r\n\t#endif\r\n\t\r\n\t#ifdef REFLECTION\r\n\tuniform float ReflectionIntensity;\r\n\tuniform vec4  ReflectionColor;\r\n\tuniform samplerCube  ReflectionTexture;\r\n\t#endif\r\n\t\r\n\t#ifdef EMISSIVE\t\r\n\tuniform vec4  EmissiveColor;\r\n\t#endif\r\n\t\r\n\t";
ga.g_functions="\r\n\t#ifdef RANDOM\t\r\n\tfloat NextSeed = 0.0;\r\n\tvec4 Random()\r\n\t{\r\n\t\tfloat itw  = 0.00390625;\r\n\t\tfloat p    = NextSeed + (RandomSeed * 65536.0);\r\n\t\tfloat idx  = mod(p,256.0)   * itw;\r\n\t\tfloat idy  = floor(p * itw) * itw;\r\n\t\tNextSeed  += 1.0;\r\n\t\treturn texture2D(RandomTexture, vec2(idx,idy));\r\n\t}\r\n\t#endif\r\n\t\r\n\t#ifdef FOG\r\n\tfloat FogFactor(float p_linear_depth,float p_exp,float p_density,float p_start,float p_end) { return pow(clamp((p_linear_depth - p_start) / (p_end - p_start),0.0,1.0),p_exp) * p_density; }\r\n\t#endif\r\n\t\r\n\tvec4 texture2DOffset(sampler2D p_texture, float p_offset, float p_iw, float p_ih) { return texture2D(p_texture, vec2(mod(p_offset,1.0/p_iw)*p_iw,floor(p_offset * p_iw)*p_iw)); }\r\n\t\r\n\tfloat LinearNF(float p_hz, float p_near, float p_far) { return p_near * (p_hz + 1.0) / (p_far + p_near - p_hz * (p_far - p_near)); }\t\r\n\tfloat LinearEye(float p_hz, float p_near, float p_far) { return (2.0 * p_near) / (p_far + p_near - p_hz * (p_far - p_near)); }\t\r\n\tfloat Depth2Eye(float p_hz, float p_near, float p_far) { return (2.0 * p_near * p_far) / (p_far + p_near - p_hz * (p_far - p_near)); }\r\n\t\r\n\t#ifdef LIGHTING\r\n\t\r\n\tvec4 LightAttrib(const int p_id)   \r\n\t{ \r\n\t\tif(p_id==0) return Lights[0];\r\n\t\tif(p_id==1) return Lights[3];\r\n\t\tif(p_id==2) return Lights[6];\r\n\t\tif(p_id==3) return Lights[9];\r\n\t\tif(p_id==4) return Lights[12];\r\n\t\tif(p_id==5) return Lights[15];\r\n\t\tif(p_id==6) return Lights[18];\r\n\t\tif(p_id==7) return Lights[21];\r\n\t\treturn vec4(-1,0,0,0);\t\t\r\n\t}\r\n\t\r\n\tvec3 LightPosition(int p_id)   \r\n\t{ \r\n\t\tif(p_id==0) return Lights[1].xyz;\r\n\t\tif(p_id==1) return Lights[4].xyz;\r\n\t\tif(p_id==2) return Lights[7].xyz;\r\n\t\tif(p_id==3) return Lights[10].xyz;\r\n\t\tif(p_id==4) return Lights[13].xyz;\r\n\t\tif(p_id==5) return Lights[16].xyz;\r\n\t\tif(p_id==6) return Lights[19].xyz;\r\n\t\tif(p_id==7) return Lights[22].xyz;\r\n\t\treturn vec3(0,0,0);\r\n\t}\r\n\t\r\n\tvec4 LightColor(int p_id)   \r\n\t{ \r\n\t\tif(p_id==0) return Lights[2];\r\n\t\tif(p_id==1) return Lights[5];\r\n\t\tif(p_id==2) return Lights[8];\r\n\t\tif(p_id==3) return Lights[11];\r\n\t\tif(p_id==4) return Lights[14];\r\n\t\tif(p_id==5) return Lights[17];\r\n\t\tif(p_id==6) return Lights[20];\r\n\t\tif(p_id==7) return Lights[23];\r\n\t\treturn vec4(0,0,0,1);\r\n\t}\r\n\t\r\n\tfloat DiffuseFactor(vec3 p_normal, vec3 p_light_dir) { return clamp(dot(p_normal,p_light_dir),0.0,1.0); }\t\r\n\tfloat SpecularFactor(float p_shininess, vec3 p_normal, vec3 p_light_dir, vec3 p_view_dir) \r\n\t{ \r\n\t\tvec3 hv  = normalize(p_light_dir + p_view_dir);\r\n\t\tfloat dv = clamp(dot(hv, p_normal), 0.0, 1.0);\r\n\t\treturn pow(dv, p_shininess);\r\n\t}\r\n\t\r\n\tvec3 LightingLambert(float p_intensity,vec3 p_light_color,vec3 p_light_dir,vec3 p_normal)\r\n\t{\t\t\t\t\r\n\t\tfloat df = DiffuseFactor(p_normal, p_light_dir);\r\n\t\treturn p_light_color * df * p_intensity;\r\n\t}\r\n\t\r\n\tvec3 LightingPhong(float p_intensity,vec3 p_light_color,vec3 p_light_dir,vec3 p_normal,vec3 p_view_dir,float p_shininess)\r\n\t{\r\n\t\tfloat sf = SpecularFactor(p_shininess, p_normal, p_light_dir, p_view_dir);\t\t\r\n\t\treturn p_light_color * sf * p_intensity;\r\n\t}\r\n\t\r\n\t#ifdef TOON\r\n\tvec3 LightingLambertToon(float p_intensity, vec3 p_light_color, vec3 p_light_dir, vec3 p_normal)\r\n\t{\r\n\t\tfloat df = DiffuseFactor(p_normal, p_light_dir);\t\t\r\n\t\treturn p_light_color * texture2D(RampTexture,vec2(df,0)).xyz * p_intensity;\r\n\t}\r\n\t\r\n\tvec3 LightingPhongToon(float p_intensity,vec3 p_light_color,vec3 p_light_dir,vec3 p_normal,vec3 p_view_dir,float p_shininess)\r\n\t{\r\n\t\tfloat sf = SpecularFactor(p_shininess, p_normal, p_light_dir, p_view_dir);\r\n\t\treturn p_light_color * texture2D(RampTexture,vec2(sf,0)).xyz * p_intensity;\r\n\t}\r\n\t#endif\r\n\t\r\n\tvoid ProcessLights(vec3 p_normal, vec3 p_view_dir,float p_shininess, out vec3 p_diffuse_component, out vec3 p_specular_component)\r\n\t{\r\n\t\tp_diffuse_component  = vec3(0.0);\r\n\t\tp_specular_component = vec3(0.0);\r\n\t\t\r\n\t\tfor(int i=0;i<MAX_LIGHTS;i++)\r\n\t\t{\r\n\t\t\tvec4  l_attrib \t  = LightAttrib(i);\r\n\t\t\tvec3  l_position  = LightPosition(i);\r\n\t\t\tvec3  l_color \t  = LightColor(i).xyz;\r\n\t\t\tint   l_type   \t  = int(l_attrib.x);\r\n\t\t\tfloat l_intensity = l_attrib.y;\r\n\t\t\tfloat l_atten \t  = l_attrib.w;\r\n\t\t\t\r\n\t\t\tvec3  l_dir\t\t  = vec3(0.0);\r\n\t\t\t\r\n\t\t\t//Invalid Light can stop here\r\n\t\t\tif (l_type == -1) break;\r\n\t\t\t\r\n\t\t\t//Point Light\r\n\t\t\tif(l_type == 0)\r\n\t\t\t{\r\n\t\t\t\tfloat l_radius  = l_attrib.z * 0.5;\t\r\n\t\t\t\tl_dir = -(v_wpos - l_position);\r\n\t\t\t\tl_intensity   = (1.0 - clamp(length(l_dir) / l_radius, 0.0, 1.0)) * l_intensity;\t\t\t\t\t\r\n\t\t\t\tl_dir = normalize(l_dir);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//Directional Light\r\n\t\t\tif(l_type == 1)\r\n\t\t\t{\r\n\t\t\t\tl_dir = l_position;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvec3 d_component = vec3(0);\r\n\t\t\t\r\n\t\t\t#ifdef TOON\r\n\t\t\td_component = LightingLambertToon(l_intensity, l_color, l_dir, p_normal);\r\n\t\t\t#else\r\n\t\t\td_component = LightingLambert(l_intensity, l_color, l_dir, p_normal);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tp_diffuse_component += d_component;\r\n\t\t\t\r\n\t\t\t#ifdef SPECULAR\r\n\t\t\tvec3 s_component = vec3(0);\r\n\t\t\t\r\n\t\t\t#ifdef TOON\r\n\t\t\ts_component = LightingPhongToon(l_intensity,l_color,l_dir,p_normal,p_view_dir,p_shininess);\r\n\t\t\t#else\r\n\t\t\ts_component = LightingPhong(l_intensity,l_color,l_dir,p_normal,p_view_dir,p_shininess);\r\n\t\t\t#endif\r\n\t\t\t\r\n\t\t\tp_specular_component += s_component;\r\n\t\t\t#endif\t\t\t\t\t\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\t#endif\r\n\t\r\n\t#ifdef FALLOFF\r\n\tfloat Falloff(vec3 p_view_dir, vec3 p_normal, float p_exp) { return pow(1.0 - clamp(dot(p_view_dir, p_normal), 0.0, 1.0), p_exp); }\r\n\t#endif\r\n\t\r\n\t";
ga.g_preprocessors="\t\r\n\t#if defined(LIGHTING) || defined(FALLOFF) || defined(REFLECTION) || defined(BUMP) || defined(REFLECTION)\r\n\t#define USE_NORMAL\r\n\t#endif\r\n\t\r\n\t#if defined(FALLOFF) || defined(SPECULAR)  || defined(REFLECTION)\r\n\t#define USE_VIEW_DIR\r\n\t#endif\r\n\t\r\n\t#if defined(LIGHTMAP) || defined(BUMP)\r\n\t#define USE_UV1\r\n\t#endif\r\n\t\r\n\t#if defined(TEXTURE) || defined(ALPHA_TEXTURE)\r\n\t#define USE_DIFFUSE_TEXTURE\r\n\t#endif\r\n\t\r\n\t#if defined(TOON)\r\n\t#define USE_RAMP_TEXTURE\r\n\t#endif\r\n\t\r\n\t\r\n\t\r\n\t";
p.scroll=!1;p.menu=!1;p.emulateTouch=!1;ab.analogBias=[.1,.9];ab.buttonBias=.9;ab.available=!1;h.Modifiers=-65536;h.None=0;h.Mouse0=1;h.Mouse1=2;h.Cancel=3;h.Mouse2=4;h.Mouse3=5;h.Mouse4=6;h.Back=8;h.Tab=9;h.LineFeed=10;h.Clear=12;h.Enter=13;h.Return=13;h.ShiftKey=16;h.ControlKey=17;h.Alt=18;h.Pause=19;h.CapsLock=20;h.Capital=20;h.KanaMode=21;h.HanguelMode=21;h.HangulMode=21;h.JunjaMode=23;h.FinalMode=24;h.KanjiMode=25;h.HanjaMode=25;h.Escape=27;h.IMEConvert=28;h.IMENonconvert=29;h.IMEAceept=30;h.IMEAccept=
30;h.IMEModeChange=31;h.Space=32;h.Prior=33;h.PageUp=33;h.Next=34;h.PageDown=34;h.End=35;h.Home=36;h.Left=37;h.Up=38;h.Right=39;h.Down=40;h.Select=41;h.Print=42;h.Execute=43;h.PrintScreen=44;h.Snapshot=44;h.Insert=45;h.Delete=46;h.Help=47;h.D0=48;h.D1=49;h.D2=50;h.D3=51;h.D4=52;h.D5=53;h.D6=54;h.D7=55;h.D8=56;h.D9=57;h.A=65;h.B=66;h.C=67;h.D=68;h.E=69;h.F=70;h.G=71;h.H=72;h.I=73;h.J=74;h.K=75;h.L=76;h.M=77;h.N=78;h.O=79;h.P=80;h.Q=81;h.R=82;h.S=83;h.T=84;h.U=85;h.V=86;h.W=87;h.X=88;h.Y=89;h.Z=90;
h.LWin=91;h.RWin=92;h.Apps=93;h.Sleep=95;h.NumPad0=96;h.NumPad1=97;h.NumPad2=98;h.NumPad3=99;h.NumPad4=100;h.NumPad5=101;h.NumPad6=102;h.NumPad7=103;h.NumPad8=104;h.NumPad9=105;h.Multiply=106;h.Add=107;h.Separator=108;h.Subtract=109;h.Decimal=110;h.Divide=111;h.F1=112;h.F2=113;h.F3=114;h.F4=115;h.F5=116;h.F6=117;h.F7=118;h.F8=119;h.F9=120;h.F10=121;h.F11=122;h.F12=123;h.F13=124;h.F14=125;h.F15=126;h.F16=127;h.F17=128;h.F18=129;h.F19=130;h.F20=131;h.F21=132;h.F22=133;h.F23=134;h.F24=135;h.NumLock=
144;h.Scroll=145;h.LShiftKey=160;h.RShiftKey=161;h.LControlKey=162;h.RControlKey=163;h.LAlt=164;h.RAlt=165;h.BrowserBack=166;h.BrowserForward=167;h.BrowserRefresh=168;h.BrowserStop=169;h.BrowserSearch=170;h.BrowserFavorites=171;h.BrowserHome=172;h.VolumeMute=173;h.VolumeDown=174;h.VolumeUp=175;h.MediaNextTrack=176;h.MediaPreviousTrack=177;h.MediaStop=178;h.MediaPlayPause=179;h.LaunchMail=180;h.SelectMedia=181;h.LaunchApplication1=182;h.LaunchApplication2=183;h.Oem1=186;h.OemSemicolon=186;h.Oemplus=
187;h.Oemcomma=188;h.OemMinus=189;h.OemPeriod=190;h.OemQuestion=191;h.Oem2=191;h.Oemtilde=192;h.Oem3=192;h.Oem4=219;h.OemOpenBrackets=219;h.OemPipe=220;h.Oem5=220;h.Oem6=221;h.OemCloseBrackets=221;h.Oem7=222;h.OemQuotes=222;h.Oem8=223;h.Oem102=226;h.OemBackslash=226;h.ProcessKey=229;h.Packet=231;h.Attn=246;h.Crsel=247;h.Exsel=248;h.EraseEof=249;h.Play=250;h.Zoom=251;h.NoName=252;h.Pa1=253;h.OemClear=254;h.KeyCodeMask=65535;h.ShiftModifier=65536;h.ControlModifier=131072;h.AltModifier=262144;h.Face1=
0;h.Face2=1;h.Face3=2;h.Face4=3;h.ButtonA=0;h.ButtonB=1;h.ButtonX=2;h.ButtonY=3;h.LeftShoulder=4;h.RightShoulder=5;h.LeftShoulderBottom=6;h.RightShoulderBottom=7;h.ButtonSelect=8;h.ButtonStart=9;h.LeftAnalogueStick=10;h.RightAnalogueStick=11;h.PadTop=12;h.PadBottom=13;h.PadLeft=14;h.PadRight=15;h.LeftAnalogueHor=0;h.LeftAnalogueVert=1;h.RightAnalogueHor=2;h.RightAnalogueVert=3;l.Epsilon=1E-4;l.NaN=Math.NaN;l.Infinity=Math.POSITIVE_INFINITY;l.NegativeInfinity=Math.NEGATIVE_INFINITY;l.E=2.718281828459045;
l.PI=3.141592653589793;l.HalfPI=1.5707963267948966;l.PI2=6.283185307179586;l.PI4=12.566370614359172;l.InvPI=.3183098861837907;l.Rad2Deg=57.29577951308232;l.Deg2Rad=.017453292519943295;l.Px2Em=.063;l.Em2Px=15.87301587301587;l.Byte2Float=.00392156863;l.Short2Float=1.52587890625E-5;l.Long2Float=2.3283064365386963E-10;l.Float2Byte=255;l.Float2Short=65536;l.Float2Long=4294967296;ya.root="";Na.DATA_SIZE=64;Na.particle_kernel_source='\r\n\t<shader id="haxor/kernel/ParticleKernel">\t\r\n\t\t<vertex precision="high">\r\n\t\tattribute vec3 vertex;\t\t\t\r\n\t\tvarying vec2 iterator;\t\t\t\t\r\n\t\tvoid main(void) \r\n\t\t{\t\r\n\t\t\tgl_Position = vec4(vertex,1.0);\r\n\t\t\titerator.x = (vertex.x+1.0)*0.5;\r\n\t\t\titerator.y = (vertex.y+1.0)*0.5;\r\n\t\t}\t\t\r\n\t\t</vertex>\r\n\t\t\r\n\t\t<fragment precision="high">\r\n\t\t\r\n\t\t\t#define EmmiterType\t\t\t int(System[0].x)\r\n\t\t\t#define EmitterSize\t\t\t System[0].yzw\r\n\t\t\t\r\n\t\t\t#define IsSurfaceEmission\t (System[1].x > 0.0)\r\n\t\t\t#define IsRandomDirection\t (System[1].y > 0.0)\t\t\t\r\n\t\t\t#define IsLocal\t\t\t\t (System[1].z > 0.0)\r\n\t\t\t#define IsLoop\t\t\t\t (System[1].w > 0.0)\r\n\t\t\t\r\n\t\t\t#define SystemState\t\t\t int(System[2].x)\r\n\t\t\t#define SystemProgress\t\t System[2].y\t\t\t\r\n\t\t\t#define DeltaTime\t\t \t System[2].w\r\n\t\t\t\r\n\t\t\t#define StartSpeed\t\t\t System[3]\r\n\t\t\t#define StartSize0\t\t\t System[4]\r\n\t\t\t#define StartSize1\t\t\t System[5]\r\n\t\t\t#define StartLife\t\t\t System[6]\r\n\t\t\t#define StartRotation0\t\t System[7]\r\n\t\t\t#define StartRotation1\t\t System[8]\r\n\t\t\t\r\n\t\t\t#define LifeSpeed\t\t\t System[9]\r\n\t\t\t#define LifeMotion0\t\t\t System[10]\r\n\t\t\t#define LifeMotion1\t\t\t System[11]\r\n\t\t\t#define LifeSize0\t\t\t System[12]\r\n\t\t\t#define LifeSize1\t\t\t System[13]\r\n\t\t\t#define LifeRotation0\t\t System[14]\r\n\t\t\t#define LifeRotation1\t\t System[15]\r\n\t\t\t\r\n\t\t\t#define SystemForce\t\t\t System[16].xyz\r\n\t\t\t\r\n\t\t\t#define WorldMatrix\t\t\t mat4(System[17].xyzw, System[18].xyzw, System[19].xyzw, vec4(0,0,0,1))\r\n\t\t\t\r\n\t\t\t#define StartFrame\t\t\t System[20]\r\n\t\t\t#define SheetFrameWidth\t \t System[21].x\r\n\t\t\t#define SheetFrameHeight \t System[21].y\r\n\t\t\t#define SheetFPS\t\t \t System[21].z\r\n\t\t\t#define SheetWrap\t\t \t System[21].w\r\n\t\t\t#define SheetLength\t\t \t System[22].x\r\n\t\t\t#define EmitterRangeX\t \t System[22].yz\r\n\t\t\t#define EmitterRangeY\t \t System[23].xy\r\n\t\t\t#define EmitterRangeZ\t \t System[23].zw\r\n\t\t\t#define SystemEmissionStart\t System[24].x\r\n\t\t\t#define SystemEmissionCount\t System[24].y\r\n\t\t\t\t\t\t\r\n\t\t\t#define PARTICLE_LENGTH\t\t 8.0\r\n\t\t\t\r\n\t\t\t#define EMITTER_SPHERE\t\t 0\r\n\t\t\t#define EMITTER_BOX\t\t\t 1\r\n\t\t\t#define EMITTER_CONE\t\t 2\r\n\t\t\t#define EMITTER_CYLINDER\t 3\r\n\t\t\t\r\n\t\t\t#define PARTICLE_STATUS\t\t 0\r\n\t\t\t#define PARTICLE_POSITION\t 1\r\n\t\t\t#define PARTICLE_ROTATION\t 2\r\n\t\t\t#define PARTICLE_SIZE\t\t 3\r\n\t\t\t#define PARTICLE_VELOCITY\t 4\r\n\t\t\t#define PARTICLE_COLOR\t\t 5\r\n\t\t\t#define PARTICLE_START\t\t 6\r\n\t\t\t#define PARTICLE_NULL\t\t 7\r\n\t\t\t\r\n\t\t\t#define STATE_NONE\t\t 0\r\n\t\t\t#define STATE_RESET\t\t 1\r\n\t\t\t#define STATE_UPDATE\t 2\r\n\t\t\t#define STATE_LOAD   \t 3\r\n\t\t\t\r\n\t\t\t#define PARTICLE_DISABLED\t 0\r\n\t\t\t#define PARTICLE_INIT\t\t 1\r\n\t\t\t#define PARTICLE_ENABLED\t 2\r\n\t\t\t#define PARTICLE_DEAD\t\t 3\r\n\t\t\t\r\n\t\t\tfloat particle_id;\t\t\t\r\n\t\t\tfloat particle_field;\r\n\t\t\tfloat fragment_id;\r\n\t\t\t\r\n\t\t\tvarying vec2 \t\titerator;\t\t\t\r\n\t\t\tuniform sampler2D \tData;\t\t\t\r\n\t\t\tuniform sampler2D \tStartColor;\t\t\t\r\n\t\t\tuniform sampler2D \tColor;\t\t\t\r\n\t\t\tuniform float \t\twidth;\t\t\t\r\n\t\t\tuniform float \t\theight;\t\t\t\r\n\t\t\tuniform vec4  \t\tSystem[25];\t\t\t\r\n\t\t\tuniform float \t\tRandomSeed;\t\t\r\n\t\t\tuniform sampler2D \tRandomTexture;\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tvec4 Random()\r\n\t\t\t{\r\n\t\t\t\tfloat tw   = 1.0/128.0;\r\n\t\t\t\tfloat seed = RandomSeed * 262144.0;\r\n\t\t\t\tfloat idx  = mod(seed+fragment_id,128.0) * tw;\r\n\t\t\t\tfloat idy  = floor((seed+fragment_id) * tw)  * tw;\r\n\t\t\t\tvec2  ruv  = vec2(idx,idy);\r\n\t\t\t\tseed      += tw * fract(sin(dot(ruv ,vec2(12.9898,78.233))) * 43758.5453);\r\n\t\t\t\treturn texture2D(RandomTexture, ruv);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvec3 RandomVector() { return (Random().xyz - 0.5)*2.0; }\r\n\t\t\t\r\n\t\t\tfloat Lerp(float a, float b,float r) { return a + ((b-a)*r); }\r\n\t\t\tvec2  Lerp(vec2  a, vec2  b,float r) { return a + ((b-a)*r); }\r\n\t\t\tvec3  Lerp(vec3  a, vec3  b,float r) { return a + ((b-a)*r); }\r\n\t\t\tvec4  Lerp(vec4  a, vec4  b,float r) { return a + ((b-a)*r); }\r\n\t\t\t\r\n\t\t\tvec3 GetSphereRandomPosition(bool p_surface,float p_radius)\t\r\n\t\t\t{\t\r\n\t\t\t\tfloat r   = (p_radius*0.5);\r\n\t\t\t\tvec3 v    = RandomVector();\t\t\t\t\t\t\t\t\r\n\t\t\t\treturn p_surface ? (normalize(v) * r) : (v * r); \r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvec3 GetBoxRandomPosition(bool p_surface,vec3 p_size)\r\n\t\t\t{\t\t\t\t\r\n\t\t\t\tvec3 hs  = p_size*0.5;\r\n\t\t\t\tif(p_surface)\r\n\t\t\t\t{\r\n\t\t\t\t\tvec3 p = GetSphereRandomPosition(true,length(p_size));\r\n\t\t\t\t\tp.x = clamp(p.x,-hs.x,hs.x);\r\n\t\t\t\t\tp.y = clamp(p.y,-hs.y,hs.y);\r\n\t\t\t\t\tp.z = clamp(p.z,-hs.z,hs.z);\r\n\t\t\t\t\treturn p;\r\n\t\t\t\t}\t\t\t\r\n\t\t\t\tvec3 rnd = Random().xyz;\r\n\t\t\t\treturn vec3( Lerp(-hs.x,hs.x,rnd.x), Lerp(-hs.y,hs.y,rnd.y), Lerp(-hs.z,hs.z,rnd.z));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvec3 GetEmitterRandomPosition()\r\n\t\t\t{\r\n\t\t\t\tint id \t\t\t= EmmiterType;\r\n\t\t\t\tbool is_surface = IsSurfaceEmission;\r\n\t\t\t\t\r\n\t\t\t\tif(id == EMITTER_SPHERE) return GetSphereRandomPosition(is_surface,EmitterSize.x);\r\n\t\t\t\tif(id == EMITTER_BOX) \t return GetBoxRandomPosition(is_surface,EmitterSize);\r\n\t\t\t\treturn GetSphereRandomPosition(is_surface,EmitterSize.x);\r\n\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\tvec3 SampleParticleAttribVec3(vec4 p_start,vec4 p_end,float p_random)\r\n\t\t\t{\r\n\t\t\t\tfloat c  = p_start.w;\r\n\t\t\t\tfloat rf = p_end.w;\t\t\t\t\r\n\t\t\t\tvec3 a   = p_start.xyz;\r\n\t\t\t\tvec3 b   = p_end.xyz;\r\n\t\t\t\treturn (rf > 0.0) ? Lerp(a,b,p_random) : Lerp(a,b,pow(SystemProgress,c));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfloat SampleParticleAttribFloat(vec4 p_attribute,float p_random)\r\n\t\t\t{\r\n\t\t\t\tvec4 a   = p_attribute;\t\t\t\t\r\n\t\t\t\treturn (a.w > 0.0) ? Lerp(a.x,a.y,p_random) : Lerp(a.x,a.y,pow(SystemProgress,a.z));\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvec4 ParticleData(float p_id,int p_field)\r\n\t\t\t{\r\n\t\t\t\tfloat pix = floor(p_id) * PARTICLE_LENGTH;\r\n\t\t\t\tfloat f   = float(p_field);\r\n\t\t\t\tfloat w   = floor(width);\r\n\t\t\t\tfloat h   = floor(height);\r\n\t\t\t\tfloat px  = mod(pix+f,w) / (w-1.0);\r\n\t\t\t\tfloat py  = floor((pix+f)/w) / (h-1.0);\r\n\t\t\t\treturn texture2D(Data,vec2(px,py));\r\n\t\t\t}\r\n\t\t\r\n\t\t\tvec4 ParticleStatus()   \t{ return ParticleData(particle_id,PARTICLE_STATUS); \t}\r\n\t\t\tvec4 ParticlePosition() \t{ return ParticleData(particle_id,PARTICLE_POSITION); \t}\r\n\t\t\tvec4 ParticleRotation() \t{ return ParticleData(particle_id,PARTICLE_ROTATION); \t}\r\n\t\t\tvec4 ParticleSize() \t\t{ return ParticleData(particle_id,PARTICLE_SIZE); \t\t}\r\n\t\t\tvec4 ParticleVelocity()\t\t{ return ParticleData(particle_id,PARTICLE_VELOCITY);\t}\r\n\t\t\tvec4 ParticleColor() \t\t{ return ParticleData(particle_id,PARTICLE_COLOR); \t\t}\r\n\t\t\tvec4 ParticleStart() \t\t{ return ParticleData(particle_id,PARTICLE_START); \t\t}\r\n\t\t\r\n\t\t\t\r\n\t\t\tvec4 UpdateStatus(int p_state,vec4 p_current)\r\n\t\t\t{\r\n\t\t\t\t//[state][life][duration][frame]\r\n\t\t\t\tvec4 p   = p_current;\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_DISABLED)\r\n\t\t\t\t{\r\n\t\t\t\t\tvec4 rnd = Random();\r\n\t\t\t\t\tp.x = 1.0;\r\n\t\t\t\t\tp.y = 0.0;\r\n\t\t\t\t\tp.z = SampleParticleAttribFloat(StartLife,rnd.x);\r\n\t\t\t\t\tp.w = SampleParticleAttribFloat(StartFrame,rnd.y);\r\n\t\t\t\t\treturn p;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_INIT)\r\n\t\t\t\t{\r\n\t\t\t\t\tp.x = 2.0;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_ENABLED)\r\n\t\t\t\t{\t\t\t\t\t\t\r\n\t\t\t\t\tif(p.y >= p.z)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tp.y = p.z;\r\n\t\t\t\t\t\tp.x = 3.0;\r\n\t\t\t\t\t\treturn p;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tp.y += DeltaTime;\t\t\t\t\t\r\n\t\t\t\t\tp.w += SheetFPS * DeltaTime;\r\n\t\t\t\t\tif(p.w >= SheetLength)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tp.w = SheetLength;\t\t\t\t\t\t\r\n\t\t\t\t\t\tif(int(SheetWrap)==1) p.w=0.0;\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn p;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn p;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvec4 UpdatePosition(int p_state,vec4 p_status,vec4 p_current)\r\n\t\t\t{\r\n\t\t\t\tvec4 p   = p_status;\r\n\t\t\t\tvec4 c   = p_current;\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_DISABLED)\r\n\t\t\t\t{\r\n\t\t\t\t\tc.xyz = GetEmitterRandomPosition();\r\n\t\t\t\t\tif(!IsLocal) { c.w=1.0; c = c * WorldMatrix; }\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_ENABLED)\r\n\t\t\t\t{\r\n\t\t\t\t\tfloat r = p.z <= 0.0 ? 0.0 : (p.y/p.z);\r\n\t\t\t\t\tvec3  v = ParticleVelocity().xyz * Lerp(LifeMotion0.xyz,LifeMotion1.xyz,r);\t\t\t\t\t\r\n\t\t\t\t\tfloat speed =  Lerp(StartSpeed.x,StartSpeed.y,ParticleStart().x) * Lerp(LifeSpeed.x,LifeSpeed.y,r);\t\t\t\t\t\r\n\t\t\t\t\tc.xyz += v * speed * DeltaTime;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn c;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tvec4 UpdateVelocity(int p_state,vec4 p_status,vec4 p_current)\r\n\t\t\t{\r\n\t\t\t\tvec4 p   \t\t= p_status;\t\t\t\t\r\n\t\t\t\tvec4 c   \t\t= p_current;\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_INIT)\r\n\t\t\t\t{\r\n\t\t\t\t\tvec4 rnd;\r\n\t\t\t\t\tc.xyz  = IsRandomDirection ? normalize((Random().xyz-0.5)*2.0) : normalize(ParticlePosition().xyz);\t\t\t\t\t\r\n\t\t\t\t\tc.x = clamp(c.x,EmitterRangeX.x,EmitterRangeX.y);\r\n\t\t\t\t\tc.y = clamp(c.y,EmitterRangeY.x,EmitterRangeY.y);\r\n\t\t\t\t\tc.z = clamp(c.z,EmitterRangeZ.x,EmitterRangeZ.y);\r\n\t\t\t\t\tc = normalize(c);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_ENABLED)\r\n\t\t\t\t{\r\n\t\t\t\t\tc.xyz += SystemForce * DeltaTime;\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn c;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvec4 UpdateRotation(int p_state,vec4 p_status,vec4 p_current)\r\n\t\t\t{\r\n\t\t\t\tvec4 p   = p_status;\r\n\t\t\t\tvec4 c   = p_current;\r\n\t\t\t\tc = vec4(0,0,0,0);\r\n\t\t\t\treturn c;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvec4 UpdateSize(int p_state,vec4 p_status,vec4 p_current)\r\n\t\t\t{\r\n\t\t\t\tvec4 p   = p_status;\r\n\t\t\t\tvec4 c   = p_current;\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_DISABLED)\r\n\t\t\t\t{\r\n\t\t\t\t\tfloat r = p.z <= 0.0 ? 0.0 : (p.y/p.z);\r\n\t\t\t\t\tc.xyz = Lerp(StartSize0.xyz,StartSize1.xyz,ParticleStart().y) * Lerp(LifeSize0.xyz,LifeSize1.xyz,r);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_ENABLED)\r\n\t\t\t\t{\r\n\t\t\t\t\tfloat r = p.z <= 0.0 ? 0.0 : (p.y/p.z);\r\n\t\t\t\t\tc.xyz = Lerp(StartSize0.xyz,StartSize1.xyz,ParticleStart().y) * Lerp(LifeSize0.xyz,LifeSize1.xyz,r);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn c;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tvec4 UpdateColor(int p_state,vec4 p_status,vec4 p_current)\r\n\t\t\t{\r\n\t\t\t\tvec4 p   = p_status;\r\n\t\t\t\tvec4 c   = p_current;\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_DISABLED)\r\n\t\t\t\t{\r\n\t\t\t\t\tvec4 c0 = texture2D(StartColor,vec2(ParticleStart().z,0.0));\r\n\t\t\t\t\tfloat r = p.z <= 0.0 ? 0.0 : (p.y/p.z);\r\n\t\t\t\t\tvec4 c1 = texture2D(Color,vec2(r,0.0));\r\n\t\t\t\t\tc = c0 * c1;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_ENABLED)\r\n\t\t\t\t{\r\n\t\t\t\t\tvec4 c0 = texture2D(StartColor,vec2(ParticleStart().z,0.0));\r\n\t\t\t\t\tfloat r = p.z <= 0.0 ? 0.0 : (p.y/p.z);\r\n\t\t\t\t\tvec4 c1 = texture2D(Color,vec2(r,0.0));\r\n\t\t\t\t\tc = c0 * c1;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn c;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvec4 UpdateStart(int p_state,vec4 p_status,vec4 p_current)\r\n\t\t\t{\r\n\t\t\t\tvec4 p   \t\t= p_status;\t\t\t\t\r\n\t\t\t\tvec4 c   \t\t= p_current;\r\n\t\t\t\t\r\n\t\t\t\tif(int(p.x) == PARTICLE_DISABLED)\r\n\t\t\t\t{\r\n\t\t\t\t\tvec4 rnd = Random();\r\n\t\t\t\t\tc.x = StartSpeed.w > 0.0 ? rnd.x : SystemProgress;\r\n\t\t\t\t\tc.y = StartSize1.w > 0.0 ? rnd.y : SystemProgress;\r\n\t\t\t\t\tc.z = SystemProgress;\r\n\t\t\t\t\tc.w = StartRotation1.w > 0.0 ? rnd.w : SystemProgress;\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\treturn c;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tuniform float Time;\r\n\t\t\t\r\n\t\t\tvoid main(void) \r\n\t\t\t{\t\t\r\n\t\t\t\tfloat count\t\t = floor(SystemEmissionCount);\t\t\t\t\r\n\t\t\t\tif(count <= 0.0) { gl_FragColor = vec4(0,0,0,1); return; }\r\n\t\t\t\tfloat ix\t     = iterator.x;\r\n\t\t\t\tfloat iy\t     = iterator.y;\t\t\r\n\t\t\t\tfloat iw         = 1.0 / width;\t\t\t\t\r\n\t\t\t\tfloat ih         = 1.0 / height;\t\t\t\t\r\n\t\t\t\t//float hiw        = iw*0.5;\t\t\t\t\r\n\t\t\t\t//float hih        = ih*0.5;\t\t\t\t\r\n\t\t\t\t//ix = (ix - hiw) / (1.0 - iw);\r\n\t\t\t\t//iy = (iy - hih) / (1.0 - ih);\r\n\t\t\t\t\r\n\t\t\t\tfloat size       = width * height;\r\n\t\t\t\tfloat max_count  = floor((width * height)/PARTICLE_LENGTH);\r\n\t\t\t\tfloat px         = floor(ix * width);\r\n\t\t\t\tfloat py         = floor(iy * height);\r\n\t\t\t\tfloat pix\t     = (px + (py * width));\r\n\t\t\t\t\r\n\t\t\t\t//if (pix >= (size - PARTICLE_LENGTH)) { gl_FragColor = vec4(0, 0, 0, 1); return; }\r\n\t\t\t\t\r\n\t\t\t\tfloat id\t\t = ((pix / (PARTICLE_LENGTH)));\r\n\t\t\t\tfloat field\t\t = mod(pix,PARTICLE_LENGTH);\r\n\t\t\t\t\r\n\t\t\t\tparticle_id = id;\r\n\t\t\t\tfragment_id = pix;\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tfloat emin \t\t = floor(mod(SystemEmissionStart,max_count));\r\n\t\t\t\tfloat emax \t\t = floor(mod(SystemEmissionStart+count,max_count));\r\n\t\t\t\t\r\n\t\t\t\tif(emin > emax)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(id < emin) \r\n\t\t\t\t\tif(id >= emax) { gl_FragColor = vec4(0.0,0.0,0.0,1.0); return; }\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\t\t\t\t\r\n\t\t\t\t\tif(id < emin)  { gl_FragColor = vec4(0.0,0.0,0.0,1.0); return; }\r\n\t\t\t\t\tif(id >= emax) { gl_FragColor = vec4(0.0,0.0,0.0,1.0); return; }\r\n\t\t\t\t}\r\n\t\t\t\t//*/\r\n\t\t\t\t\r\n\t\t\t\t/*\r\n\t\t\t\tfloat ck = floor(mod(pix, 2.0)) <= 0.0 ? 0.8 : 1.0;\t\t\t\t\r\n\t\t\t\tck = field / PARTICLE_LENGTH;\t\t\t\t\r\n\t\t\t\tvec4 mc = vec4(ck, ck, ck, 1.0);\t\t\t\t\t\r\n\t\t\t\t//gl_FragColor = mc;\r\n\t\t\t\t//return;\r\n\t\t\t\t//*/\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t/*\r\n\t\t\t\tvec4 c0 = vec4(1.0, 0.0, 0.0, 1.0)*mc;\r\n\t\t\t\tvec4 c1 = vec4(1.0, 1.0, 0.0, 1.0)*mc;\r\n\t\t\t\tvec4 c2 = vec4(0.0, 1.0, 0.0, 1.0)*mc;\r\n\t\t\t\tvec4 c3 = vec4(0.0, 1.0, 1.0, 1.0)*mc;\r\n\t\t\t\tvec4 c4 = vec4(0.0, 0.0, 1.0, 1.0)*mc;\r\n\t\t\t\tvec4 c5 = vec4(1.0, 0.0, 1.0, 1.0)*mc;\r\n\t\t\t\tvec4 c6 = vec4(1.0, 1.0, 1.0, 1.0)*mc;\r\n\t\t\t\tvec4 c7 = vec4(0.8, 0.8, 0.8, 1.0)*mc;\r\n\t\t\t\tvec4 c8 = vec4(0.6, 0.6, 0.6, 1.0)*mc;\r\n\t\t\t\tvec4 c9 = vec4(0.4, 0.4, 0.4, 1.0)*mc;\r\n\t\t\t\t//*/\r\n\t\t\t\t\r\n\t\t\t\t/*\r\n\t\t\t\tif(int(id)==0) { gl_FragColor = c0; return; }\r\n\t\t\t\tif(int(id)==1) { gl_FragColor = c1; return; }\r\n\t\t\t\tif(int(id)==2) { gl_FragColor = c2; return; }\r\n\t\t\t\tif(int(id)==3) { gl_FragColor = c3; return; }\r\n\t\t\t\tif(int(id)==4) { gl_FragColor = c4; return; }\r\n\t\t\t\tif(int(id)==5) { gl_FragColor = c5; return; }\r\n\t\t\t\tif(int(id)==6) { gl_FragColor = c6; return; }\r\n\t\t\t\tif(int(id)==7) { gl_FragColor = c7; return; }\r\n\t\t\t\tif(int(id)==8) { gl_FragColor = c8; return; }\r\n\t\t\t\tif(int(id)==9) { gl_FragColor = c9; return; }\r\n\t\t\t\t\r\n\t\t\t\tgl_FragColor = vec4(0.0, 1.0, 1.0, 1.0);\r\n\t\t\t\treturn;\r\n\t\t\t\t//*/\r\n\t\t\t\t\r\n\t\t\t\t/*\r\n\t\t\t\tfloat b = (field / PARTICLE_LENGTH) + 0.2;\r\n\t\t\t\tc0.xyz *= b;\r\n\t\t\t\tc1.xyz *= b;\r\n\t\t\t\tc2.xyz *= b;\r\n\t\t\t\tc3.xyz *= b;\r\n\t\t\t\tc4.xyz *= b;\r\n\t\t\t\tc5.xyz *= b;\r\n\t\t\t\tc6.xyz *= b;\r\n\t\t\t\t\r\n\t\t\t\tfield = id;\r\n\t\t\t\t\r\n\t\t\t\t//*/\r\n\t\t\t\t/*\r\n\t\t\t\tvec4 c0 = vec4(1.0,0.0,0.0, 1.0);        \r\n\t\t\t\tvec4 c1 = vec4(dv*1.0, 1.0, dv*1.0, 1.0);\r\n\t\t\t\tvec4 c2 = vec4(dv*2.0, 0.0, dv*2.0, 1.0);\r\n\t\t\t\tvec4 c3 = vec4(dv*3.0, 0.0, dv*3.0, 1.0);\r\n\t\t\t\tvec4 c4 = vec4(dv*4.0, 0.0, dv*4.0, 1.0);\r\n\t\t\t\tvec4 c5 = vec4(dv*5.0, 0.0, dv*5.0, 1.0);\r\n\t\t\t\tvec4 c6 = vec4(1.0, 0.0, 1.0, 1.0);      \r\n\t\t\t\t//*/\r\n\t\t\t\t/*\r\n\t\t\t\tif(int(field)==0) { gl_FragColor = c0; return; }\r\n\t\t\t\tif(int(field)==1) { gl_FragColor = c1; return; }\r\n\t\t\t\tif(int(field)==2) { gl_FragColor = c2; return; }\r\n\t\t\t\tif(int(field)==3) { gl_FragColor = c3; return; }\r\n\t\t\t\tif(int(field)==4) { gl_FragColor = c4; return; }\r\n\t\t\t\tif(int(field)==5) { gl_FragColor = c5; return; }\r\n\t\t\t\tif(int(field)==6) { gl_FragColor = c6; return; }\r\n\t\t\t\t\r\n\t\t\t\tgl_FragColor = vec4(0.0, 1.0, 1.0, 1.0);\r\n\t\t\t\treturn;\r\n\t\t\t\t//*/\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t//gl_FragColor = vec4(1.0,1.0,0.0,1.0);\t\t\t\treturn;\r\n\t\t\t\t//if(id >= SystemEmission) { gl_FragColor = vec4(0.0,0.0,0.0,1.0); return; }\r\n\t\t\t\t\r\n\t\t\t\tint   state\t\t = SystemState;\r\n\t\t\t\t\r\n\t\t\t\tvec4  status\t = ParticleStatus();\r\n\t\t\t\tvec4  data\t\t = texture2D(Data,iterator);\r\n\t\t\t\t\r\n\t\t\t\tgl_FragColor \t = data;\r\n\t\t\t\t\r\n\t\t\t\tif(state == STATE_NONE) return;\r\n\t\t\t\t\r\n\t\t\t\tint field_id        = int(field);\r\n\t\t\t\t\r\n\t\t\t\tif(field_id == PARTICLE_STATUS) \t{ gl_FragColor = UpdateStatus(state,data);\t\t\t   \treturn; }\r\n\t\t\t\tif(field_id == PARTICLE_POSITION) \t{ gl_FragColor = UpdatePosition(state,status,data); \treturn; }\t\t\t\t\r\n\t\t\t\tif(field_id == PARTICLE_ROTATION) \t{ gl_FragColor = UpdateRotation(state,status,data); \treturn; }\t\t\t\t\r\n\t\t\t\tif(field_id == PARTICLE_SIZE)\t \t{ gl_FragColor = UpdateSize(state,status,data); \t \treturn; }\t\t\t\t\r\n\t\t\t\tif(field_id == PARTICLE_VELOCITY)\t{ gl_FragColor = UpdateVelocity(state,status,data); \treturn; }\r\n\t\t\t\tif(field_id == PARTICLE_COLOR)\t\t{ gl_FragColor = UpdateColor(state,status,data); \t \treturn; }\r\n\t\t\t\tif(field_id == PARTICLE_START)\t\t{ gl_FragColor = UpdateStart(state, status, data); \t \treturn; }\r\n\t\t\t\tif(field_id == PARTICLE_NULL)\t\t{ gl_FragColor = vec4(1,0,1,1);\t\t\t\t\t \t \treturn; }\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t</fragment>\t\r\n\t</shader>\r\n\t';
Nb.main()})();
